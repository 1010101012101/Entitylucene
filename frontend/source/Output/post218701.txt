Keyboard / Trackpad not working in Mac OS, but works on boot screen and in Windows <body> Have an issue with Macbook Air 13 (Mid 2013). Both trackpad and keyboard work fine on the boot screen, also in Windows 10 bootcamp installation, but in Mac OS X neither works (not even Caps Lock LED). External keyboards and mouses work fine.  Tried clean re-install wiping all existing partitions (Yosemite and El. Capitan) - no difference. Actually, even during Mac OS installation, input works fine on the boot screen, but as soon as Mac OS setup loads, both keyboard and trackpad stop working.  SMC and PRAM resets didnâ€™t help.  strongEDIT - Some additional info gathered during troubleshooting:/strong (Thanks Tiago Ferreira)  ul liInternal keyboard and trackpad work fine in Diagnostics Mode./li liThe only warning on Diagnostics page is that battery needs servicing. /li liKeyboard and trackpad do not work in Safe and Single User modes./li liWhen booting into Single User mode, there are bunch of errors related to AppleHSSPIController/li liDisabling Bluetooth doesn't help. Apple Bluetooth mouse works fine./li liEFI and SMC Firmwares are up to date./li /ul  I strongly suspect it must be a hardware issue, but why it works in Windows and in certain Mac OS boot modes?  <answer218945> So my final answer is that this is probably a firmware problem and you need to re-flash it, unfortunately Apple doesn't allows users to do this on Macbook Airs. You'll need to take it to your local Apple Store for the genius to do it. If it is indeed an hardware problem, Apple Stores have access to a more detailed system diagnosis, which will almost certainly tell you what the problem is if it isn't firmware.   Sorry for the long time and hope you can solve it.  Tiferrei  <comment264706> Can you enter recovery mode? Did you restore from backup? Have you tried if an external mouse or keyboard work? Have you tried with a different account? Tiferrei <comment264707> Yes, tried recovery, also safe mode, nothing works. External keyboard and mouse work fine. Internal keyboard and trackpad wok perfectly in Windows so hardware is not faulty. Account and third party software is not an issue as I've done clean re-install multiple times. <comment264708> Hum, interesting... what's the output of: `kextstat -kl | awk ' !/apple/ { print $6 }'` in terminal? Is mouse keys in Accessibility off? <comment264709> Above command doesn't output anything, just goes to the next line. "Enable Mouse Keys" option in accessibility is off. <comment264710> OK, just to set the scene, how is your mac now? OS version, blank user, setup, restored backup? <comment264711> El Capitan (10.11.1) fresh install (installed from bootable USB wiping all partitions). No additional software, blank user account, nothing restored. It must be hardware related, just can't understand why it works in Windows... <comment264712> Hum it is quite strange indeed. Have you tried a diagnostic? Make sure your mac is connected to it's charger and hold D on startup. <comment264713> Diagnostics page says that battery needs servicing, but it's OK to keep using it. Interestingly, on the diagnostics screen trackpad works absolutely fine... <comment264714> So now we know ok it's working, the problem is not on your disk but precisely on the main graphical part of the OS, have you tried accessing single user mode? Did the keyboard work? How did you reinstall the system? The problem may be in a faulty installer <comment264715> Not working in single user mode, but when booting in this mode I noticed bunch of errors related to "AppleHSSPIController". Googling this brings handful of results with people having exactly the same issue (but no solutions). <comment264716> OK so the AppleHSSPIController is the firmware controller of the internal and SOME EXTRENAL keyboards trackpads and mouses. Are you sure you did the SMC reset correctly? It's easy to check, the magsafe connector's led will turn off and then on. What does the Console App show? Also disable put hard drives o sleep on power saver settings. <comment264717> I would think so. LED doesn't turn off, but changes colour from green to orange when I do SMC reset. Just tried again... Put Hard Drives to Sleep is now disabled, no difference. <comment264718> Do you have any bluetooth device configured? <comment264719> No, and I already tried disabling bluetooth... <comment264720> Good. Do you happen to have any bluetooth mouse or keyboard? <comment264721> Yes, have Apple magic mouse <comment264722> Could you try paring it and using it for about a minute, then put you macbook to sleep, turn off your magic mouse, wait about 5 minutes, wake up the mac and see if the keyboard or mouse work? Also, is there any hub entry on the System Information  USB? <comment264723> What about the keyboard's backlight and caps lock? <comment264724> No, that black magic procedure didn't help :) In system information under "USB 3.0 Bus" there is "BRCM20702 Hub", below it: "Bluetooth USB Host Controller". There also is "Wireless 2.4GHz Touchpad Keyboad", which I assume is my external keyboard. Keyboard's backlight is working fine. Caps Lock LED is not working (but works on boot screen) <comment264725> So the BRCM20702 Hub is your bluetooth PCI, have you tried a firmware update? If you open a text document or the notes app and type simultaneously on the external keyboard and on the internal keyboard, does the internal work? <comment264726> No, does not work. Haven't tried any firmware updates. Firmware of which device do you have in mind? <comment264727> if you go to the downloads page on the apple website there are firmware updates for specific models of specific years, try to find the latest one for your model. This one will work: http://support.apple.com/kb/DL1749?viewlocale=en_US <comment264728> Apparently this update is already installed... <comment264729> Sorry, this is the current one: 2.9.1 [firmware update](https://support.apple.com/kb/DL1756?viewlocale=en_GB&locale=en_GB)   Also try this one: [SMC update](https://support.apple.com/kb/DL1748?viewlocale=en_GB&locale=en_GB) <comment264730> 2.9.1 is for mid 2011 model, doesn't work. SMC update says it's already installed... <comment264731> It's a bit hard to exactly get the context with all the information spread out in the comments. Can you please edit the additional information gathered in the last hours directly into the question so we can delete the comments and reopen the question? <comment264762> OK, that's done. I updated original question with all additional information. <comment264879> Thanks for your efforts troubleshooting this. <comment264891> No problem! Hope you solve it mate.