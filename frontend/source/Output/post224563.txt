Scripted SFTP command line file transfer Mac OS X <body> I'm working with someone who's been doing simulations on various computers and FTPing the results to a website using a script and the basic mac ftp command basically something like (this is not exact just what i remember from when i last looked at it)  precodeftp -i username@host password cd /dir/ put file 1 put file 2 ... /code/pre  and so on...  I need to upgrade this process to use SFTP for security purposes, but there's no way that I can tell to put the password in a single line script for the SFTP program that's built into mac OS X.  Is there some other way to do this?  I tried using something called LFTP which seemed to connect to the server but the files would always stay at 0% when they were trying to transfer.  Any help would be appreciated.  <answer224912>    I guess i need to generate a key from the server itself and provide it to the user then they can connect just using the username and the key will authenticate them right?    No. Generate the key on client (codessh-keygen/code) and upload the public key to server. For example using codessh-copy-id/code, if the codessh/code is allowed on the server. There are many how-to's around the internet, so I believe you will be able to figure out.  Then connecting would work like codesftp username@host/code (without password). If you have some batch, you can provide it to codesftp/code using code-b/code option. For more info, consult manual pages for codesftp/code or the other above mentioned tools.  <answer225567> So in the end I never got public key authentication working and i'm sure it's some kind of permissions issue because when i ssh/sftp into the server i can't even cd into the .ssh directory without a permissions error from cygwin.  Since I couldn't figure out how to fix this, but I was at least able to get permissions working enough that I could succesfully sftp/ssh from my mac I just ended up installing LFTP which let me use a script that included the password.  It wasn't pretty but I made it work.  Thanks for everyone's help on this.  In the end it looks like most of my problem was cygwin related.  <comment272370> learn him to use public key authentication. It works on one-line and is more secure then password written on command line in plain text. Or if you really insist on writing password on commandline, there is tool `sshpass` (certainly also for Mac), but I can't recommend it. <comment272810> I saw sshpass but couldn't seem to figure that out.  I understand the concept of the public key authentication but I don't do this stuff ever day so I need a little more direction.  I guess i need to generate a key from the server itself and provide it to the user then they can connect just using the username and the key will authenticate them right?  Can you send some specific command line examples of what it would look like to assign/create the key as well as what it would look like on client side to connect.  As I said I don't do this stuff every day so i'm stumblnig around a lot. <comment272826> Another solution would be getting a copy of [Transmit](http://www.panic.com/transmit) and setup its folder sync functionality. <comment273134> i've been able to generate a public key on a mac that i'm using to test using the ssh-keygen tool but not sure how to put the public key onto my cygwin server so i can login password free.  I tried using ssh-copy-id but it said command not found.  I am searching the web for what should seem like a simple answer on this but i'm coming up a bit blank. <comment273135> You can [download](http://git.hands.com/?p=ssh-copy-id.git;a=blob_plain;f=ssh-copy-id;hb=HEAD) recent `ssh-copy-id`, if it is not packaged on your mac. It should be the safest way if you know password. <comment273136> Ok i think i copied my key up using instructions i found here http://www.commandlinefu.com/commands/view/188/copy-your-ssh-public-key-to-a-server-from-a-machine-that-doesnt-have-ssh-copy-id but when i try to sftp to my server it just says connection closed.  Not sure if there's more I need to do.  Do I have to do something on the server side at this point to like tell it to accept that public key for access.  It seems weird to me that access could be granted by an entirely client sided command like that. <comment273137> Of course you need to provide password to `ssh-copy-id`. Anyway check the server error log. There should be some note why the connection failed. <comment273138> I downloaded ssh-copy-id using brew but when i tried to run it to the server it gives me the following: INFO:attempting to log in with new key(s), to filter out any that are already installed.  /usr/local/bin/ssh-copy-id: ERROR Connection Closed by ip address of server <comment273139> great now i just have to figure out how to look at the sftp logfiles on cygwin...can you tell i'm out of my depth here :P. <comment273141> It looks like it fails even before authentication. First make sure you can authenticate with password. It can be troublesome under cygwin. How did you installed the openssh there? There is [nice guide](https://github.com/PowerShell/Win32-OpenSSH/wiki/Install-Win32-OpenSSH). Also running `ssh` with `-vvv` helps to investigate what is going on there. <comment273142> Yeah something weird is going on.  If i use one of the correct usernames to ssh or sftp i'm never prompted for a password it just kicks me out.  However if I use an incorrect username it prompts me for a password.  The weird thing of course is that i can use psftp just fine from a windows machine as well as filezilla and can connect to the server just fine via SFTP.  I feel like there's alot of moving targets here and its just hard to nail down. <comment273147> actually now i'd like to ammend that...filezilla works fine from a PC but not from a mac.  Now i'm totally confused...damn cygwin. <comment273335> Ok so i fixed cygwin...had to do some permissions things and maybe that's still my problem, but I can succesfully SFTP from my mac using filezilla and from the command line, but i'm trying to get public key authentication working.  I've tried using ssh-copy-id as well as cat-ing my id_rsa.pub file into the .ssh/authorized_keys file on my server but i keep getting a permission denied message after i put in my password.  I tried manually cat-ing the file into the authorized_keys file from the server itself which worked but i still can't sftp from the command line without using a password. Ideas? <comment273336> probably permissions. Though not sure how to handle this on Windows filesystem. But the `.ssh` directory and `authorized_keys` should not be readable by anyone else. You may try to run the server in debug mode and it should tell you what is wrong.