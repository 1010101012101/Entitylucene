Block access from WAN but not from LAN <body> I have an OSX Lion box behind a router (firewall on in the router). On the OS X, if I switch the firewall on, I'm unable to access the web server running on this box from outside the network (i.e. WAN). This is as expected.  However, if I try to access the web server from within the network (i.e. LAN), my requests are still blocked.  Two questions:  ol liIs this the expected behavior?/li liIf (1) is true, can I do/get something else that can enable me to do what I want i.e. block access from WAN but allow access from LAN?/li /ol  strongEDIT:/strong I have "Allow Incoming Connections" enabled for "Web Sharing" in firewall options.  img src="https://i.stack.imgur.com/RPTIP.jpg" alt="Firewall Options"  <answer104769> Solved the problem:  In the firewall options dialog (attached along with the question) there's another entity 'httpd' which was set to "Block incoming connections". Setting it to "Allow incoming connections" did the trick.  I do not know where it's coming from though.  <comment122966> Isn't it working after enabling incoming connections for web sharing? What error do you see? What's the URL you're using to check? <comment122982> @MK It doesn't work in spite of this setting enabled. I get the usual firefox - "Server is taking too long to respond" or "Connection could not be established" message. I'm trying to connect to this machine using it's internal IP address http://192.168.1.100/mystuff. If I disable firewall, I can connect without any glitches.