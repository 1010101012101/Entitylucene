History commands render incorrect on Bash Vi mode <body> I'm having this werid and really annoying issue in bash vi-mode.  Env:  Mac 10.9.2, iTerm 2 1.0 or Terminal.app, code$TERM={screen-256color|xterm-256color|xterm|vt}/code  Repro steps:  ol liRun some long commands (like 'some_long_commands_long_long')/li liPress kbdEsc/kbd and then press kbdk/kbd./li /ol  The issue is:  ol liI do see "some_long_commands_long_long" on my command line. But the cursor is not located at the beginning, instead it's on the 12nd char, see screenshot img src="https://i.stack.imgur.com/TEqip.jpg" alt="enter image description here"/li liIf I press kbdA/kbd to append some other text, the cursor will go beyond the command, which means the REAL command is start from where the cursor is located at the first place, the rendering is wrong.  img src="https://i.stack.imgur.com/FisCR.jpg" alt="enter image description here"/li /ol  I searched on google but ended up with nothing..... Anyone has a better idea about this? Thanks a lot...  <answer123285> Based on comments in Stackoverflow, IMHO the problem is in a tmux/iTerm/settings combination, not in the codebash/code itself. you should try solve the problem step-by-step:  ol listart native codeTerminal.app/code with a strongclean/strong code~/.profile/code and code~/.tmuxrc/code/li litry codeset -o vi/code without codetmux/code /li liif it is works, (should) - switch to codeiTerm/code and check again (should works)/li listart codetmux/code in codeTerminal.app/code and in codeiTerm/code and compare... both should works./li listep-by-step enable your code.tmuxrc/code config.../li /ol  <answer123426> After debugging for quite a while I finally figured it out. It's an issue caused by PS1. Basically I forgot to wrap my colored "" with "\[" and "\]".  <comment143958> Thanks! After debugging quite a while I finally figoure it out. It an issue caused by PS1. Basically I forgot to wrap my colored "" with "\[" and "\]" in my PS1...Thanks again for all the help!