Strange behavior of `hdiutil` <body> precodedeclare -i s=${foo}; n=${bar}; mp=${baz}; cn=${qux}; mac_adr=${quux}  sudo hdiutil create -size ${s}b -fs JHFS+X -volname "${n}" -type SPARSEBUNDLE \ "/Volumes/${mp}/${cn}_${mac_addr}.sparsebundle" &amp;&amp; echo "Done" /code/pre  does not work, but  precodedeclare -i s=${foo}; n=${bar}; mp=${baz}; cn=${qux}; mac_adr=${quux}  sudo hdiutil create -size ${s}b -fs JHFS+X -volname "${n}" -type SPARSEBUNDLE \ "/Volumes/${cn}_${mac_addr}.sparsebundle" &amp;&amp; sudo mv -vn "/Volumes/${cn}_${mac_addr}.sparsebundle" "/Volumes/${mp}" &amp;&amp; echo "Done" /code/pre  Works correctly  What am I doing wrong?  <answer257546> I used the following command in 10.9.5:  precoderead -p "Size in GB? = " s; ((s= 10**9*s/512)); read -p "Name of image volume? = " n; read -p "External Volume name (Escape spaces with a backslash - the volume has to exist)? = " m; cn=`scutil --get ComputerName`; mac_addr=`ifconfig en0 | grep "ether"`; mac_addr=${mac_addr#*ether}; mac_addr=${mac_addr// /} ; mac_addr=${mac_addr//:/}; sudo hdiutil create -size ${s}b -fs JHFS+X -volname "${n}" -type SPARSEBUNDLE "/Volumes/${m}/${cn}_${mac_addr}.sparsebundle" &amp;&amp; echo "Done" /code/pre  and it works (with a workaround for spaces in volume names like "Macintosh HD") for internal volumes:  precodeSize in GB? = 2 Name of image volume? = aaa Existing External Volume Name (Escape spaces with a backslash)? = test\ 2 created: /Volumes/test 2/host_001122334455.sparsebundle Done host:~ user$  /code/pre  This doesn't work if you create a sparsebundle on a network share. Here you mustn't use the codesudo/code command. Instead use (I also simplified $mac_addr):  precoderead -p "Size in GB? = " s; ((s= 10**9*s/512)); read -p "Name of image volume? = " n; read -p "External Volume name (Escape spaces with a backslash - the volume has to exist)? = " m; cn=`scutil --get ComputerName`; mac_addr=`ifconfig en0 | grep ether | awk '{print $2}' | sed 's/://g'`; hdiutil create -size ${s}b -fs JHFS+X -volname "${n}" -type SPARSEBUNDLE "/Volumes/${m}/${cn}_${mac_addr}.sparsebundle" &amp;&amp; echo "Done" /code/pre  <answer257564> So (without sudo before hdiutil) it works:  precodeclear; read -p "Желаемый размер раздела в GB? = " s; ((s= 10**9*s/512)); read -p "Введите название раздела? = " n; cn=`scutil --get ComputerName`; mac_addr=`ifconfig en0 | grep "ether"`; mac_addr=${mac_addr#*ether}; mac_addr=${mac_addr// /}; mac_addr=${mac_addr//:/}; read -p "Точка Монтирования = " mp; hdiutil create -size ${s}b -fs JHFS+X -volname "${n}" -type SPARSEBUNDLE "/Volumes/${mp}/${cn}_${mac_addr}.sparsebundle" &amp;&amp; echo "Done"  Желаемый размер раздела в GB? = 10 Введите название раздела? = rrr Точка Монтирования = Data created: /Volumes/Data/Air_60c54700b918.sparsebundle Done /code/pre  The matter of rights on the network drive:  precodehdiutil - verbose DIDiskImageCreateWithCFURL: creator returned 0   ::getBandEntry: chown() - 501   Сompletion...    DIHLDiskImageCreate() returned 1     hdiutil: create: returning 1   hdiutil: create failed - operation is not permitted this file is created, but then the operation fails, before he makes the format:   DIDiskImageCreateWithCFURL: creator returned 0   DI_kextWaitQuiet: about to call IOServiceWaitQuiet...   DI_kextWaitQuiet: IOServiceWaitQuiet took 0.000011 seconds   Formatting ... Completing ... created: /Volumes/Data/Air_60c22700b922.sparsebundle /code/pre  Do not use "sudo" to the shared network resources!  <answer257577> The only difference I can see is that you are trying to create sparse bundle on different volumes. /Volume/test.sparsebundle will be located on your startup disk. /Volume/Data/test.sparsebundle will be located (probably) on another disk. Please try to check what kind of filesystem is on your second drive.   You can try your issue both commands with -debug option and compare result.  <comment321618> It's the other way round - at least in Sierra: the first one works and the second one doesn't <comment321620> @klanomath OS X 10.9.5 <comment321631> [link]("https://monosnap.com/file/e8oT3Fr9c7KCUrROKOukIS7bcIyIKw.png")[link] ("https://monosnap.com/file/bOe9UmJZmaR8Z2j0Ez7d2R5MFvUnaZ.png") <comment321633> The volume with the name Data has to exist of course - that was just an example... <comment321676> Please see the answer below: <comment321680> [link]http://take.ms/hJEna [link]http://take.ms/JfpIW <comment321689> /Volume/Data/test.sparsebundle Is sparsebundle on Time Capsule <comment321733> @cave-canem Updated answer <comment322066> Have you tried the same with `-debug` option? <comment322464> Don't steel my answer! You should accept my answer instead of repeating my answer. <comment322651> There is no need to use the "awk" From minimalist prntsipe if "bash" built-in tools can be used. "Sudo" should not be used with a network share, see "hdiutil -verbose"