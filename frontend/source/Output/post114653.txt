MBA can't connect to Hotspot <body> I've a weird problem with my MBA (2011 model) since the upgrade to Mavericks. There is a certain set of hotspots to which I can't connect anymore. I'm not sure which ones specifically, but there are several. Works well on the phone and tablet (both Androids).  I've got the feeling that it has something to do with the IP configs I receive - has anybody seen similar behavior and found a solution?  I've now found some more info on it, and it seems that the route is somehow mangled:  On the non working connection my routing table is:  precodeShu:~ blitz$ netstat -nr Routing tables  Internet: Destination        Gateway            Flags        Refs      Use   Netif Expire 169.254            link#4             UCS             0        0     en0 #somehow, the next line is duplicated 192.168.182        link#4             UC              0        0     en0 192.168.182        link#4             UCSI            2        0     en0 192.168.182.1      20:4e:7f:8b:36:81  UHLWIir         1      208     en0    992 192.168.182.240    127.0.0.1          UHS             0        0     lo0 192.168.182.255    ff:ff:ff:ff:ff:ff  UHLWbI          0        1     en0 /code/pre  On a working connection, the table is this one:  precodeshu:~ blitz$ netstat -nr Routing tables  Internet: Destination        Gateway            Flags        Refs      Use   Netif Expire default            192.168.1.1        UGSc           33        5     en0 169.254            link#4             UCS             0        0     en0 192.168.1          link#4             UCS             2        0     en0 192.168.1.1        84:7a:88:66:c5:79  UHLWIir        34       66     en0   1170 192.168.1.150      127.0.0.1          UHS             1       25     lo0 192.168.1.255      ff:ff:ff:ff:ff:ff  UHLWbI          0       16     en0 /code/pre  Any clue where the duplicated line got there and how i can get rid of it? And matter of fact, what does it even do?   [EDIT] Some Debug infos: the BOOTP response as printed from dhclient   precode  IME: 2014-02-20 19:38:48.818   IP: 192.168.182.1 (20:4e:7f:8b:36:81) &gt; 192.168.182.245 (10:40:f3:81:df:32)   OP: 2 (BOOTPREPLY)   HTYPE: 1 (Ethernet) HLEN: 6 HOPS: 0  XID: c9ab89bc SECS: 0 FLAGS: 0 CIADDR: 0.0.0.0 YIADDR: 192.168.182.245 SIADDR: 0.0.0.0 GIADDR: 0.0.0.0 CHADDR: 10:40:f3:81:df:32:00:00:00:00:00:00:00:00:00:00 SNAME: . FNAME: . OPTION:  53 (  1) DHCP message type         5 (DHCPACK) OPTION:   1 (  4) Subnet mask               255.255.255.0 OPTION:   3 (  4) Routers                   192.168.182.1 OPTION:   6 (  8) DNS server                192.168.182.1,83.169.184.225 OPTION:  15 ( 19) Domainname                frederix-hotspot.de OPTION:  51 (  4) IP address leasetime      600 (10m) OPTION:  26 (  2) Interface MTU             1500 OPTION:  54 (  4) Server identifier         192.168.182.1 /code/pre  The leases file, compared between working and non-working is - with the same access point:  precode10c10 &lt;   &lt;date&gt;2014-02-23T16:23:13Z&lt;/date&gt; --- &gt;   &lt;date&gt;2014-02-23T16:17:40Z&lt;/date&gt; 13c13 &lt;   AgEGACHWzY0AAAAAAAAAAMCotokAAAAAAAAAABBA84HfMgAAAAAAAAAAAAAAAAAAAAAA --- &gt;   AgEGAMmrigAAAAAAAAAAAMCotokAAAAAAAAAABBA84HfMgAAAAAAAAAAAAAAAAAAAAAA /code/pre  However, some more observations I've made: - the error only comes up in very specfic envrionments - It only happens after I've used the mac for a certain amount of time, usually after a work day (time is probably the wrong thing, but maybe programs I've used for work) - A reboot fixes things - so it strongly points to my machine being the culprit here!  <answer121257> strongHas anybody seen similar behavior and found a solution?/strong  Nope, never seen this before, but I've noticed that the default route is missing in the routing table of the non-working connection.   The default route is needed so that packets for destinations not listed in the routing table can be properly routed and delivered.  You can fix it by adding the route like this:  precodesudo route add default &lt;IP address of router&gt; /code/pre  In your case:  precodesudo route add default 192.168.182.1 /code/pre  This treats the symptoms, not the disease. To find out what's wrong download codedhcpdump/code from http://www.mavetju.org/unix/general.php, compile it in Terminal:  precodecd ~/Downloads/ tar xzf dhcpdump-1.8.tar.gz cd dhcpdump-1.8 make /code/pre  and run it:  precodesudo ./dhcpdump -i en0 /code/pre  You'll get an output similar to this:  precode  TIME: 2014-02-18 10:04:03.832     IP: 0.0.0.0 (e0:f8:49:27:4e:22) &gt; 255.255.255.255 (ff:ff:ff:ff:ff:ff)     OP: 1 (BOOTPREQUEST)  HTYPE: 1 (Ethernet) (...) OPTION:  53 (  1) DHCP message type         3 (DHCPREQUEST) OPTION:  55 (  9) Parameter Request List           1 (Subnet mask) 3 (Routers) 6 (DNS server) 15 (Domainname)      119 (Domain Search) 95 (LDAP) 252 (MSFT - WinSock Proxy Auto Detect)      44 (NetBIOS name server) 46 (NetBIOS node type)  OPTION:  57 (  2) Maximum DHCP message size 1500 OPTION:  61 (  7) Client-identifier         01:e0:f8:49:27:4e:22 OPTION:  50 (  4) Request IP address        10.0.0.31 OPTION:  51 (  4) IP address leasetime      7776000 (12w6d) OPTION:  12 (  8) Host name                 avallone ---------------------------------------------------------------------------    TIME: 2014-02-18 10:04:03.934     IP: 10.0.0.1 (c4:3d:c7:a6:a3:98) &gt; 10.0.0.31 (e0:f8:49:27:4e:22)     OP: 2 (BOOTPREPLY)  HTYPE: 1 (Ethernet) (...) OPTION:  53 (  1) DHCP message type         5 (DHCPACK) OPTION:  54 (  4) Server identifier         10.0.0.1 OPTION:  51 (  4) IP address leasetime      86400 (24h) OPTION:   1 (  4) Subnet mask               255.255.255.0 OPTION:   3 (  4) Routers                   10.0.0.1 OPTION:   6 (  4) DNS server                10.0.0.1 /code/pre  The important part for us is option 3 in the BOOTREPLY packet:  precodeOPTION:   3 (  4) Routers                   10.0.0.1 /code/pre  Is it missing in the answer your Mac gets, or are there other options like static routes (option 33) that might confuse the BSD network stack?  (You could also use codesudo tcpdump -i en0 -s 1500 -XX port bootps or port bootpc/code to analyze the DHCP packets but codedhcpdump/code offers a much more readable output.)  Which is the value of codeRouterIPAddress/code incode/private/var/db/dhcpclient/leases/&lt;interface&gt;,&lt;count&gt;-&lt;MAC address&gt;/code when the connection is not working? As an example, this is my DHCP lease file:  precode&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt; &lt;plist version="1.0"&gt; &lt;dict&gt;     &lt;key&gt;IPAddress&lt;/key&gt;     &lt;string&gt;10.0.0.31&lt;/string&gt;     &lt;key&gt;LeaseLength&lt;/key&gt;     &lt;integer&gt;86400&lt;/integer&gt;     &lt;key&gt;LeaseStartDate&lt;/key&gt;     &lt;date&gt;2014-02-21T07:04:53Z&lt;/date&gt;     &lt;key&gt;PacketData&lt;/key&gt;     &lt;data&gt;     (...)     &lt;/data&gt;     &lt;key&gt;RouterHardwareAddress&lt;/key&gt;     &lt;data&gt;     (...)     &lt;/data&gt;     &lt;key&gt;RouterIPAddress&lt;/key&gt;     &lt;string&gt;10.0.0.1&lt;/string&gt;     &lt;key&gt;SSID&lt;/key&gt;     &lt;string&gt;hotspot&lt;/string&gt; &lt;/dict&gt; &lt;/plist&gt; /code/pre  strongAny clue where the duplicated line got there and how i can get rid of it? And matter of fact, what does it even do?/strong  It looks like your Mac can't properly process the DHCP reply from the router. You can delete the duplicated line with:  precodesudo route delete -ifscope en0 -net 192.168.182 -link 'link#4' /code/pre  Since the duplicated routes have the same destination and gateway I don't think they will hinder network functionality, as you can see, only one of them is being used, the one with codeRefs/code greater than 0:  precode192.168.182        link#4             UC              0        0     en0 192.168.182        link#4             UCSI            2        0     en0 /code/pre  <answer246319> The temporary - easy for users - fix is to go to Network Preferences and create a new location and enable that. As if by magic the routing table gets honored.  <comment141319> That's true, didn't realize that, but that prob won't help me if I get a DUP, will it? Anyways, I'll try it out <comment141326> I'm unsure what to think about the duplicated entry, both routes point to the same interface, I don't think that should be a problem. Anyway, you can delete it with `sudo route delete -ifscope en0 -net 192.168.182 -link 'link#4'`. <comment141907> great explanation - but the error lies somewhere else. the bootp response is clean and looks okay - and as I said, it works after a reboot - so it seems to be something else! <comment141955> You say you can't connect, but you are getting connected if you are getting a DHCP lease. Can you ping 192.168.182.1? How does your ARP table look when it's not working? What does your routing table look like just before connecting, compared with after? <comment141968> Could you clarify? Do you mean you are using your Mac and suddenly network connectivity is lost, or that you can't connect at all to those hotspots? If the former applies, could you run `dhcpdump` in the background and post the packets exchanged when your connection is lost? I took a look at `frederix-hotspot.de` and `frederix.de` and it seems to be a pay-per-use hotspot service. Did you have to buy time credit to get your access code? If you didn't, could it be that free use is restricted in time? Even if you paid, could it be that there is not only a time limit but also a download limit? <comment141972> Could you post the contents of the lease file located in `/private/var/db/dhcpclient/leases/` when the connection doesn't work? The lease follows this naming convention: `interface,count-MAC address`, for example `en1-1,e0:f8:49:27:4e:22`. In your edit I see that the IP address lease time is 10 minutes, that's a relatively low value that forces your Mac to renew the lease often. Maybe something goes wrong during the renewal process and your Mac stops using the IP address granted to it? <comment141973> Let me try to clarify: On these particular locations, my Mac will not have any connectivity (it has connection) - unless I reboot. From the first second I join that network. I'll try to post the output. <comment141974> Did you try the workaround `sudo route add default 192.168.182.1` as explained in my answer? <comment141977> Yep, changed nothing saddly :( <comment142290> Okay, examined the output of the leases file - and no noticeable difference between working and non working change