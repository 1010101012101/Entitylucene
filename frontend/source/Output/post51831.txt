Mail.app AppleScript to process POP3 mails stopped working in Lion <body> I have a Mail.app rule script that worked fine in Mac OS X Snow Leopard. It is simply a script that allows for AND/OR boolean logic combined together to trigger one (rarely two) of the following actions:  ol liMove message to archive folder/li liDelete email message (move to trash)/li liForward the message to someone/li liColor the message (to signal importance)/li /ol  You can review the script here. The bulk of the script is made of the boolean conditions I’m looking at (and yes, I know my multiple 'else if's' could have been combined into fewer codeif/code statements, but I just found it easier to have each ‘condition’ that I’m looking for in its own codeif/code statement).  In Snow Leopard, everything worked fine, but in Lion I get some strange behavior. My Inbox gets tricked/stuck thinking it has emails to download. Basically every message that would have been ‘moved/deleted’ somehow doesn’t get flagged as processed on my POP3 server. So every time I get mail, I see the following under Mail Activity: ‘Incoming Messages… X of Y’ (where Y is the growing number of emails affected by my script), yet nothing new is downloaded.  If I turn my Mail Rule off that runs the script, all emails are re-downloaded again into my Inbox. A few points of note:  ul liI’m connecting to POP3 accounts/li liI used to use Growl 1.2.2, but I disabled that on a hunch that it wasn’t compatible with Lion. You’ll still see a codesendGrowl/code function in the script, but you’ll notice that the entire function body is commented out./li /ul  Any suggestions or ideas on how to get this working again so I could tame my inbox would be EXTREMELY appreciated.  <answer52468> Judging from your description of the issue, it seems that Lion’s Mail.app has difficulties correctly executing a codemove/code AppleScript action on a PO3 server (or maybe just emyour/em POP3 server – not having a POP server to test myself, I cannot check). A solution could be to separate the two components of the move operation by replacing the line  precodemove eachMessage to mailbox "Archived/BTR Monitoring Emails" /code/pre  with  precodecopy eachMessage to mailbox "Archived/BTR Monitoring Emails" delete eachMessage /code/pre  in the hope that an express deletion command will fare better. If that doesn’t alleviate the issue (because the deletions suffer from the same issue – I can’t say for sure from your question), you could also try setting the codedelete status/code of the message instead of sending it a codedelete/code command, i.e.  precodecopy eachMessage to mailbox "Archived/BTR Monitoring Emails" set deleted status of eachMessage to true /code/pre  though I’m not entirely sure how that will go down within a POP server (it sounds like something designated for IMAP).  Finally, you could try commenting out the codeset read status of eachMessage to true/code lines in the filing and deletion blocks – this should, by rights, not affect the server, as POP3 has no notion of a “read status” (you need IMAP to store that server side), but it might conceivably be an issue if Mail’s AppleScript thinks otherwise. Setting the message status to read can also be achieved within a rule without resorting to AppleScript, so removing this from the script should be a non-issue.  <comment59282> I don’t actually have a POP3 account to test this against (can’t even remember when I last used POP3 … must have been more than 10 years ago), but one issue might be that POP3 does not actually support folders; what happens when you file a POP3 received mail into a folder is that you file it in folder in your client’s local storage. Lion’s Mail.app, a rather drastic upgrade to previous versions, might have changed how these are handled, like asking for something along the lines of `mailbox "foo" of account "Local"` instead of simply `"mailbox "foo"`. <comment59466> Unfortunately, I'm stuck with POP3, I know it stinks...I'm ashamed.  The behavior of all my POP3 accounts in Mail.app preferences is to 'Remove copy from server after retrieving a message' when...'Moved from Inbox'.  After discovering it was 'Moved from Inbox', I checked what settings were in Leopard because I usually say 'immediately'.  It looks like default in Leopard is 'Immediately' and mine may have changed when I set up Lion, not sure.  In any case, I've tried 'Immediately' as well, and I get the same behavior.  I'm not exactly following what you are saying with your last statement. <comment59521> I was referring to AppleScript technical details … never mind, for the time being :).. Your script is logging errors to `~/Library/Logs/AppleScript-events.log` – what do you find in there after running it? <comment59559> oh, and another question: how many mail accounts are configured in Mail.app? Only the one POP account? <comment59588> I have 2 POP accounts that will be affected by rules.  And I have no AppleScript-events.log file, so assuming no 'errors' (according to AppleScript) are occurring.  I'm not getting the dialog about 'logging error' either, so pretty sure nothing is triggering log_event().  No IMAPI accounts configured FYI. <comment59607> Are the mails actually getting filed into the monitoring folder? <comment59957> So I turned the rule back on.  The email was downloaded and moved to the 'Monitoring' folder as you can see [here](http://dl.dropbox.com/u/13354075/MacMailScript-MovedToMonitoring.png).  But then I got the 'Download 1 of 1' issue going on (since one email was processed by the rule during testing).  I turned off the Rule and the email was redownloaded again to my Inbox as you can see [here](http://dl.dropbox.com/u/13354075/MacMailScript-SecondDownloadToInbox.png). <comment59964> Does manual filing (via drag and drop) work without locking up the account? <comment60028> Yes manual works, because that is what I resort to...I turn off my rule and just have to manually work with email flood I get.  As a second test, I did the above test again, and went to look at my POP3 account on its web access site.  And even though Mac mail pulls down a copy of email and files it a way (thus kind of flagging that email as a problem), it is left up on the server, unread.  You can see [here](http://dl.dropbox.com/u/13354075/MacMailScript-POP3WebMailOnError.png).  If I turn off the rules, let Mac mail download the email, then check POP3 web access again, it is gone.