Save attachments from Mail.app based on subject <body> I have been trying to write an Applescript to help me saving attachments, but realized quickly that I do not have the knowledge to do such a difficult script. Here is some background.  We receive daily sales reports, and flight manifests. The format in the subject should be: codedd.mm.yyyy/"two letter airline code".DSR.Weight/code.  I.e. code30.01.2013/VS.DSR.1110KG/code  In the case of the manifest, in the same format, substitute codeDSR/code with codeMNFST/code.  I.e. code30.01.2013/VS.MNFST.1110KG/code.  There are however countless variations to the subject, and we are all human, and sometimes code,/code is used, or more code//code etc. Our staff are great and work extremely hard, and the last thing they need me to do is be on their case about subject formats.  Therefore I was trying to get an Applescript to look at the two things that are always in the subject. The airlines two letter code, and the word codeDSR/code or codeMNFST/MFST/Manifest/code  We have the following two letter codes, sometimes in lower, or uppercase or a mix.  codeCV/code codeVS/code codeSAA/code codeTK/code codeDHV/code codeLH/code  Now the codeDSR/code can be in the subject in a number of ways, its not always seperated, ie. code30.01.2013/VSDSR1110KG/code  Same applies for codeMNFST/MFST/Manifest/code.  Ideally, I need a script to work in two parts:  DSR:  ol liCheck the subject for the flight code and codeDSR/code/li liSave the .xls attachment to /DSR/Airline two letter code/li liIf File is more recent (A correction might be sent later that day/early the next morning.), add code1/code, if another code2/code etc./li /ol  I.e. code30.01.2013/VS.DSR.1110KG.xls/code: codeMacintosh HD/Users/(My username)/Dropbox/DSR/VS/code I.e. code30.01.2013/CV.DSR.1110KG.xls/code: codeMacintosh HD/Users/(My username)/Dropbox/DSR/CV/code  Manifest (Sometimes a .xls/.pdf/.zip file. It varies.)  ol liCheck the subject for the flight code and (Manifest or MNFST or MFST)/li liSave the .xls/.pdf/.zip attachment to Manifests/Airline two letter airline code/li liIf the file is more recent (I.e. a file conflict with the same name. A correction might be sent later that day/early the next morning.), add code1/code, if another code2/code etc. /li /ol  I.e. For codeVS/code: codeMacintosh HD/Users/(My username)/Dropbox/Manifests/VS/code  From the 3 hours I spent attempting this and getting nowhere fast, I thought someone might find this an interesting challenge, and it would be greatly appreciated!  Meanwhile, I am going to be reading up on Applescript in my free time, very powerful tool and time saver!  <answer82085> First create a rule that looks for strongANY/strong  of the Manifest in all of the variations or DSR   Like So:  img src="https://i.stack.imgur.com/9wCvu.png" alt="enter image description here"  Then save this script (assuming you are using 10.8 Mountain Lion. ) In the folder em~/Library/Application Scripts/com.apple.mail//em  precode    using terms from application "Mail"     on perform mail action with messages theMessages for rule theRule          set codeList to {"CV", "VS", "SAA", "TK", "DHV", "LH"}         set subFolder to ""         set theDate to do shell script "date +%Y_%m_%d_%H%M%S"         --set ruleName to name of theRule              -- The folder to save the attachments in (must already exist)         tell application "Finder" to set attachmentsFolder to ((path to home folder as text) &amp; "Dropbox:DSR") as text          tell application "Mail"              repeat with eachMessage in theMessages                 set theSubject to subject of eachMessage                 repeat with i from 1 to number of items in codeList                     set this_item to item i of codeList                     if theSubject contains this_item then                          set subFolder to this_item                      end if                 end repeat                 if (count of (eachMessage's mail attachments)) &gt; 0 then                       try                          tell application "Finder"                              if not (exists folder subFolder of folder attachmentsFolder) then                                 make new folder at attachmentsFolder with properties {name:subFolder}                             end if                         end tell                         -- Save the attachment                         repeat with theAttachment in eachMessage's mail attachments                              set originalName to name of theAttachment                             set savePath to attachmentsFolder &amp; ":" &amp; subFolder &amp; ":" &amp; originalName                              tell application "Finder"                                  if (exists file originalName of folder subFolder of folder attachmentsFolder) then                                     set savePath to attachmentsFolder &amp; ":" &amp; subFolder &amp; ":" &amp; theDate &amp; "_" &amp; originalName                                 end if                             end tell                             try                                 save theAttachment in file (savePath)                                end try                         end repeat                       end try                  end if              end repeat          end tell     end perform mail action with messages end using terms from /code/pre  And point the Run Applescript at it.  If you are using an earlier Mac OS. Then you should be able to place the script where ever you want.  Thats it.  My tests all have worked. But it is late here and I should be in bed. So let me know if any issues and I will try and sort. :-)  The one thing to note is I have added a time stamp instead of a number for same named files. It is more reliable.  <comment94641> Please attach your AppleScript if you're asking us to review your AppleScript (what you've written so far). Else your question reads as asking for someone to write one. Perhaps rephrase your question to seek software or tools that does what you want? <comment94642> What you need is a piece of regex. This might be helpful: http://stackoverflow.com/questions/997828/is-there-something-akin-to-regex-in-applescript-and-if-not-whats-the-alternat <comment94643> Note that it might be easier to provide a script to create the mail so the format is correct <comment94651> I recommend that you either post [what have you tried](http://mattgemmell.com/2008/12/08/what-have-you-tried/) or hire one of the many talented developers in the [careers section](http://careers.stackoverflow.com/) <comment94702> Hey markhunte! You have probably just saved me an hour of time/day with those lines of code! 15 Days of my life per year! Many thanks. It works almost perfectly, <comment94705> It pulls all DSRs and Manifests and puts them in DSR/Airline two letter code. Which is fine, and actually I prefer it this way as the manifests and DSR come through next to each other. Your script from a previous thread relating to mail was my base, which I can see is in this one too. I was close (and forgot to comment the sub folder dialog in your original, Had to put a tea mug on my return key for 80,000 message prompts!). Part of learning! This script also helped me alot in understanding Applescirpt. P.S. Bookmarked your blog!