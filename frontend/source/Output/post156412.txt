Creating an account and sending mail using applescript <body> I'm trying to use applescript to do two things:  ol liCreate an account in Mail.app/li liUsing that account, send an email in Mail.app/li /ol  I'm having an issue with creating an account on Mail.app mainly because theres no "SMTP server", and I'm trying to use Yahoo. No matter what I try, I can't get Applescript to automatically add yahoo as the smtp outgoing server. Here's my code:  precodetell application "Mail"     set AccountName to "account_name"     set newacct to make new pop account with properties {name:AccountName, user name:"account_name@yahoo.com", server name:"mail.yahoo.com"}     tell newacct         set password to "ThePassword"         set full name to AccountName         set email addresses to {"account_name@yahoo.com"}         set port to 995         set uses ssl to true     end tell      set addsmtp to make new smtp server with properties {server name:"smtp.mail.yahoo.com", user name:"account_name@yahoo.com"}     tell addsmtp         set password to "ThePassword"         set uses ssl to true         set port to 465     end tell     set smtp server of newacct to addsmtp end tell /code/pre  <answer156415> Everything I've read (granted most of it, quite old) indicates that you need to include the words "smtp server" before "addsmtp", even though it should be quite obvious from the context.  There is also apparently a bug in the way AppleScript handles references to the new server.  Remove from the first codeset smtp server/code to the end of the script, and replace with this:  precode    set smtpservername to "smtp.mail.yahoo.com"     set smtpusername to "account_name@yahoo.com"     set addsmtp to make new smtp server with properties {server name: smtpservername}     tell addsmtp         set authentication to password         set password to "ThePassword"         set uses ssl to true         set port to 465         set user name to smtpusername     end tell     set newsmtpserver to smtp server (smtpservername &amp; ":" &amp; smtpusername)     set smtp server of newacct to smtp server newsmtpserver end tell /code/pre  <comment183883> Why exactly are you trying to do this? I ask because it wreaks of spam. It also violates Yahoo! Mail EULA. <comment183885> Did you try `set smtp server of newacct to smtp server addsmtp` <comment183889> @tubedogg  tried, got error: Mail got an error: Can’t make smtp server \"smtp.mail.yahoo.com\" into type integer." number -1700 from smtp server "smtp.mail.yahoo.com" to integer <comment183895> I posted some revised code below, please try and let me know if it works. <comment183904> Welcome to Ask Different. Unless one script _has_ to perform both functions, it would be best to ask two questions. The solution to sending email might not come from the same person as the one to create the account in the first place. <comment183984> @tubedogg two errors come up. the first one is: Mail got an error: Can’t make password of smtp server "smtp.mail.yahoo.com" into type constant.  the second one is  error "Mail got an error: Can’t make password of smtp server \"smtp.mail.yahoo.com\" into type constant." number -1700 from password of smtp server "smtp.mail.yahoo.com" to constant