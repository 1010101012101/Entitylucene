Applescript - AppleEvent handler failed on set properties {visible messages: } <body> I have the following applescript working under Lion, but it returns this codeError: -10000. Mail got an error: AppleEvent handler failed./code error under Yosemite.   precodetry tell application "Mail"     set theViewer to front message viewer     set theMsg to messages of theViewer     set msgList to {}     repeat with thisMsg in theMsg         if read status of thisMsg is false and flagged status of thisMsg is false then             set the end of msgList to thisMsg         end if     end repeat     if msgList is {} then         display dialog "There are no read messages in this mailbox."     else         tell theViewer to set properties to {visible messages:msgList}     end if end tell on error the errMsg number the errNmb if the errNmb is not -128 then     set the errTxt to "Error: " &amp; the errNmb &amp; ". " &amp; the errMsg     display dialog the errTxt buttons {"Cancel"} default button 1 else     error number -128 end if  end try /code/pre  Any help would be appreciated.  <answer195342> From comments…  As it would appear that many people across the net are struggling &amp; failing to get codeset properties to {visible messages:msgList}/code to work at all, it might be simpler in the long run to just pop up a count of unread/unflagged messages &amp; optionally sort by flagged then unread for easy discovery in the Mail window.  I added in a 'sort by date or flags/unread' option in the dialog, too  precodetell application "Mail"     tell the front message viewer         set unReadMsgs to every message whose read status is false and flagged status is false         display dialog ("There are " &amp; (count of unReadMsgs) as string) &amp; ¬             " Unread/Unflagged messages." buttons {"Sort Unread", "Sort Date"} ¬             default button "Sort Date" giving up after 300         set theResult to button returned of result as string         if theResult is "Sort Date" then             set properties to {sort column:date received column}         else if theResult is "Sort Unread" then             set properties to {sort column:flags column}             set properties to {sort column:message status column}         end if     end tell end tell /code/pre  <comment233167> What is "tell theViewer to set properties to {visible messages:msgList}" supposed to be doing? <comment233168> Change the message viewer to only display the read messages. <comment233170> Read? The rest of the script is looking for Unread… anyway, that's the bit it doesn't like. It doesn't want to coerce the property, though I can't figure why <comment233173> I meant Unread. I have similar scripts for Read and Flagged. <comment233174> I'm guessing the visibility flag has changed, it might even now be sandboxed & that's why it isn't working. Console throws "10/07/2015 14:32:11.591 Mail[340]: [MessageViewer 0x7f870d068d40 setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key focusedMessages." I don't know how to fix it, but that does seem a very roundabout way of finding unread & unflagged. <comment233175> Yeah you might be right. My email workflow is based on filtering out the read from the unread in my inbox. Can you suggest another option? <comment233176> A lot of Googling tells me that the 'visible messages' flag is totally broken :( Why not just sort by flagged, then unread, that would quickly sort to the top, unread first, followed by flagged [as the sorts are cumulative] I could throw up a little script that would tell you the counts too, if you needed. <comment233177> That would be great and I would consider that an answer/solution to my question. <comment233178> Cool, just posting now, hope you like it, as a compromise. <comment233184> I tightened up the question title, too, for future Googlers. <comment233189> Brilliant and thanks for the help. <comment233190> Most welcome :)