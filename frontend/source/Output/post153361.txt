PROMPT_COMMAND='history -a; history -n' changed (broken) in Yosemite / bash 3.2.53 <body> I need my command history to be shared across all terminal sessions and all commands available for immediate recall from any other terminal.  This is the default for old school ksh shells but hasn't been the standard for as long as I can remember with bash.    It was achievable however with a bit of a workaround (and is described in various stack exchange posts including 131504, 1288, 36886) thus:  precodePROMPT_COMMAND='history -a; history -n' /code/pre  However since upgrading to Yosemite, nasty things happen with this workaround in place. strongAfter entering a number of shell commands/strong (or even just hitting return around 20 times) strongthe shell will become less and less responsive until it permanently hangs/strong.  The problem is somewhat intermitant in terms of how quickly it starts, but it's more pronounced after a su - to root (or probably any su). It can be readily reproduced by:br 1) Putting the above command in your .bashrc filebr 2) Start a new terminal sessionbr 3) su -br 4) Hit return around 20-40 times (optionally entering commands)   When it does this the bash process can be seen in ps / activity monitor consuming ~98% CPU. It's as if the 'history append' + 'history refresh new' mechanism is feeding back on itself (which seems like a potential problem with the workaround and one might wonder how this didn't cause problems before now but it never did).  Interestingly the previously advised alternative command:  precodePROMPT_COMMAND='history -a; history -r' /code/pre  now hangs the terminal immediately on start up.   hr  1) Does anyone know what has changed in bash that might have caused this?br The version numbers between Mavericks and Yosemite seem to be very minor: 3.2.51 - 3.2.53.br If I build bash from source and set my shell to it, the problem persists with version 4.3.30(1)-release (x86_64-apple-darwin14.0.0).  Is it possible that it's an artefact of the shellshock patch?  2) Does anyone know of a readymade patch for bash that can more permanently / properly change its history handling behaviour to be that of old ksh?  