How can I block ssh brute force attempts in OS X 10.11? <body> My system running OS X 10.11 is constantly getting hammered by failed ssh login attempts by bots. I'm using a secure password and the root account isn't accessible via ssh, but even so it's still a drain on CPU time and it makes me nervous.  Is there a good way I can ban IP addresses that guess the password wrong too many times while still allowing myself to ssh in? Even better if this tool has a nice GUI so I don't have to use the command line.  I tried using sshguard, but I simply cannot get it to work. There's threads in various places about it not working properly in OS X 10.10, and I haven't found any solutions.  Other places have recommended using a VPN so that outsiders can't ssh into your system, but that's not an option for me. It's important that I be able to ssh in from arbitrary systems out in the world, and setting up VPNs on them is generally not feasible.  <answer277596> I run sshblack (found via Sebastian Hagedorn's site) as well as a portknocker in bmacOS Sierra/b, since the syslog now is accessed via the 'log show' command you'd have to adjust the log config settings below if you're on an earlier version of the os or use fail2ban following the linked instructions above. Also use key based authentication with passwords turned off (How to Set Up a Password-less SSH Login - add a passphrase). Then I download blocklists daily and block IPs in the firewall. Should be safe now...  Settings: /etc/pf.conf  precode# sshblack block drop log quick from &lt;ssh-block&gt; to any /code/pre  sshblack.pl  precode##  In sshblack my($LOG) = '/usr/bin/log show --style syslog --last 5s\|'; my($ADDRULE) = '/sbin/pfctl -t ssh-block -T add ipaddress'; my($DELRULE) = '/sbin/pfctl -t ssh-block -T delete ipaddress'; my($REASONS) = '(maximum authentication attempts exceeded|Invalid user|authentication failed|Auth fail)';  /code/pre  Add a 5 sec delay to the loop  Change to this (~line 190):  precodesleep(5); /code/pre  You do get an error in the log but it seems to work fine anyway.  To add blocklists that automatically updates, do this: Install wget (which requires brew):  precodebrew install wget /code/pre  In /etc/pf.conf  precodetable &lt;blocklist&gt; persist file "/usr/local/etc/all.txt" block drop log quick from &lt;blocklist&gt; to any /code/pre  Create a LaunchDaemon:  precodesudo nano /Library/LaunchDaemons/blocklist.de.allips.plist /code/pre  with the content:  precode&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt; &lt;plist version="1.0"&gt; &lt;dict&gt;     &lt;key&gt;Label&lt;/key&gt;     &lt;string&gt;blocklist.de.allips.plist&lt;/string&gt;     &lt;key&gt;Program&lt;/key&gt;     &lt;string&gt;/bin/bash&lt;/string&gt;     &lt;key&gt;ProgramArguments&lt;/key&gt;     &lt;array&gt;         &lt;string&gt;/bin/bash&lt;/string&gt;         &lt;string&gt;-c&lt;/string&gt;     &lt;string&gt;/bin/mkdir -p /usr/local/etc ; /usr/local/bin/wget -N -P /usr/local/etc rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt ; /usr/local/bin/wget -N -P /usr/local/etc https://lists.blocklist.de/lists/all.txt ; pfctl -t blocklist -T replace -f /usr/local/etc/all.txt&lt;/string&gt;     &lt;/array&gt;     &lt;key&gt;RunAtLoad&lt;/key&gt;     &lt;true/&gt;     &lt;key&gt;StartInterval&lt;/key&gt;     &lt;integer&gt;47250&lt;/integer&gt;     &lt;key&gt;ServiceDescription&lt;/key&gt;     &lt;string&gt;Blocklist.de PF Update&lt;/string&gt;     &lt;key&gt;StandardErrorPath&lt;/key&gt;     &lt;string&gt;/var/log/blocklists.log&lt;/string&gt;     &lt;key&gt;StandardOutPath&lt;/key&gt;     &lt;string&gt;/var/log/blocklists.log&lt;/string&gt; &lt;/dict&gt; &lt;/plist&gt; /code/pre  Load the plist  precodesudo launchctl load -w /Library/LaunchDaemons/blocklist.de.allips.plist /code/pre  This sshd config may also be useful in combination with the key authentication mentioned above:  File: /etc/ssh/sshd_config  precodePermitRootLogin no ChallengeResponseAuthentication no UsePAM no PasswordAuthentication no LoginGraceTime 20 MaxAuthTries 1 MaxSessions 5 /code/pre  Some background: I ran the blocking scripts (Blocking around 50000 IPs) and during approx. 5 days sshblack still detected ~160 IPs with failed login attempts to SSHD or SMTPD. This is why I went down the Portknocking route, now the SSH-attackers are blocked by the firewall instead.   Edit: I went through my sshd-log and spotted that I missed a "reason" in the log. I've added it above (the last one).  Some stats:     bFailed ssh logins(with ip-blocklists enabled)/bbr   Date       No of unique ipsbr   13-Mar  - 31br   14-Mar  - 29br   15-Mar  - 30br   16-Mar  - 39br   17-Mar  - 43br   18-Mar  - 41br   19-Mar  - 35br   20-Mar  - 44br   21-Mar  - 24br   22-Mar  - 18br   23-Mar  - 17br   24-Mar  - 20br   25-Mar  - 7 (portknocking enabled during this date)       Total  378    Most of these guys were banned after 3 failed attempts.  <answer277631> I've been researching opening up SSH like this on other *nix based systems, and most suggest two things. I'm sorry but I don't know how to do either on MacOS.  ul liFail2Ban - Which bans IPs that have too many failed login attempts/li likey rather than password based SSH logins. I believe you can take your key around with you if you want to use public machines./li /ul  <comment257025> Check my answer [here](http://apple.stackexchange.com/questions/198636/blocking-incoming-hostile-traffic-dynamically-with-pf-and-fail2ban-on-os-x) (should still be valid except the method to turn off rootless mode) or use [Murus Basic/Pro](http://www.murusfirewall.com/) and its adaptive firewall feature. <comment349391> Fail2Ban works without problems on macOS <comment350220> I added some hyperlinks (to remove the Google search parts). Please modify/edit/move the links if I linked the wrong words/parts of the sentences. <comment350242> OS X 10.11 doesn't provide the binary /usr/bin/log! So my($LOG) won't work! <comment350261> Yes 'log show' is new in Sierra. Check this thread for more info: https://discussions.apple.com/thread/7688551