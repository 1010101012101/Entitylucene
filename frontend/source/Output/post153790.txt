How to fix brew after OSX upgrade to Yosemite? <body> I faced some issue with Homebrew. I upgraded to Yosemite. After the upgrade, homebrew seems to be broken.  I would run any brew command and get this error  precode/usr/local/bin/brew: /usr/local/Library/brew.rb: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby: bad interpreter: No such file or directory /usr/local/bin/brew: line 26: /usr/local/Library/brew.rb: Undefined error: 0 /code/pre  How to resolve it?  <answer153791> I decided to look this up and found that there is an issue. The issue is closed but it is not possible to simply run codebrew update/code because you will still get the same error.  So here is what you need to do:  precodecd /usr/local/Library git pull origin master /code/pre  In case you have changes in the directory (/usr/local/Library), the git pull will throw an error. In that case, you'll have to fetch the master branch and set it forcibly as master:  precodegit fetch --all git reset --hard origin/master /code/pre  This will upgrade your homebrew and you can use brew again.  If you installed Homebrew as a non-root user, you'll need to codecd/code to code/Users/yourusername/homebrew/Library/code instead of code/usr/local/Library/code.  <answer158352> The version and location of Ruby changed with the new Mac OS X version.   To fix this in a generic way, edit code/usr/local/Library/brew.rb/code.   On the first line, replace code1.8/code with codeCurrent/code, i.e. from:  precode#!/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby -W0  /code/pre  to:  precode#!/System/Library/Frameworks/Ruby.framework/Versions/Current/usr/bin/ruby -W0 /code/pre  <answer162273> I found this solution:  That link describes it well, but in case the link goes down, here is what you need to do: Type these commands into your Terminal:  precodecd /System/Library/Frameworks/Ruby.framework/Versions sudo ln -s Current 1.8 brew update sudo rm 1.8 /code/pre  <answer182137> If you fix the ruby problem and then hit a problem where you are told that the system thinks you are running tiger or an older release, the fix for that is here  <answer229088> I first tried the highest rated answer an then hit another issue.  After that I kind of gave up on fixing it since I had just a couple packages installed.  Maybe others are in this boat as well.  While these are all excellent answers, for me it was simpler to just to re-install brew.    First, I ran the instructions on:  http://brew.sh/  which directed me to first uninstall, and printed a command line.  I ran that command line to uninstall, then re-installed, and everything was fine.  I don't want to print the specific commands, as they tend to change a bit as brew adjust how things are installed.  <comment181760> yet another reason I love having a package manager built on git :) <comment181912> Exactly. Love software that simply runs from source and upgradable through git pull <comment184721> Aw shucks I think we should revert back to the Microsoft Windows way - and drop into the maelstrom of the registry. <comment185682> Weird, I'm getting this _fatal: Not a git repository (or any of the parent directories): .git_ <comment185692> Thats not right.  Are u sure the path is correct? <comment185823> I'm getting this error: `error: cannot open .git/FETCH_HEAD: Permission denied` <comment185826> Try `sudo git pull origin master` <comment186066> @GabrielR. I also get. How did you manage with it? <comment186293> This breaks `brew update` because you now have an uncommitted change. <comment186345> â€¦but to do `brew update` one has to apply the fix I suggested.I never used `brew update` until now, so I didn't even have the repo initialized. Can't remember how I even installed it. <comment190785> Another problem that can be fixed by going to my local library. Thanks! <comment192544> Thank you so much for this link! Saved my ass! <comment193315> I also had to reset Git: git reset --hard HEAD git clean -f -d git pull <comment195172> Unlike the accepted answer this actually worked. <comment197215> This solution makes perfect sense. Thanks! <comment204299> You are da man!!! <comment204337> You are da ninja!!! <comment213490> Worked for me unlike accepted answer. Thanks! <comment213655> I just upgraded from Mac OS X 10.8 to 10.10 (Yosemite), and homebrew works fine after the upgrade. Either this problem was fixed, or there was something different about my OS upgrade compared to everyone else posting here. <comment216778> This is the only thing that worked for me on 10.10.3 <comment218304> Also works for 10.10.4 <comment224577> Aborting Error: Failure while executing: git pull -q origin refs/heads/master:refs/remotes/origin/master <comment229137> This worked for me, though there was also another step to take: http://stackoverflow.com/questions/26501126/homebrew-on-mac-os-10-10-or-10-11-is-not-working <comment233574> If you have an old version of brew you might have a git repo in /usr/local/Library yet. Just edit brew.rb and change "1.8" to "Current" in the first line. Then simply run brew update again and it will update to the latest version (the git repo will be created at the time). <comment251408> In part, this solution also fixed a problem after upgrading from Yosemite to El Capitan. The error:  `Could not restore untracked files from stash Error: Failure while executing: git stash pop --quiet`. First do `sudo chown -R $(whoami):admin /usr/local` and then apply this solution. <comment264105> Not sure if anyone else faced this issue, but for some reason the git repository for homebrew on my system was located at /Users/username/homebrew instead of /Users/yourusername/homebrew/Library (also updating brew.rb was a quick fix too). <comment280660> I had to go up one level from /usr/local/Library and also remove modified files: (danger) `git fetch origin master; git add --all . ; git reset --hard origin/master;` Then I was able to merge in the latest as you said: `git pull origin master`. I was concerned about the git repo being on the share directory. But I guess that is why Homebrew likes to own all your installs. Beware if you have non-Brew installed stuff. <comment316850> @Elias Zamaria after doing the same steps i am getting this error  ln: 1.8: Operation not permitted   any idea