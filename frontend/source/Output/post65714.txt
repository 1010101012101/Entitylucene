"brew link node" creates/removes different number of symlinks when repeated <body> I was upgrading Node.js codenode/code through Homebrew's codebrew upgrade/code, and it didn't link correctly.     $ strongbrew update/strongbr   em(snip-snip formulae were updated)/embr   $ strongbrew upgrade/strongbr   em(snip-snip other upgrades)/embr   == Upgrading nodebr   == Downloading http://nodejs.org/dist/v0.8.11/node-v0.8.11.tar.gz        ################################################################## 100.0%      == ./configure --prefix=/usr/local/Cellar/node/0.8.11br   == make installbr   == Caveatsbr   Homebrew installed npm.br   We recommend prepending the following path to your PATH environmentbr   variable to have npm-installed binaries picked up:br     /usr/local/share/npm/binbr   Warning: Could not link node. Unlinking...br   Error: The codebrew link/code step did not complete successfullybr   The formula built, but is not symlinked into /usr/localbr   You can try again using `brew link node'br   == Summarybr   /usr/local/Cellar/node/0.8.11: 856 files, 13M, built in 108 secondsbr   em(snip-snip other upgrades)/em     I followed the recommended steps to force linking it.     $ strongbrew link node/strongbr   Linking /usr/local/Cellar/node/0... Warning: Could not link node. Unlinking...        Error: Could not symlink file: /usr/local/Cellar/node/0.8.11/lib/node_modules/npm/scripts/relocate.shbr   Target /usr/local/lib/node_modules/npm/scripts/relocate.sh already exists. You may need to delete it.br   To force the link and delete this file, do:br     brew link -f formula_name        To list all files that would be deleted:br     brew link -n formula_namebr   $ strongbrew link -f node/strongbr   Linking /usr/local/Cellar/node/0.8.11... 756 symlinks created     I was stunned with the number of symlinks, so out of curiosity I tried linking it again.     $ strongbrew unlink node/strongbr   Unlinking /usr/local/Cellar/node/0.8.11... 755 links removedbr   $ strongbrew link node/strongbr   Linking /usr/local/Cellar/node/0.8.11... 352 symlinks createdbr   $ strongbrew link node/strongbr   Warning: Already linked: /usr/local/Cellar/node/0.8.11br   $ strongwhich node/strongbr   /usr/local/bin/nodebr   $ strongbrew unlink node/strongbr   Unlinking /usr/local/Cellar/node/0.8.11... 351 links removedbr   $ strongbrew link node/strongbr   Linking /usr/local/Cellar/node/0.8.11... 304 symlinks createdbr   $ strongbrew unlink node/strongbr   Unlinking /usr/local/Cellar/node/0.8.11... 303 links removedbr   $ strongbrew link node/strongbr   Linking /usr/local/Cellar/node/0.8.11... 304 symlinks createdbr   $ strongbrew unlink node/strongbr   Unlinking /usr/local/Cellar/node/0.8.11... 303 links removed     The process stabilizes at 304/303.  ol liWhy so many symlinks?/li liWhy does the link/unlink number change from 756 to 303?/li /ol  strongEdit:/strong ran the same update/upgrade/link/unlink procedure on a colleague's computer - in this case the symlinks went from 775 to 318 to 226, where it stabilized. Does anyone else have similar numbers? Do they depend on other installed brew recipes, or perhaps on npm modules?  <answer65754> Do you have several versions of Node installed via homebrew? Every time it updates node homebrew puts the newest version alongside the old one and then updates the symlinks to the newest version. Running the strongcodebrew cleanup/code/strong should reduce that up a bit for you.  <comment77409> Didn't know about `brew cleanup`, thanks! Removed 7 old node versions. Repeating unlink/link still gave the 303/304 cycle though, so it made not difference. <comment78630> Those are probably the rest of the symlinks created by homebrew for other apps. You can also run the command 'brew prune' to remove all of the dead symlinks. <comment78703> Running `brew prune` is silent on my machine, so can't be sure what difference it made. I'm down to a 303/303 cycle now though, so it's possible it affected one symlink =) <comment92827> Did you run `brew doctor`? That's the first thing to do in case of problems. The culprit seems to be `/usr/local/lib/node_modules/npm/scripts/relocate.sh`. Could it be that you installed a non-Homebrew version of Node? In that case, the file above would have non-Homebrew ownership and `brew` gets confused. There are apparently other such files. <comment92840> @Dominique: `brew doctor` only gives me warnings about having Mono (conflicting `pkg-config`) installed. Don't think I've had another node installed, but it's possible. My colleague, who had the same problem, may have added manual node compilation to a shared project setup script (he's working in both Ubuntu & Mac) to get the latest version on Ubuntu. Haven't seen this linking warning in a while now, and unlinking/linking node 0.8.18 is stable on 307/307 symlinks =) <comment96216> For anyone else experiencing this problem, I think this question may be helpful: [Can't brew link an unlinked keg](http://stackoverflow.com/q/10868133/320399) (re: Errors upgrading node/npm)