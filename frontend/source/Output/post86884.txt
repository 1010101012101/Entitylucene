Automator: How to replace a particular string with the filename? <body> Within Automator, how can I replace a particular string in many different files with the filename of each file?  strong// UPDATE/strong  Using a "Run Shell Script" process I am able to get the body of a test file (an html file), with the string correctly replaced, but the modified file isn't being saved. I just see the file's contents as text in the "results" pane of "Run Shell Script". How do I:  a) Get the file name instead of the entire filepath? b) Save the modified file? Do I need another step when using sed?  img src="https://i.stack.imgur.com/yPxUm.png" alt="enter image description here"  <answer86910> You can use a codeRun Shell Script/code action, with a script like this:  pre class="lang-bsh prettyprint-override"codebasename=${1##*/} tmp=`mktemp -t $$` sed -e "s/STRING_TO_BE_REPLACED/$basename/g" "$1" &gt; $tmp &amp;&amp; mv $tmp "$1" /code/pre  with codePass input:/code set to codeas arguments/code:  img src="https://i.stack.imgur.com/AhYDB.png" alt="enter image description here"  <answer87246> This would work with multiple files and filenames with special characters:  precodefor f in "$@"; do     [[ ! -f $f ]] &amp;&amp; continue     text=$(cat "$f")     printf %s "${text//stringToBeReplaced/${f##*/}}" &gt; "$f" done /code/pre  Another option using Ruby:  precoderuby -i -pe '$_.gsub!("stringToBeReplaced", File.basename($FILENAME))' "$@" /code/pre  <comment100545> In this instance, NEW_STRING should be $1 to accomplish your goal. <comment100556> $1 is the passed name of the file that has to be filtered. <comment100574> Yes, but the goal was to replace the string with the filename.  You were correct in showing the syntax, but to accomplish the goal, you would have to replace NEW_STRING with $1.  I was augmenting, not critiquing. <comment100576> Yes, you are right. I didn't read the question carefully enough :) I'll update the answer. <comment100735> Thanks, very educational! That regex gives me a headache but I'm going with it :) I want to set this up as a mini-app, that I can drag and drop text files onto, with them resaved with the change. The resaving isn't happening though. Am I missing an obvious step? <comment100745> When I add "Get Specified Finder Items" above the shell script, drag a test file in, and run it, I do get the full file text with the replaced string, in the "results" pane of "run shell script". It just isn't resaving the file in the finder... <comment101830> Maybe you should ask another question, mentioning some more details about your problem. <comment101909> Thanks Riccardo but my question remains basically the same! I updated it though, with a screenshot of where I'm stuck, which hopefully clarifies things. <comment101956> I've updated my answer: you have to add a ` "$1"`, to redirect the filtered output on the input file. <comment101957> And I changed the way to extract the filename to get only the base name. <comment101968> Sorry, that doesn't work either. Saves the entire file as empty string, zero k. The SED tutorial I've studied says "w file" is an optional flag for the substitute command that will "write the pattern space to file if a successful substitution takes place" but I haven't been able to get that working either. <comment101982> OK, now the code uses a temporary file: this should work. <comment101985> THANK YOU