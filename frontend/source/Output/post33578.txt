Hosts file in OSX Lion not blocking as expected <body> In Snow Leopard I blocked malware sites by editing the hosts file - /private/etc/hosts. I cannot get it to work the same way in Lion, in spite of reading up on the various issues people are reporting for Lion and hosts. For example, to block 0fees.net:  ol licodesudo nano /private/etc/hosts/code then add code127.0.0.1 0fees.net/code to the beginning of the hosts file (instead of at the end, which was the usual way pre-Lion)./li licodedscacheutil -flushcache/code (though most authors say this is not required)./li /ol  To test:  codeping 0fees.net/code   ... which then looks up the DNS and pings the host instead of returning 127.0.0.1. Rebooting seems to have no effect. How can I get blocking working again?  This is from a clean installation, not an upgrade from Snow Leopard.  <answer33596> In Lion, the entries must be below the the fe80::1%lo0 localhost line.  Works for me.   The first entries are reserved for the System. Then, you can make your own entries.   Just like that:  precode    ## # Host Database # # localhost is used to configure the loopback interface # when the system is booting.  Do not change this entry. ## 127.0.0.1       localhost 255.255.255.255 broadcasthost ::1             localhost fe80::1%lo0     localhost  # Block any ip 127.0.0.1       ...... /code/pre  <answer44027> Is your system fully updated and are you running any third party software? Maybe you have a VM with network kernel drivers or something? Have you tried on a clean install of OS X?  It works for me on OS X 10.7.3:  precodema:~$ sudo nano /private/etc/hosts Password:   GNU nano 2.0.6                        File: /private/etc/hosts                                                          ## # Host Database # # localhost is used to configure the loopback interface # when the system is booting.  Do not change this entry. ##  127.0.0.1       localhost 255.255.255.255 broadcasthost ::1             localhost fe80::1%lo0     localhost  127.0.0.1 0fees.net    ma:~$ dscacheutil -flushcache ma:~$ ping 0fees.net PING 0fees.net (127.0.0.1): 56 data bytes 64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.045 ms /code/pre  <answer44421> One more thing to check - is the hosts file still in native unix format? It's quite possible within Nano to accidently save it as MSDOS or ye-olde mac format in which case it won't be parsed properly and just ignored  (This was originally an answer, but converted to a comment by a mod, and requested to be an answer again by the OP so they can accept it.)  <comment38282> Two things. 1) did you try www.0fees.net? It might be getting stuck on the leading "0." 2) if all your doing is blocking traffic, use 0.0.0.0 instead of calling for a loopback. 127.0.0.1 is more resource intensive than using 0.0.0.0 (which just kills the connection rather than loopin it back home). Also put the line at the end not the beginning. The first lines should *always* be reserved for the system entries. <comment38298> Yes, I tried www.0fees.net (and several other blocked domains in the list) and they're not blocked. Also, in Lion all additional entries to the HOSTS file must be above the `fe80::1%lo0 localhost`line. <comment38361> @Simbamangu Your assertion about hosts entries must be above the localhost line is absolutely **false**. I have several custom entries, all below the `f380::1%lo0 localhost` line, and they work fine. <comment38373> As I said, add your entries to the end. Like @CajunLuke said above, I have several entries and they work just fine. <comment38396> One more thing to check - is the hosts file still in native unix format? It's quite possible within Nano to accidently save it as MSDOS or ye-olde mac format in which case it won't be parsed properly and just ignored. <comment38399> You might want to consider http://glimmerblocker.org/ as another alternative. <comment38440> @cksum / @Garry / @CajunLuke / @TJLuoma - thanks for all the advice and yep, looks like I was misled by other debates about this [including this Apple SE post](http://apple.stackexchange.com/questions/27415/lion-hosts-file-bug). Rewriting my hosts file (ensuring ASCII english text in response to `file hosts`) means usual behaviour has been restored ... <comment50027> I have been making regular edits to the hosts file for years as part of my job, and in my experience it usually is necessary to flush the cache with `dscacheutil`. Sometimes a full reboot is also required. <comment50033> @Garry - looks like this thread still shows as open; as your suggestion re unix format of the hosts file was correct, maybe make it an answer so's I can upvote it? Thanks! <comment50035> Hi @Abhi Beckert - apologies, there's a long comment thread above where we got a solution (non-unix hosts file format) but it wasn't put in as an answer yet. Thanks though! <comment50471> @Simbamangu  Ironically, it was originally an answer but someone converted it to a comment as they didn't think it worthy. I'll add a new answer :-) <comment110645> oh.my.god.  I've been looking for this answer for days. For some reason my file was set as mac format and completely ignored. Resaving as unix format worked. <comment116268> Are you sure about the Lion part? I tried putting them below the fe80::1%lo0 localhost line, didn't work, but keeping them above did it. Running Lion. There's a comment to the original post with the same experience.