Safari 8 on Yosemite Spawning distnoted process and spiking CPU load <body> My Safari 8 was hijacked by Open-Search.com after updating OS to Yosemite (10.10).  The effect was two fold, my home page was hijacked by Open-Search/MacKeeper and the CPU started to load spikes at regular intervals.    After a lot of digging I've removed the resources for Open-Search/MacKeeper ending the hijack. However distnoted, SubPubAgent and nsurlstoraged are showing up in the Activity Monitor and dumping the following log entry in the Message log file.    precode11/3/14 12:58:35.657 PM nsurlstoraged[233]: DiskCookieStorage changing policy from 2 to 0, cookie file: ///Users/&lt;username&gt;/Library/Cookies/Cookies.binarycookies  11/3/14 12:58:35.658 PM nsurlstoraged[233]: DiskCookieStorage changing policy from 0 to 2, cookie file: ///Users/&lt;username&gt;/Library/Cookies/Cookies.binarycookies /code/pre  This entry repeats about 4000 times (seriously) spiking the CPU over 300% and actuating the fan.  Once I quit out of Safari, the process ends and everything runs as expected.  I followed this answer posted last November but it's specific to emacs: codehttp://apple.stackexchange.com/questions/111197/runaway-distnoted-process/code.  By adding the file code/var/log/do_dnserver_log/code this seems to have MINIMIZED the problem but hasn't fixed it.  The CPU is still load spiking and the above processes are being spawned intermittently.  Any thoughts would be much appreciated.  Thought it might be helpful to post the full log entry after launching Safari.  precode  11/3/14 3:28:46.598 PM nsurlstoraged[232]: DiskCookieStorage changing policy from 0 to 2, cookie file: file:///Users/username/Library/Cookies/Cookies.binarycookies    11/3/14 3:28:46.613 PM storeaccountd[285]: AccountServiceDelegate: Accepting new connection &lt;NSXPCConnection: 0x7fb9bd818dd0&gt; connection from pid 538 with interface &lt;AccountServiceInterface: 0x7fb9bd81fbe0&gt; (PID 538)    11/3/14 3:28:46.728 PM com.apple.xpc.launchd[1]: (com.apple.imfoundation.IMRemoteURLConnectionAgent) The _DirtyJetsamMemoryLimit key is not available on this platform.    11/3/14 3:28:46.765 PM com.apple.xpc.launchd[1]: (com.apple.imfoundation.IMRemoteURLConnectionAgent) The _DirtyJetsamMemoryLimit key is not available on this platform.    11/3/14 3:28:46.927 PM locationd[55]: Couldn't find a requirement string for masquerading client /System/Library/PrivateFrameworks/Parsec.framework    11/3/14 3:28:46.928 PM locationd[55]: could not get apple languages array, assuming english    11/3/14 3:28:46.930 PM com.apple.xpc.launchd[1]: (com.apple.imfoundation.IMRemoteURLConnectionAgent) The _DirtyJetsamMemoryLimit key is not available on this platform.    11/3/14 3:21:19.295 PM com.apple.xpc.launchd[1]: (com.apple.PubSub.Agent[503]) Endpoint has been activated through legacy launch(3) APIs. Please switch to XPC or bootstrap_check_in(): com.apple.pubsub.ipc    11/3/14 3:21:19.295 PM com.apple.xpc.launchd[1]: (com.apple.PubSub.Agent[503]) Endpoint has been activated through legacy launch(3) APIs. Please switch to XPC or bootstrap_check_in(): com.apple.pubsub.notification    11/3/14 3:21:56.010 PM CoreServicesUIAgent[240]: unexpected message &lt;OS_xpc_error: &lt;error: 0x7fff7bd13c60&gt; { count = 1, contents = "XPCErrorDescription" =&gt; &lt;string: 0x7fff7bd13f70&gt; { length = 18, contents = "Connection invalid" }}&gt;    11/3/14 3:22:29.019 PM nsurlstoraged[232]: DiskCookieStorage changing policy from 0 to 2, cookie file: file:///Users/username/Library/Cookies/Cookies.binarycookies    11/3/14 3:22:29.020 PM nsurlstoraged[232]: DiskCookieStorage changing policy from 2 to 0, cookie file: file:///Users/username/Library/Cookies/Cookies.binarycookies /code/pre  Last entry repeats 4000 times  hope that helps.  ran codeps auxw &gt; pbefore.txt/code then again at the spike codeps auxw &gt; pspike.txt/code then ran codediff pbefore.txt pspike.txt/code the following were the difference:  precode &gt; root   31   0.0  0.0  2518116   7808   ??  SNs   2:01PM   0:00.16 /usr/libexec/warmd  &gt; username   721   0.0  0.4  3797960  60316   ??  Ss    5:06PM   0:02.11 /System/Library/Frameworks/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.WebContent.xpc/Contents/MacOS/com.apple.WebKit.WebContent  &gt; username  720   0.0  0.2  3613208  26316   ??  Ss    5:06PM   0:00.10 /System/Library/Frameworks/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.WebContent.xpc/Contents/MacOS/com.apple.WebKit.WebContent  &gt; username   717   0.0  0.1  3590548  15744   ??  Ss    5:06PM   0:00.20 /System/Library/Frameworks/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.Networking.xpc/Contents/MacOS/com.apple.WebKit.Networking  &gt; username   710   0.0  0.0  2514028   6748   ??  S     5:05PM   0:00.09 /usr/libexec/webinspectord  &gt; username   709   0.0  0.0  2521108   7636   ??  S     5:05PM   0:00.05 /System/Library/PrivateFrameworks/AOSKit.framework/Versions/A/XPCServices/com.apple.iCloudHelper.xpc/Contents/MacOS/com.apple.iCloudHelper  &gt; username   708   0.0  0.1  2537796  15316   ??  S     5:05PM   0:00.22 /System/Library/PrivateFrameworks/SyncedDefaults.framework/Support/syncdefaultsd /code/pre  <answer163995> Was able to clean the malware after following a couple post etc etc.  Before you start, download Find Any File from the app store.  This is a free utility allowing you to search the system files (among others) through a GUI interface.  Also it allows you to easily delete the files too.  Note: your malware may have different file names, however, the resource locations should be the same.  Then try the following (credit to Linc Davis linc davis profile):  strongStep 1:/strong From the Safari menu bar, select           Safari ▹ Preferences... ▹ Extensions Uninstall any extensions you don't know you need, including any that have the word "Spigot," "Trovi," or "Conduit" in the description. If in doubt, uninstall all extensions. Do the equivalent for the Firefox and Chrome browsers, if you use either of those.  Reset the home page and default search engine in all the browsers, if it was changed.  strongStep 2/strong (or use Find Any File search bar): Triple-click anywhere in the line below on this page to select it: /Library/LaunchAgents/com.vsearch.agent.plist  Right-click or control-click the line and select Services ▹ Reveal in Finder (or just Reveal)  from the contextual menu.* A folder should open with an item named "com.vsearch.agent.plist" selected.   Drag the selected item to the Trash. You may be prompted for your administrator login password. Repeat with each of these lines:  /Library/LaunchDaemons/com.vsearch.daemon.plist /Library/LaunchDaemons/com.vsearch.helper.plist  strongStep 3:/strong Restart the computer and empty the Trash.  Then delete the following items in the same way:  /Library/Application Support/VSearch /System/Library/Frameworks/VSearch.framework ~/Library/Internet Plug-Ins/ConduitNPAPIPlugin.plugin  Some of these items may be absent, in which case you'll get a message that the file can't be found. Skip that item and go on to the next one.  I had to do the following in addition to Linc D. above.  Your situation may have different name, but the process and where the malware files are located will likely be the same.  strongStep 1:/strongbr sudo rm -f ~/Library/Cookies/Cookies.binarycookies enter password  strongStep 2:/strong  Select Clear History and Website Data  from Safari menu; click Clear History button in dialog box. This resets Safari  strongStep 3:/strong  Then force quit Safari from the context menu by clicking Cnt + icon in the dock.  strongStep 4:/strong  Finally, fully power down (Shut Down not Restart) the machine and then restart.   <answer175210> Use this App from trusted developer Thomas Reed http://www.adwaremedic.com/index.php follow instructions and its simple and easy to use and It will do all the work for you without effort  <comment181808> Have you tried `rm -f ~/Library/Cookies/Cookies.binarycookies`, as well as clearing/resetting Safari's cookie data (from the GUI)? <comment181812> Hi Chris, I did, but went back and tried that again.  No avail.  Still spiking. But thanks for the thought. <comment181813> Okay. To go further down the diagnosis line, would you mind checking: **1)** the list of Safari Extensions (`Safari - Safari Extensions`). **2)** in Terminal.app, if you can `ps auxw` before launching Safari, then afterwards (during the state where your CPU is spiking), and `diff` that, that might give you some clues. <comment181823> Yes, I believe the hijack originated with duckduckgo extension.  All extension were removed. <comment181826> Okay, it looks like `ps` shows no obvious culprits. I'll continue to investigate — I'll get back to you with a comment once I have more ideas. <comment181833> Alright, so can you go into Activity Monitor, locate the problematic processes, click `(i)` (info — top left corner) and note what the "Parent Process" for them is, please? <comment181842> Okay so this is weird.  Not getting the CPU spike now.  And the only thing different was removing the Cookies.binarycookies file, then I (eventually) fully shut down and restarted.  If you'll make that an answer, I'll accept!  Thanks for all you help Chris. <comment191791> The thing had my son's account on a computer and when I logged in as myself I had the same thing.  Home page set to search-only.com.  Looks like a Safari launch vulnerability. <comment192133> Andrew, I'll put my response in the answer section.  I was able to clean the malware, it took about a hour.