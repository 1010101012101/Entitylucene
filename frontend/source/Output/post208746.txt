Applescript Won't Invoke Shortcut Command <body> I have a long TextEdit document I frequently open (via a keystroke, thanks to Alfred). It contains many non-standard spellings, so I de-select "Check Spelling While Typing" (though I want  spell checking to be default on with other TextEdit documents). Note that I've created the shortcut "Command/Option/Control - S" (in Prefs/Keyboard/Shortcuts) to toggle that command.  To save myself a step, I want to create an applescript to open the document and trigger that command. But I just can't make it work.   The document opens, but  "Check Spelling While Typing" won't toggle off.  precodetell application "Finder" activate open document file "reference.rtf" of folder "Documents" of folder "MYSTUFF" of folder "Users" of startup disk end tell  tell application "TextEdit" to activate tell application "System Events" keystroke "s" using {command down, option down, control down} end tell /code/pre  ==============  EDIT:  I've inserted "Delay", but that doesn't help; the spellings are highlighted.  Is it possible Applescripts for some reason can't invoke custom shortcuts within applications (that have been rigged up via Prefs/Keyboard/Shortcuts)?   Is there another way to invoke the "Check Spelling While Typing" command? It doesn't seem to be one of TextEdit's scriptable commands.  <answer208828> emNote added after comments.../embr It may not be the delay that is causing the issue - it looks more likely to be the difficulty in determining the initial state of the auto-check switch.    hr  I do think 'delay' is your actual issue, as Arthur mentioned, but you can hone that script down to 3 lines, even adding the delaybr If you're running from HD rather than SSD, you may need to lift the delay value to 2 or 3, just to give the document time to open &amp; come to the front.  precodetell application "Finder" to open file ((path to documents folder as text) &amp; "reference.rtf") delay 1 tell application "System Events" to keystroke "s" using {command down, option down, control down} /code/pre  I'm assuming your users/mystuff/Documents path is your regular ~/Documents folder with the account name changed. My new version doesn't rely on your user name being in the script, it will just use the current user's ~/Documents folder  <answer209103> I suspect it wasn't accepting the custom shortcut because the shortcut's solely used in TextEdit, whereas the script was sending it to System Events.  Whether that's true or not, the following script works. It chooses the menu item rather than triggering it via shortcut:  precodetell application "Finder" activate open document file "reference.rtf" of folder "Documents" of folder "MYSTUFF" of folder "Users" of startup disk end tell delay 1 activate application "TextEdit" delay 1 tell application "System Events" tell process "TextEdit"   click menu item "Check Spelling While Typing" of menu 1 of menu item "Spelling and Grammar" of menu 1 of menu bar item "Edit" of menu bar 1  end tell end tell /code/pre  <answer209219> I'm adding this as a second answer, as I think the research in getting here is worth keeping in the flow.  Using a lot of Google-Fu &amp; Apple's own UI helper, UIElementInspector, which I obtained via FDMlib (which links directly to Apple for the download) I managed to cobble this together...  precodetell application "Finder" to open file ((path to documents folder as text) &amp; "reference.rtf") delay 1  tell application "System Events" to tell process "TextEdit"     set v to (value of attribute "AXMenuItemMarkChar" of menu item "Check Spelling While Typing" of menu 1 of menu item "Spelling and Grammar" of menu 1 of menu bar item "Edit" of menu bar 1)      if v = "âœ“" then         click menu item "Check Spelling While Typing" of menu 1 of menu item "Spelling and Grammar" of menu 1 of menu bar item "Edit" of menu bar 1     end if end tell /code/pre  The 'set v to...' is the part that examines the current toggle state of that menu item. It's a bit rough &amp; ready, but it works by checking for the actual checkmark on the menu item itself. If it's not checked it does nothing, if it is, it hands over to be switched off.    I'm sure a proper scripter could refine this in a dozen ways - but it works :-)  <comment251744> What's the result? Does it beep or give an error? Just guessing but is it possible TextEdit isn't active yet when the keystroke is executed? Can you try inserting the line `delay 1` between the activate and the  keystroke line? (causes a 1 second delay, increase/decrease the number if necessary) <comment251877> The result is the document opens....and highlights all the spelling errors. Even delay 5 doesn't help. <comment251878> Per my comment above, delays don't help (and it's a SSD). The document opens, but spelling errors are highlighted. <comment251880> Re your edit: It should still work with custom shortcuts. In fact, to test I set up the exact shortcut you mentioned and using sufficient delay it works without problems for me. Alternatively, try selecting the menu item by its name. You should find pointers how to do that by googling (sorry, I'm not at my computer currently). <comment251887> I wouldn't have posted it if it didn't work for me ;-) My guess, then, is your default is opposite to the result you're trying to achieve. It's perfectly possible to have spellcheck on for one document & off for another.  Check what is shows as being when it is opened without the key command to change it. Also check that you can actually see the menu command  being activated - the Edit menu should briefly flick blue. <comment251891> It appears that TextEdit retains the state of Check Spelling at Quit & after next launch, all opening documents start with that setting, until it is re-set at next Quit. I know of no way to check the state & switch only if on, by Applescript. <comment251894> Further research - it appears the state of that switch may be saved within the document itself, or at least in the app's saved.state file. It might be just a 'last set' switch, remembered as whatever the last document closed at quit was set to. <comment251902> Last gasp attempt - this shows all the toggleable switches - http://superuser.com/questions/367533/can-spell-checking-be-disabled-by-default-on-os-x - but none of them work for TextEdit if set as defaults read/write in Terminal, I tested. Needs someone smarter than me in Terminal to check the current state <comment252190> I want Text Edit to continue to default to spell checking on. I just want spell checking off for this one single document.   Whenever the document is closed/reopened, my preference for this doc is forgotten and spell checking recurs. That's the issue I'm trying to address with this scheme - TextEdit's inability to remember my choice for this document. <comment252191> See my edited answer - I cannot find any method to check the current status of that toggle, unfortunately. <comment252192> Perhaps it's not accepting the custom shortcut because the applescript sends that shortcut to "System Events" rather than to "Text Edit". in any case, yes, menu item selection works. I'll reply to my post to show the winning script. <comment252193> And, sigh, after leaving the document open for a couple minutes, I came back to it and....spelling errors are highlighted after all. It takes an unpredictable length of time for the highlights to appear, which also might account for some of the confusion in the replies. <comment252278> I still think it's the unpredictability of the initial state of that toggle. I don't think Applescript can do `if(toggle is off) {switch on}` though - 'cos that would be the fix. <comment252279> or maybe it can... http://stackoverflow.com/questions/16504541/applescript-on-toggling-checkmarks-beside-menu-items I'll have a think about this, after another couple of cups of coffee ;) <comment252972> It seemed to work the first time I ran it. The second, third, and fourth time, spelling errors were once again highlighted. For testing, you need to wait as long as 30 secs for highlighting to appear; it seems to be unpredictable. <comment252999> how large is your file? I'm back to thinking it might need more delay again - I tested this one til I was certain, whichever state the switch was in, it would leave it the right way. <comment253070> It's a large file. <comment253072> I changed it to "delay 10". First launch worked. Subsequent ones showed spelling errors. <comment253157> Then I give up. This works, repeatedly & predictably here, whatever the state of the toggle before opening the test file, & tbh, you're not really helping me out here, Took me 4 hours to research that version & you're not even telling me how you're testing it, whether it is specifically not toggling, toggling the wrong way, acting randomly, works on a smaller file... there's nothing more I can do. <comment253300> Tetsujin,Your help's appreciated. I didn't realize more was expected from me at this juncture....just testing and reporting results  how you're testing it  I repeatedly ran your script, waited a minute, then checked for spelling highlights.   whether it is specifically not toggling, toggling the wrong way  You mean check  menu to see if  command's checked before/after each run? I figured the appearance of highlighting was sufficient to determine this, unless a huge TextEdit bug causes spellchecks even with command unselected.   (cnt'd) <comment253301> (continuation)  acting randomly  I can't determine randomness. I tried four times. I can run it 20 times if it'd help, but I figured 3 bad runs in a row was sufficient.  works on a smaller file  It seems like quite a stretch for filesize to be the determining factor.  Again, it can take time (an unpredictable length) for spelling highlights to appear. I suspect it's working for you 'cuz you're not waiting long enough (e.g. 20 secs). <comment253303> Just ran it 4 more times. Each time the doc launched, "check spelling while typing" was checked in the menu. Delay is still set at 10. Doc is large, not monstrous. 1.1mb, About 170K words and 1M characters and not much formatting. I'm in OS 10.10.5 on a new Air with SSD. <comment253313> I'm simply looking at what the menu says before & after it opens - & I'm running it on some lorem ipsum, no idea of character/word count, but I've tested up to about 2500 pages, 5MB. I'm getting my red squiggles within a second or 2 if they're going to happen [though it won't show spell-check marks ever if you don't edit the doc] - but so far I cannot make it *not* work. If check is on at launch, it switches off, if it's off, it leaves it alone. ctd.. <comment253314> ...ctd If it's taking 20s to spell-check, then your delay may still not be long enough & we might be running machines with very different speeds/RAM. I'm on a Mac Pro 12-core with 64GB RAM, so I just may not be seeing the same kind of slowdown as on a laptop. <comment253315> Ok, now THAT'S weird. Before I saw your latest post, on a whim, I changed "delay 10" to "delay 2". And it works every time now. WTF??? <comment253316> hmm.. pure guess - delay too long was then choking the machine actually trying to do the spell-check & not having time to switch it off [or the request dropping off the queue by the time the spell-check had finished] <comment253317> I've been searching around, and there are no reports of this sort of problem with this length of delay. Shrug. Well, I'm glad it works! Thanks for the help! <comment253320> Glad we got there in the end ;)