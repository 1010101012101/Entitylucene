All HTTP requests get ERR_CONNECTION_REFUSED, HTTPS works - How to troubleshoot? <body> Trying to open a http website on any web browser (event telnet) gives a ‘ERR_CONNECTION_REFUSED’ or ‘connection timed out’.  However, the same sites can be opened using https. I tried doing a traceroute and it works fine.  I am new to OS X but have experience with Linux. How do I go about troubleshooting this issue?  h2Update/h2  I think I've tracked down the culprit to a rule in pf (firewall).  The result of codesudo pfctl -s nat/code is:  precodeNo ALTQ support in kernel ALTQ related functions disabled rdr pass inet proto tcp from 192.168.0.101 to any port = 80 -&gt; 127.0.0.1 port 9882 /code/pre  code192.168.0.101/code is the current ip address of the computer.  I tried to remove the rule with codesudo pfctl -F all/code, but it is back after a few seconds. I didn't find the rule in the default configurations (code/etc/pf.conf/code). And disabling pf with codesudo pfctl -d/code has no effect on it.  Is this a malware issue?  <answer243919> You are probably victim of an adware: OSX/Pirrit. Please read the linked analysis.  To remove the adware save the following shell script as remove-adware.sh (e.g. on your Desktop) and execute it as root:  precodeecho "*** Osx.Pirit Removal script, Amit Serper, @0xamit ***" echo "*** BEFORE YOU RUN THIS SCRIPT, STOP! I CAN'T TAKE ANY RESPONSIBILITY ON ANY DAMAGES HAPPENING TO YOUR MACHINE. YOU ARE THE MASTER OF YOUR OWN FATE" echo "*** Before running this script check that you are indeed infected with osx.pirrit. TERMINATE THIS SCRIPT BY HITTING CTRL+C AND RUNNING THE FOLLOWING COMMAND:" echo "$ dscl . -list /Users UniqueID | grep 401" echo "If this command has an output then continue running this script. Else DONT" echo "Press any key to continue running this script, remember - I am not responsible for any unfortunate outcomes" read  echo "[*] Getting net_pref name" netPrefFileName=$(sudo defaults read /Library/Preferences/com.common.plist net_pref)  echo "[*] Netperf name is:" echo $netPrefFileName  echo "[*] Getting appname from com.common.plist" appName=$(sudo defaults read /Library/Preferences/com.common.plist name) echo $appName  echo "[*] Stopping and removing LaunchDaemon" sudo launchctl unload -w "/Library/LaunchDaemons/"$netPrefFileName sudo killall $appName  sudo rm "/Library/LaunchDaemons/"$netPrefFileName  echo "[*] Removing injector" sudo rm -r "/Library/"$appName echo "[*] Removing malicious pf configs made by Pirrit" sudo rm /etc/change_net_settings.sh  sudo pfctl -evf /etc/pf.conf  servicePrefFileName=$(sudo defaults read /Library/Preferences/com.common.plist service_pref) echo “[*] Net pref file name:” echo $netPrefFileName  appName=$(sudo defaults read /Library/Preferences/com.common.plist name) echo “[*] App name is:” echo $appName  echo “[*] Removing LaunchDaemon” sudo launchctl unload -w "/Library/LaunchDaemons/"$servicePrefFileName echo [*] Killing app and osascript” sudo killall $appName sudo killall osascript  echo “[*] Cleaning up…” sudo rm "/Library/LaunchDaemons/"$servicePrefFileName  sudo rm -r "/Library/"$appName  echo “[*] Removing pirrit launching script” sudo rm /etc/run_app.sh  echo “Script finished” /code/pre  Make it executable:  precodechmod +x ~/Desktop/remove-adware.sh /code/pre  change your working directory:  precodecd ~/Desktop /code/pre  and execute it. Read the intro of the script thoroughly (especially the advice to run codedscl . -list /Users UniqueID | grep 401/code before continuing:  precodesudo ./remove-adware.sh /code/pre  <comment295892> Have you configured a proxy? Check if you set anything. What browser you're using? <comment295908> Error message looks like from Google chrome. @OP dis you try incognito mode or any other browser ? <comment297039> I tracked down the issue to a rule in pf. pfctl shows a rdr rule that maps all requests from the computer to port 80 to another port in localhost itself. I think this is the culprit. I have tried to remove the rule but so far have not been able to do so. Even when I do a pfctl -F all, it is back after a few seconds. Is this a malware issue? <comment298513> The reference to port 9882 looks like a Pirrit-malware infection symptom, see https://objective-see.com/blog/blog_0x0E.html <comment300428> @squGEIm I am exactly facing the same problem, using pfctl -F all works for few seconds. Any suggestions ? <comment300456> Possible duplicate of [Only HTTPS websites working otherwise I receive ERR\_CONNECTION\_REFUSED](http://apple.stackexchange.com/questions/243903/only-https-websites-working-otherwise-i-receive-err-connection-refused) <comment300486> @klanomath This question was asked before that other one, and this question is worded better and has more symptoms listed, so it'll get hit by search engines better, so I vote that the *other question is a duplicate* of this one. <comment300487> @klanomath Actually, they both have a similar amount of symptoms listed, but some of the symptoms are only listed on one and not the other. Maybe someone should merge them and we can pick one to be the one duplicates all point to. <comment300488> @AndrewLarsson Yeah I realized that later too. But since the question here didn't have an answer I haven't been able to mark the other one as duplicate.