How can I determine the invoking user in an Apple installer postinstall script <body> I want to build an apple installer .pkg where I run a postinstall script after the files have been copied by the installer. The script is run and everything works perfect except that all the commands in the script are run as root.  The question is, how can I determine the id of the user who actually invoked the installer.  precodewho -m /code/pre  returns the invoking user when I run the script on the command line with codesudo/code. But it returns coderoot/code when I run it in the installer.  Is there any way to get the "actual user"?  Thanks for your help!  <answer144160> You can determine who owns the "console" and invoke codesudo -u/code command.  Something like this:  precodeCONSOLE_USER=$(ps aux | grep console | grep -v grep | cut -d' ' -f1) sudo -u $CONSOLE_USER COMMAND_TO_EXECUTE /code/pre  <answer230327> After some testing, I believe I have found that one of the best options for this is  precodeINSTALLER_USER=$(stat -f '%Su' $HOME) /code/pre  I have found that the code$HOME/code environmental variable of the user installing the package is passed through, even after elevating for codeInstaller.app/code or using the codeinstaller/code command.  The previous answers are assuming some things about the environment that may not always be true.  For example codeCONSOLE_USER=$(ps aux | grep console | grep -v grep | cut -d' ' -f1)/code does not work in there are multiple users logged in, as may be the case in a computer lab environment.  As for codeps aux | grep "CoreServices/Installer" | grep -v grep | awk '{print $1;}'/code; this only works if the user is actually running  codeInstaller.app/code and would not apply to someone running it with the codeinstaller/code command in a shell.  <comment169849> I now do something similar and grep for the user who started the installer process     `ps aux | grep "CoreServices/Installer" | grep -v grep | awk '{print $1;}'` But is this really the "way to go"? <comment169850> Solved my problem and seems to be more stable than my solution, since the name of the installer is not involved. Thanks a lot!