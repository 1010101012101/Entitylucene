Ukelele generated custom keyboard layouts not working in Lion? <body> I created a custom keyboard layout with Ukelele (http://scripts.sil.org/ukelele) in Snow Leopard (idea is to generate scandinavian letters with Alt-key, otherwise have a pretty much standard U.S. layout).  After the upgrade, the old installed (to ~/Library/Keyboard Layouts) layout wasn't working.  Ukelele seems to work OK in Lion, but whether I put the generated keylayout in a bundle or single file, or save it "/Library/Keyboard Layouts" or "~/Library/Keyboard Layouts" doesn't seem to matter.  Help?  EDIT:  @Sergio, I cannot choose the layout in Input Sources. One keylayout file I tried: http://semeai.org/~sjl/us-scands.keylayout  BTW Off-topic: I don't know if I'm going blind or something, but I can't seem to locate the Library directory in Finder.  I need to copy stuff to and fro from my home directory.  UPDATE:  I've been trying to get this work on my machine for a few hours now and I just thought to try out with a random layout from the 'net; http://colemak.com/Mac was the first to hit the radar.  I did the same thing as with my layout, saved it under Library, and it shows under Input Sources.  My layout still doesn't.  I'll try to create a layout from scratch, see if that helps.  BTW, apparently "New from current input source" in Ukelele is broken in Lion.  UPDATE 2011/08/15:  @Tom:  Copied your keylayout (it naturally ended up in my Junk folder):  precodemidgard (01:55) &gt;ls -l ~/Library/Keyboard\ Layouts/MongolianQWERTY.keylayout -rw-r--r--@ 1 sjl  staff  44536 Mar 13  2008 /Users/sjl/Library/Keyboard Layouts/MongolianQWERTY.keylayout /code/pre  Logged out, logged in, isn't showing in Input sources (I'm looking very closely between "Maori" and "Myanmar - QWERTY").  I've also uninstalled bunch of software and plugins giving suspicious messages to system.log, but hasn't helped.  UPDATE 2011/08/16:  I created a test account, and lo, the layout works perfectly for it.  Also the bug in preferences doesn't show for that account.  When trying this on my own account, there are no errors in Console logs with the suggested keywords (I can't seem to locate console.log file, though).  UPDATE 2011/08/16 later:   Nuking Library/Caches (and relogging) didn't help.  UPDATE 2011/08/17:  I did  precode% find Library -name "*.plist" -exec mv {} {}.renamed \; /code/pre  and restarted, but it didn't help.  I restored the situation with  precode% for file in `find Library -name "*.plist.renamed"`; \   do mv "$file" "${file//.renamed/}"; done /code/pre  addendum: I also went through all the .plist files with plutil -s as described in http://www.askdavetaylor.com/can_i_check_my_plist_files_in_mac_os_x_for_problems.html.  There was some brokennes, but in very unrelated applications.  UPDATE 2011/09/10:  I went the extra mile and moved my whole Library away using another account, login in with my own account and observing stuff still not working.  I have copied the layout to /Library/Keyboard Layouts, from where it works for a test account, but not for my own.  Also, if I delete all the custom keylayout files, from everywhere, the Character Viewer and the Keyboard Viewer appaer as selectable to the Input Sources menu and also show under the International menu in the menubar.  As soon as I copy a keyboard layout to Library (home or system), the viewers disappear from both the menu and the Input Sources.  Any ideas how I could get more information from the system? I tried Command-V on boot for verbose boot but that didn't give any extra information for this issue.  SOLUTION FOR POSTERITY:  Adapted from http://support.apple.com/kb/TS1896?viewlocale=en_US for Lion:  precodesudo rm /System/Library/Caches/com.apple.IntlDataCache* sudo find /var/ -name "*IntlDataCache*" -exec rm {} \; /code/pre  Restart.  <answer21736> The layout you gave the link to works fine for me.  Are you sure that your copy of the file ends only in .keylayout and not .keylayout.xml or something else?  You have done logout/login after installing it, right?  <answer21765> Your layout worked for me after:  ol liDownloaded the file you provided. (code⌘/code is my bash prompt)  precode~/Downloads   ⌘  wget http://semeai.org/~sjl/us-scands.keylayout --2011-08-13 23:44:27--  http://semeai.org/~sjl/us-scands.keylayout Resolving semeai.org... 217.30.177.5 Connecting to semeai.org|217.30.177.5|:80... connected. HTTP request sent, awaiting response... 200 OK Length: 48265 (47K) [text/plain] Saving to: `us-scands.keylayout'  100%[======================================&gt;] 48,265      32.1K/s   in 1.5s      2011-08-13 23:44:29 (32.1 KB/s) - `us-scands.keylayout' saved [48265/48265]  ~/Downloads   ⌘  ls us-scands.keylayout  ~/Downloads   ⌘  md5 us-scands.keylayout  MD5 (us-scands.keylayout) = 9197c43c426151cd03f524a766107b49 /code/pre/li liDropping it in the code~/Library/Keyboard Layouts/code folder   precode~/Downloads   ⌘  mv us-scands.keylayout ~/Library/Keyboard\ Layouts/ /code/pre  At this point, it was already listed in Input sources:/li liSelecting it in the input sources list on the 'Input Sources' tab on the 'Language &amp; Text preference pane' in System Preferences /li /ol  img src="https://i.stack.imgur.com/TFkPk.png" alt="Listed layouts"  ol start="3" liLoggin out and logging in again./li liSelecting it as the current layout on the input menu./li /ol  Are you sure you are not missing any of those steps?  My specs:  ul li15" MacBook Pro, early 2011 (thunderbolt). /li liMac OS X 10.7 upgraded from Snow Leopard (clean Snow Leopard installation before upgrading to Lion). /li liSpanish International built-in Keyboard. I have never used an external keyboard on this Mac./li /ul  According to System Profiler:  precode        Apple Internal Keyboard / Trackpad:            Product ID: 0x0246           Vendor ID: 0x05ac  (Apple Inc.)           Version: 1.08           Speed: Up to 12 Mb/sec           Manufacturer: Apple Inc.           Location ID: 0xfa120000 / 5 /code/pre  <answer22083> According to Apple's Technical Note TN2056:     After installation, an XML keyboard will become available in the Input Menu pane of International Preferences if no errors were encountered in compiling it. strongIf there is an error in the file, an error message will be written to console.log, prefixed by "uchr XML compiler."/strong If the error is an XML syntax error, the line in the file where the error occurred is given. Usually, only the first error encountered is diagnosed, and parsing is aborted.   Have you tried opening Console (in Applications/Utilities) and see if there is message containing 'uchr XML compiler' after installing the keyboard layout or after logging in?  <answer24705> Try this fix which Apple published when the keyboard viewer and character viewer used to disappear in 10.5:  http://support.apple.com/kb/TS1896?viewlocale=en_US  <answer55652> I love ukelele. in lion last macbook pro, did not work as usual. the extension .keylayout seems not to work. it worked finally with the bundle, which you get in ukelele by saving bundle. it then has to be copied in the library/keyboardlayout with option key, otherwise it will be an alias. hope this helps  <answer150463> My problem was that my new custom keyboard layout would work in many apps - Spotlight, Sublime Text, the Terminal etc. - but not in many built-in apps such as TextEdit or Mail. The final point in the original question finally solved this issue for me:  precodesudo rm /System/Library/Caches/com.apple.IntlDataCache* sudo find /var/ -name "*IntlDataCache*" -exec rm {} \; /code/pre  <answer202145> Use older stable Ukelele version 1.8.4. Not even restart is necessary.  I have Mac 10.10.5 (Yosemite). Ukelele current version did not work even after I tried all possible suggestions from various forums. Finally I uninstalled current version of Ukelele and installed older stable version 1.8.4. Things worked like magic. No restart is necessary. You just save the new layout within Library/Keyboard Layouts. Then open keyboard preferences input sources. Add by clicking +. You should see the new layout in "Others".  <comment23854> I'm typing this using an Ukelele made layout in Lion, but the layout was made on Snow Leopard. So it probably not something specific to custom layouts, but maybe your specific customizations. <comment23855> Can you select the new layout using the Input menu but the keys don't type the correct characters? Or the layout simply does show as installed? <comment23856> If you post a link to your layout I can test it on my machine. <comment23878> I think the standard US layout already generates the characters needed for scandinavian languages via the alt key without modification.  I'm also willing to test your layout if you send it (tom at bluesky dot org). <comment23883> FYI: I edited the case to include the link to a keylayout file I've tried. <comment23885> For Library issue see http://tidbits.com/article/12306 <comment23904> I use the `cp` command to copy it to place.  I see the file in place with `ls`.  I'll try with only that keylayout file and rebooting the machine, there is some crud in Layouts directory after my experiments. (I have relogged and rebooted sevelar times while trying to solve this) <comment23906> @Tom: thanks for the link!  Using the command from the article I can again access Library from Finder. <comment23907> Removed all other keylayout files from under ~/Library and Library. `ls` output: `midgard (16:59) ls -l ~/Library/Keyboard\ Layouts total 96 -rw-r--r--  1 sjl  staff  48265 Aug 13 16:47 us-scands.keylayout `.  Rebooted and the layout still doesn't show under Input Sources. <comment23910> I also dropped your layout in my library folder (~/Library/Keyboard\ Layouts) and it shows under Input sources as "U.S. with scands //sjl", but I am not able to type: I press the keys and nothing happens. Is this the same problem you are having? <comment23913> No, I'm not seeing it in Input Sources at all. <comment23914> BTW, this layout is made for an aluminium wireless keyboard. <comment23932> It worked for me without problems after logging out and logging in again, as Tom Gewecke said. <comment23943> ls output: `midgard (21:23) ls -l ~/Library/Keyboard\ Layouts total 96 -rw-r--r--  1 sjl  staff  48265 Aug 13 13:33 us-scands.keylayout `, rebooted, doesn't show in the Input Sources list.  I assume you see it with the other U.S. keyboard variants? <comment23944> I even `wget` the file from the web page to make sure it is the same version you guys are using.  I've verified the path by cut'n'pasting from your comments. <comment23967> @Sami:  Re Colmak, that is one of the new layouts that Apple provides with Lion already. It was already there before you downloaded anything.  If your download works, you should see two of them in the Input Sources pane.  Have you been doing logout/login (not just restart)? <comment23969> *sigh* No, there is only one.  Yes, I've relogged 10+ times while doing this. <comment23970> @Sami  I wonder if a different source would matter.  I could email you a layout (tom at bluesky dot org). <comment23974> You can email me a layout at sjl@iki.fi. <comment24027> I'd +1 your answer, but don't have the rep yet :)  Anyways, I've done exactly as you describe and it never shows in my Input Sources.  Not before relogin or restart, nor after. <comment24034> what type is your keyboard?  Other things don't seem to work, for example, I can't seem to get the "Show Keyboard & Character Viewers in menu bar" setting to stick (under System Preferences - Keyboard). <comment24078> I also tried with normal USB+keyboard, with the wireless keyboard shut down, and it didn't help. <comment24349> Updated answer with my Specs. <comment24350> I have also found some bugs with the Input menu: The 'Show Input Source Name' is selected every time I log-in/out no matter how many times I unselect it; and my active keyboard layout is sometimes lost after returning from sleep. <comment24402> @sami  Problems with Keyboard/Character Viewer are often caused by bad .plists and/or caches. <comment24418> I did use Console, but I have not searched for that particular error.  I'll look into at today. <comment24419> @Tom: any idea how I could clear the cache or find the offending .plists? <comment24538> If a test account works, that normally means a bad .plist.  You could try moving all .plists in Home/Library to the desktop and restarting.  Or all except Mail, which contains a lot of settings you might not want to redo. <comment27715> Disappearing Keyboard and Character viewer was common in an earlier OS version and had a specific fix: http://support.apple.com/kb/TS1896?viewlocale=en_US <comment27728> Thanks Tom!  That did it.  If you can just put that in an answer, I'll mark it the correct one. <comment27739> Instead of `sudo rm /var/folders/*/*/-Caches-/com.apple.IntlDataCache*` I'd use `sudo find /var/ -name "*IntlDataCache*" -exec rm {} \;`, as the old glob pattern didn't match anything.  I used a lot more broad pattern, but it matched only what I've linked here matches. <comment27740> Anyways, using the advice from the link fixed this issue for me.  Thanks again! <comment243838> Hi - thanks for your answer. It would be helpful if you edited it so that it is not all in caps - some think this is analogous to shouting. This would also make your post easier to read.