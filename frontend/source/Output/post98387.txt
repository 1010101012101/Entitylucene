VPN does not connect on public wifi in train <body> I have problems connecting to a VPN when I use the public wifi that is available in some Dutch trains.  When I press codeConnect VPN/code from the drop down menu in the menu bar, I get a password prompt (as expected) and then after a short while the following message:  img src="https://i.stack.imgur.com/7bqYa.png" alt="enter image description here"  The VPN connects fine when I use any other network. Below is the console output around the time the connection is attempted (I've replaced all IP addresses with 1.1.1.1):  precode08/08/2013 12:12:01.595 configd[19]: IPSec connecting to server luchtbrug.tudelft.nl 08/08/2013 12:12:01.596 configd[19]: SCNC: start, triggered by SystemUIServer, type IPSec, status 0 08/08/2013 12:12:03.375 configd[19]: IPSec Phase1 starting. 08/08/2013 12:12:03.379 racoon[1177]: IPSec connecting to server 1.1.1.1 08/08/2013 12:12:03.380 racoon[1177]: Connecting. 08/08/2013 12:12:03.380 racoon[1177]: IPSec Phase1 started (Initiated by me). 08/08/2013 12:12:03.405 racoon[1177]: IKE Packet: transmit success. (Initiator, Aggressive-Mode message 1). 08/08/2013 12:12:05.027 racoon[1177]: IKEv1 Phase1 AUTH: success. (Initiator, Aggressive-Mode Message 2). 08/08/2013 12:12:05.027 racoon[1177]: IKE Packet: receive success. (Initiator, Aggressive-Mode message 2). 08/08/2013 12:12:05.027 racoon[1177]: IKEv1 Phase1 Initiator: success. (Initiator, Aggressive-Mode). 08/08/2013 12:12:05.027 racoon[1177]: IKE Packet: transmit success. (Initiator, Aggressive-Mode message 3). 08/08/2013 12:12:05.029 racoon[1177]: IPSec Phase1 established (Initiated by me). 08/08/2013 12:12:07.277 racoon[1177]: IKE Packet: transmit success. (Information message). 08/08/2013 12:12:07.278 racoon[1177]: IKEv1 Information-Notice: transmit success. (Delete ISAKMP-SA). 08/08/2013 12:12:07.278 racoon[1177]: IKE Packet: receive success. (Information message). 08/08/2013 12:12:07.278 configd[19]: IPSec Controller: IKE FAILED. phase 3, assert 0 08/08/2013 12:12:07.282 configd[19]: IPSec Phase1 starting. 08/08/2013 12:12:07.286 racoon[1177]: IPSec connecting to server 1.1.1.1 08/08/2013 12:12:07.286 racoon[1177]: Connecting. 08/08/2013 12:12:07.287 racoon[1177]: IPSec Phase1 started (Initiated by me). 08/08/2013 12:12:07.292 racoon[1177]: IKE Packet: transmit success. (Initiator, Aggressive-Mode message 1). 08/08/2013 12:12:08.084 racoon[1177]: IKEv1 Phase1 AUTH: success. (Initiator, Aggressive-Mode Message 2). 08/08/2013 12:12:08.084 racoon[1177]: IKE Packet: receive success. (Initiator, Aggressive-Mode message 2). 08/08/2013 12:12:08.085 racoon[1177]: IKEv1 Phase1 Initiator: success. (Initiator, Aggressive-Mode). 08/08/2013 12:12:08.085 racoon[1177]: IKE Packet: transmit success. (Initiator, Aggressive-Mode message 3). 08/08/2013 12:12:08.085 racoon[1177]: IPSec Phase1 established (Initiated by me). 08/08/2013 12:12:09.230 racoon[1177]: IPSec Extended Authentication requested. 08/08/2013 12:12:09.231 configd[19]: IPSec requesting Extended Authentication. 08/08/2013 12:12:14.074 configd[19]: IPSec sending Extended Authentication. 08/08/2013 12:12:14.089 racoon[1177]: IKE Packet: transmit success. (Mode-Config message). 08/08/2013 12:12:14.089 racoon[1177]: IPSec Extended Authentication sent. 08/08/2013 12:12:15.222 mDNSResponder[59]: ERROR: socket closed prematurely tcpInfo-&gt;nread = 0 08/08/2013 12:12:15.601 racoon[1177]: IKEv1 XAUTH: success. (XAUTH Status is OK). 08/08/2013 12:12:15.601 racoon[1177]: IPSec Extended Authentication Passed. 08/08/2013 12:12:15.602 racoon[1177]: IKE Packet: transmit success. (Mode-Config message). 08/08/2013 12:12:15.602 racoon[1177]: IKEv1 Config: retransmited. (Mode-Config retransmit). 08/08/2013 12:12:15.602 racoon[1177]: IPSec Network Configuration requested. 08/08/2013 12:12:18.367 racoon[1177]: IPSec Network Configuration established. 08/08/2013 12:12:18.367 racoon[1177]: IKE Packet: receive success. (MODE-Config). 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration started. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: INTERNAL-IP4-ADDRESS = 1.1.1.1. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: INTERNAL-IP4-MASK = 255.255.255.255. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: SAVE-PASSWORD = 1. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: INTERNAL-IP4-DNS = 1.1.1.1. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: INTERNAL-IP4-DNS = 1.1.1.1. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: DEF-DOMAIN = tudelft.nl. 08/08/2013 12:12:18.368 configd[19]: IPSec Network Configuration: DEFAULT-ROUTE = local-address 1.1.1.1/32. 08/08/2013 12:12:18.396 configd[19]: IPSec Phase2 starting. 08/08/2013 12:12:18.398 configd[19]: IPSec Network Configuration established. 08/08/2013 12:12:18.398 configd[19]: IPSec Phase1 established. 08/08/2013 12:12:18.398 configd[19]: event_callback: Address added. previous interface setting (name: en1, address: 1.1.1.1), current interface setting (name: utun1, family: 1001, address: 1.1.1.1, subnet: 255.255.255.255, destination: 1.1.1.1). 08/08/2013 12:12:18.402 racoon[1177]: IPSec Phase2 started (Initiated by me). 08/08/2013 12:12:18.404 racoon[1177]: IKE Packet: transmit success. (Initiator, Quick-Mode message 1). 08/08/2013 12:12:18.416 configd[19]: network changed: v4(utun1+:1.1.1.1, en1) DNS! Proxy! SMB- 08/08/2013 12:12:18.000 kernel[0]: utun_ctl_connect: creating interface utun1 08/08/2013 12:12:18.541 configd[19]: IPSec port-mapping update for en1 ignored: VPN is the Primary interface. Public Address: 915e4d79, Protocol: None, Private Port: 0, Public Port: 0 08/08/2013 12:12:18.597 racoon[1177]: IKE Packet: transmit failed. (Information message). 08/08/2013 12:12:18.597 racoon[1177]: IKEv1 Information-Notice: transmit failed. (Delete ISAKMP-SA). 08/08/2013 12:12:19.543 racoon[1177]: Connecting. 08/08/2013 12:12:19.543 racoon[1177]: IPSec Phase1 started (Initiated by me). 08/08/2013 12:12:19.551 racoon[1177]: IKE Packet: transmit success. (Initiator, Aggressive-Mode message 1). 08/08/2013 12:12:19.651 com.apple.time[584]: Interval maximum value is 946100000 seconds (specified value: 9223372036854775807). 08/08/2013 12:12:20.609 racoon[1177]: IKEv1 Information-Notice: transmit success. (Without ISAKMP-SA). 08/08/2013 12:12:20.609 configd[19]: IPSec Controller: IKE FAILED. phase 5, assert 0 08/08/2013 12:12:20.611 configd[19]: IPSec disconnecting from server 1.1.1.1 08/08/2013 12:12:20.612 racoon[1177]: IPSec disconnecting from server 1.1.1.1 08/08/2013 12:12:20.622 racoon[1177]: IPSec disconnecting from server 1.1.1.1 08/08/2013 12:12:20.000 kernel[0]: SIOCPROTODETACH_IN6: utun1 error=6 08/08/2013 12:12:20.670 configd[19]: network changed: v4(en1:1.1.1.1, utun1-:1.1.1.1) DNS! Proxy! SMB+ 08/08/2013 12:12:20.743 configd[19]: network changed: v4(en1:1.1.1.1) DNS* Proxy SMB 08/08/2013 12:12:20.761 awacsd[77]: InnerStore GetWakeInfoForZone: zero address for 423580700.members.btmm.icloud.com. 08/08/2013 12:12:25.816 netbiosd[227]: name servers down? /code/pre  <comment115551> Has it ever worked for you on the trains or no?  I know that some networks try to block VPNs since they can be used to go around their TOS.  I'm not suggesting that you can't get it working - just curious to try and narrow down issues. <comment115557> No, it has never worked for me on the Dutch trains which have a T-Mobile network. I don't suspect that they block it as they suggest the use of VPN themselves.