How to block non-vpn traffic on Sierra? <body> I use an openvpn client to a private server.  however when I run codepfctl -e -f /etc/pf.conf/code i have the following error that i can't fix on line 20 referring to antispoofing. if I remove the antispoofing line, it works.   any ideas?  my config is as follows:  precode# Options set block-policy drop set fingerprints "/etc/pf.os" set ruleset-optimization basic set skip on lo0  # Interfaces vpn_intf = "{ utun0 utun1 utun2 utun3 }"  # Ports allowed_vpn_ports = "{ 1:65535 }"  # Table with allowed IPs table &lt;allowed_vpn_ips&gt; persist file "/etc/pf.anchors/vpn.list" file "/etc/pf.anchors/custom.list"  # Block all outgoing packets block out all  # Antispoof protection antispoof for $vpn_intf inet  # Allow outgoing packets to specified IPs only pass out proto icmp from any to &lt;allowed_vpn_ips&gt; pass out proto {tcp udp} from any to &lt;allowed_vpn_ips&gt; port $allowed_vpn_ports  # Allow traffic for VPN interfaces pass out on $vpn_intf all /code/pre  This is the error that i receive.   precodepfctl: Use of -f option, could result in flushing of rules present in the main ruleset added by the system at startup. See /etc/pf.conf for further details.  No ALTQ support in kernel ALTQ related functions disabled /etc/pf.anchors/org.vpnonly.pf.rules:20: rule expands to no valid combination pfctl: Syntax error in config file: pf rules not loaded pfctl: load anchors /code/pre  This is in Sierra 10.12.1 