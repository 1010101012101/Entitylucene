Best way to isolate iMac internet connection problem in small office? <body> I manage a small office that is 7 macs and 1 PC.  One 2010 iMac in aprticular has ongoing internet connectivity issues where it says it's connected (via Network Diagnostics) but it goes out again intermittently (all other computers maintain network connectivity without issue). The computer is connected via ethernet 10ft away from the router.  On occasion I have it login wirelessly and the issue goes away then comes back again  ol liWhat is the best workflow of tests to run to isolate this annoying issue? I'm not at this location all day and it occurs when I'm not usually there.  My concern is it may be the ethernet board which may be difficult to isolate./li liAre there any particular tests I can run to isolate where along the computer to network path, the issue is occurring? /li liShould I just change the ethernet cable first?  I believe I already had done so on this machine... /li liIs Network diagnostics reliable? /li liShould I just trying pinging Google from the command line? /li liShould I watch the System Prefs panel and look for the self-managed IP or look for an IP lease from the router?/li /ol  Thanks  strongUPDATE/strong Here's some console.log entries.  The App store connectivity issue happened when I was trying to download Mountain Lion to upgrade the machine and is evidence of the reoccurring issue.  The internet connectivity just disappears. I was there today when this happened but it was so intermittent  precode11/21/12 12:18:36 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[266]) Exited with exit code: 1 11/21/12 12:18:36 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:18:46 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[268]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:18:46 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[268]) Exited with exit code: 1 11/21/12 12:18:46 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:18:55 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:55 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:55 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:56 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:56 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:56 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[269]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:18:56 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[269]) Exited with exit code: 1 11/21/12 12:18:56 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:18:57 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:57 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:58 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:58 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:59 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:18:59 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:00 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:00 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:01 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:02 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:02 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:02 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:02 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:02 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:03 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:03 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:03 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:03 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:03 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:03 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:03 PM    storeagent[121] Invalid port: com.apple.storeClient-38336 in process: 215 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:05 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:05 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:05 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:05 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:05 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:05 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:06 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[274]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:19:06 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[274]) Exited with exit code: 1 11/21/12 12:19:06 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:19:09 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:09 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:09 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:16 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[275]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:19:16 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[275]) Exited with exit code: 1 11/21/12 12:19:16 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:26 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:26 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:26 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:26 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   Wed Nov 21 12:19:26 matisses-imac-4.local App Store[272] &lt;Error&gt;: CGBitmapContextGetBitsPerComponent: invalid context 0x10038feb0 11/21/12 12:19:26 PM    [0x0-0x21021].com.apple.appstore[272]   This isn't a bitmap context. Forcing destination format to ARGB_8 for CGContext. 11/21/12 12:19:26 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[276]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:19:26 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[276]) Exited with exit code: 1 11/21/12 12:19:26 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:19:36 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[278]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:19:36 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[278]) Exited with exit code: 1 11/21/12 12:19:36 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:19:46 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[279]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:19:46 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[279]) Exited with exit code: 1 11/21/12 12:19:46 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor) Throttling respawn: Will start in 10 seconds 11/21/12 12:19:55 PM    storeagent[121] Invalid port: com.apple.storeClient-61011 in process: 272 11/21/12 12:19:55 PM    com.apple.launchd.peruser.501[104]  ([0x0-0x20020].com.apple.ActivityMonitor[263]) Exited: Killed 11/21/12 12:19:55 PM    com.apple.launchd.peruser.501[104]  ([0x0-0x1c01c].com.apple.Safari[240]) Exited: Killed 11/21/12 12:19:56 PM    storeagent[121] Invalid port: com.apple.storeClient-61011 in process: 272 11/21/12 12:19:56 PM    SystemUIServer[109] [Warning] Disconnected from iChatAgent (remote)... 11/21/12 12:19:56 PM    SystemUIServer[109] [Warning]  ... disconnection from iChatAgent (remote) being handled by main thread 11/21/12 12:19:56 PM    com.apple.launchd.peruser.501[104]  (com.apple.AirPortBaseStationAgent[137]) Exited: Killed 11/21/12 12:19:56 PM    com.apple.launchd.peruser.501[104]  ([0x0-0x13013].com.apple.iChatAgent[160]) Exited: Killed 11/21/12 12:19:56 PM    CrashPlan menu bar[163] Received `applicationShouldTerminate:` message 11/21/12 12:19:56 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[280]) posix_spawn("/Library/Printers/hp/hpio/HP Device Monitor.app/Contents/MacOS/HP Device Monitor", ...): No such file or directory 11/21/12 12:19:56 PM    com.apple.launchd.peruser.501[104]  (com.hp.devicemonitor[280]) Exited with exit code: 1 11/21/12 12:20:15 PM    com.apple.launchd[1]    *** launchd[1] has started up. *** 11/21/12 12:20:38 PM    com.teamviewer.service[57]  Wed Nov 21 12:20:38 matisses-imac-4.local TeamViewer_Service[57] &lt;Warning&gt;: 3891612: (CGSLookupServerRootPort) Untrusted apps are not allowed to connect to or launch Window Server before login. 11/21/12 12:20:38 PM    com.teamviewer.service[57]  Wed Nov 21 12:20:38 matisses-imac-4.local TeamViewer_Service[57] &lt;Error&gt;: kCGErrorRangeCheck: On-demand launch of the Window Server is allowed for root user only. 11/21/12 12:20:38 PM    com.teamviewer.service[57]  Wed Nov 21 12:20:38 matisses-imac-4.local TeamViewer_Service[57] &lt;Error&gt;: kCGErrorFailure: Set a breakpoint @ CGErrorBreakpoint() to catch errors as they are logged. /code/pre  <answer72159> Is this a wireless or wired network? Sometimes if you have a wired network and the wireless device is on and associated, it will break routing. Generally speaking you want to choose one or the other. So if you are wired, disable the wireless device.  Other then that, network diag is pretty reliable and pinging google (or any other internet site) is good.   <answer94839> Ruling out a bad cable or port is an excellent first step. A bad cable or a bad switch port is at least as likely as a bad ethernet port on the iMac. I would start by swapping the cable emand/em switch port for known good ones. Swap the cable and port with a computer that you are sure does not demonstrate the problem. Write down what you did, and when you did it, for future reference.  If that computer develops a similar problem and the iMac is fine, then you know it is either the switch port or the cable. Move the known-good cable to the suspect port. If the cable is bad, cut it in half so no one tries to use it again. If the port is bad, block it with something - like the cut-off tail of a bad cable.  After you have verified the cable and switch port, you can go back to suspecting the iMac ethernet port. Maybe buy a cheap USB ethernet adapter, and switch that iMac to it? If that fixes the problem, then you know it was the ethernet port. If not, it's probably something in the software configuration.  <comment83771> anything interesting in the console when the link drops? <comment83929> There is a repeating occurrence of a search for an HP DeviceMonitor not finding the app to to run and respawning every 10 seconds.  But I'm not sure that would be it.  Now I have to figure out how to disable this process... <comment108026> First of all rule out a bad ethernet cable, and a bad port in the router (etc). <comment136637> Did you ever find resolution? Hardware or software issue?