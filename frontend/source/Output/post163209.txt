Disabling NTP on OS X Lion or older <body> Following a new security vulnerability in the Network Time Protocol software package, Apple has provided a software update for Mountain Lion and newer versions of OS X.  As usual, the older versions of OS X that one may be stuck with (because the hardware does not support newer versions, because one needs Rosetta, …) are not covered by the security update.  My questions are:  ul liis disabling “set date and time automatically” in Software Preferences enough to ensure that ntpd is not running?/li liwhat might break if the ntdp binary was simply deleted for safety on OS X Snow Leopard or Lion?/li /ul  In doubt I might use these instructions to limit the scope of ntpd without completely disabling/deleting it, but in this case there remains the risk of getting it wrong and leaving ntpd exposed.  <answer163234>    is disabling “set date and time automatically” in Software Preferences enough to ensure that ntpd is not running?   strongYes/strong.  Here is the way to insure yourself of this. Open a codeTerminal/code or codexterm/code window.  Run the following command:  precodeps ax | grep ntp /code/pre  and notice that you have an codentpd/code process running.  Open codeSystem Preferences/code and turn off codeSet date and time automatically:/code  Check with the codeps/code command above that you don't have any codentpd/code process running. hr Don't remove the codentpd/code binary, this is not necessary and would deprive you of the chance to take advantage of a fix from Apple :).  hr     In doubt I might use these instructions to limit the scope   strongNo/strong.  This receipe will leave you with a running codentpd/code and hence exposed to an attack.  <answer163305> Instead of disabling ntpd, you should download the source for version 4.2.8 of ntp and compile it yourself. All you need is Xcode for Lion/SnowLeo. It should work on 10.6.x and 10.7.x just fine.  I have updated my 10.10 install immediately after the CVE was made public and source code released and I didn't wait on Apple to release the update.   To compile ntpd, download the source from ntp.org and apply the patch for OS X/FreeBSD. After applying this patch, you will be able to just run "./configure &amp;&amp; make." Then you can copy the binaries to appropriate directories (/usr/sbin/ and /usr/bin/).  For Mac OS X 10.7 (Lion):  precodemkdir ntpd-fix cd ntpd-fix curl http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.8.tar.gz | tar zxf - cd ntp-4.2.8/ntpd curl http://bugs.ntp.org/attachment.cgi?id=1165 | patch -p1 cd .. ./configure &amp;&amp; make /code/pre  Here's the list of files and folders to which they belong to that will be built from the source above. After compilation, all these files will be in various sub-folders.  precode/usr/bin/sntp   /usr/bin/ntp-keygen   /usr/bin/ntpq   /usr/sbin/ntpdc   /usr/sbin/ntpdate   /usr/sbin/ntpd /code/pre  Rename old ones using something like:  precodesudo mv /usr/sbin/ntpd /usr/sbin/ntpd.old /code/pre  and then move the new one in. Make sure to chown the files after moving them in place:  precodesudo chown root:wheel /usr/sbin/ntpd /code/pre  strongNote/strong: I did not use  codesudo make install/code because I didn't trust the Makefile  (I wasn’t sure it would place files in the same folders that Apple has originally placed them in and wanted to be sure they're still in the same spot as old ones). Manually moving 6 files is not a big issue. Rest of the files (man pages, html pages, etc are the same so you don't have to bother moving those.)  <answer163924> ol liI've not dug into the documentation of the breach in detail.  Normally ntp makes periodic queries to servers to get a correction.  Once the drift of the local clock is established these queries aren't frequent./li liMost firewalls are configured to ignore request packets from the outside.  Ntp I think uses UDP which is nominally stateless. Typically a firewall will let a UDP packet back in for a small window of time after a UDP packet has gone out.  The return packet has to be from the right IP, and have the correct port. A black hat would have to either subvert your DNS server or subvert your NTP server.  /li /ol  So would someone explain how this threat is actually put into play, assuming that the person doesn't specify pool.ntp.org as his ntp server?  hr  Ways around this:  ol liBuild from source -- above./li liUse mac ports.  This makes the installation fairly painless, although the initial build will take substantial time and a fair chunk of space.  More information https://www.macports.org//li /ol  You can also use Fink or Homebrew this way, but MacPorts seems to be less dependent on Apple OS, so in the long run for an older system I suspect there will be less pain.  ol start="3" liConfigure a non-vulnerable machine to be a local ntp server.  Point vulnerable machines to the ntp server.  At your firewall block both outbound and inbound for ntp for all but the ntpserver machine.  When I ran a local school network, I had one machine (freebsd) that ran a bunch of network services, including ntp.  It would then broadcast a single ntp packet every 64 seconds.   /li /ol  <comment191063> Please report this lack of security fix of versions customers are still using to Apple. → http://www.apple.com/feedback/macosx.html . They don't have a `security` feedback entry yet :(. <comment191096> @danielAzuelos I went as far as writing a blog post: http://blog.frama-c.com/index.php?post/2013/01/01/Software-obsolescence-and-security <comment191173> please add which files have to be copied and where to <comment191177> @klanomath I just edited my comment with more info. Let me know if you run into any issues. <comment191180> i added the rest and 10 points ;-) <comment191182> what about ntpsnmpd? <comment191184> @klanomath I don't believe Apple ships `ntpsnmpd`. It's not even a part of 10.10 and not a part of their security update either. If you need it (you probably don't) put it in `/usr/bin/`. But less stuff you have as executables is safer. <comment191197> For those who don't want to do manual replacements, it should suffice to run `./configure --prefix='/usr'` as the initial step and then follow up with `make ; sudo make install`. <comment191247> @TraneFrancks thanx i will test this in a vm and add it if it works properly <comment191249> @MelB I hope you don't mind if i rework your question e.g. add TraneFrancks advice (after properly testing it)? <comment191295> @klanomath After you double-check it, go right ahead! I didn't have VM handy to see where exactly all the executables ended up. <comment191449> Just a note that `make install` puts `ntpsnmpd` in `/usr/sbin`, not `/usr/bin`. <comment191537> For some reason unchecking "set date and time automatically" did not kill the ntpd process for me. I had to run: `sudo launchctl unload /System/Library/LaunchDaemons/org.ntp.ntpd.plist` <comment191618> The command you used is exactly what the GUI of `System Preferences` is doing. When using it, you should check with a `tail -f /var/log/system.log` what might be going wrong within your `System Preferences`. To investigate this problem I advise you to launch another question. <comment192042> @PascalCuoq offtopic: You might revive that iMac with converting it to hackintosh with NUC) — https://www.google.com.ua/search?client=safari&rls=en&q=iMac+hackintosh+NUC&ie=UTF-8&oe=UTF-8&gfe_rd=cr&ei=5LGgVJ2QFaeG8Qf704HwCA Thought I don't know if 17" worth the trouble. Yet 20" definitely does <comment213433> NTP v4.2.8p2 has just been released. It can be downloaded here: http://archive.ntp.org/ntp4/ntp-4.2/ntp-4.2.8p2.tar.gz