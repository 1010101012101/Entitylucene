VMware fast for first user, sluggish for second <body> After launching VMware and opening the virtual machine prepared by another user, Windows 7 runs very slowly. File read/write is 10-30x slower than it should be and Windows has started to animate window move/resize, which brings the OS (or VMware?) to its knees.  How do I go about debugging the problem?  strongClarification/strong The two users are two accounts on the very same MacBook. The two users share the same OSX, and so it seems reasonable for them to also share the same Windows VM.  strongUpdate/strong After yet another fresh installation of VMware + Windows 7, this time installed and used exclusively by one user, the same sluggishness is starting. There are a few suspicions.  Mds is going berzerk, for instance. Could it be that it is indexing (and interfering somehow) with the separate partition on which the windows VM is installed?  The sluggishness starts after a little use: the unzipping of my code and a few debugging cycles under windows. Could my going along with VMware's default of making the disk usage grow as needed be contributing to some fragmentation so early on? VMware, as I now see, suggest using the non-default (allocate disk storage from the first moment of install) for production use. (What other use is there? And how could the non-production use be the default?)  <answer46645>    How do I go about debugging the problem?   Passing VM images around is tricky business. The image is often created with hypervisor extensions that take advantage of specific hardware features on the machine where the VM was created. If you're not using precisely the same hardware (especially the same CPU) the VM can run slowly or even crash your host OS or lock up your CPU.  I'd start with getting the VM back to an initial state:  ol liDelete all the snapshots in the VM/li liPower down the guest OS so it's "off", not just suspended/li liBring up the Virtual Machine Library window (Shift+Cmd+L) and select the VM/li liClick the Wrench icon in the toolbar to bring up the settings window for this VM/li liSelect 'Advanced' and make sure the preferred virtualization engine is set to 'Automatic' and that hard disk buffering is also set to 'Automatic'/li liClick 'Show All' to return to the main settings/li liClick 'Compatibility' and make sure the VM's compatibility is set to be with the version of VMWare you're running or higher (in my case that's Fusion 4 or higher) so you don't need legacy VM capabilities maintained/li liClick 'Show All' and return to the main settings/li liClick 'Display' and make sure 3D graphic acceleration is on. If it cannot be turned on this is a pretty good hint that the VM was created with another chipset and really isn't compatible with your machine./li liClick 'Show All' and return to the main settings/li liClick 'General' and then press the 'Clean Up Virtual Machine' button. This will get rid of all the extra cruft from snapshots and get you back to a nice clean VM image state./li liClick 'Show All' and return to the main settings/li liClick 'Processors &amp; RAM' and set these to suit your needs. You need at least 1 processor, but if you have a multi-core machine you could set this higher. Ideally you wouldn't ever set the number of processors in the VM to any more than Physical Cores in the Machine - 1. That way your physical machine always has one core to itself. RAM should be set to at least the recommended value. If you have a lot of RAM in the machine you can increase this but don't go too crazy with it./li liNow power up the VM and do a re-install of the VMWare Tool (Virtual Machine - Reinstall VMWare Tools...)./li /ol  Other things to consider:  ul liThe VM should be on fast disk. This usually means your primary drive in your machine. If it's on a USB-attached disk or a network attached drive performance will suffer./li liYou can't both use the VM image at the same time. I say this in case you have it on a shared drive and you're both trying to run it at the same time. You have to make your own, unique copies of the image./li liCheck the Task Manager in the VM to see what's running. Maybe you have a process or two that's going off the rails and eating up all the VM CPU. If that's the case  you're in to a straight why-is-this-process-misbehaving-in-Windows type question and you'd need to take it to http://superuser.com I suspect./li /ul  If this doesn't get the VM in to a useable state it's likely that your hardware and the hardware the VM was created on are too far apart in compatibility for you to pass the VM around.  <answer50194> Read VMware support article 1015676 to learn about the things that could be causing slowdowns and what you can do about them.  As standard practice, I change some memory management settings as I explain in this answer to another VMware performance question.    Things to check in particular, given "mds going berzerk":   ul liExclude your VMs from Time Machine Backups/li liDisable Spotlight indexing on your FAT32 drive (if it's not already disabled), or at least for the folder you have your VMs in (by adding the folder to the System Preferences - Spotlight - Privacy tab). /li /ul  With regard to pre-allocating disk space, whether or not that is a performance penalty or not or how big an impact it has on you completely depends on your disk usage pattern.  It is a performance hit to expand the size of the drive.  If you rarely delete stuff from the disk but often add stuff (especially if you are running programs that are generating files, e.g. log files or transcoded media files) then you will suffer the most.  If you download big files, use them, and then delete them, you'll probably end up with enough allocated free space to not notice the difference.  You can also experiment with:   ul liEnable hard drive buffering.  This was critical for me when my VM was on a RAID 5 array, but otherwise didn't matter.  VM settings - Advanced, set "Hard drive buffering" to "Enabled"/li liEnable/Disable Windows Pagefile.  For a real computer the best advice is to leave the pagefile active and system managed under Windows 7 (as opposed to XP, where it is probably better to remove it if you have enough RAM).  For a VM using a virtual disk it is not as clear cut, but easy enough to test.  Follow these directions to get to the page file settings but instead of choosing a size, select "No paging file".  /li /ul  <comment53320> My clarification (no hardware difference) notwithstanding, I am stuck at item 1! What is a "snapshot"? <comment53321> @Calaf snapshots are saved states of the virtual machine. From the Virtual Machine Library window (Shift+Cmd+L) you can right click on a VM and select Snapshots... from the list to see all the saved states. Delete all of them. <comment53325> I see just one snapshot, marked "Current State -- Powered Off". Selecting it does not enable the "Delete" option in the Edit menu. Right-clicking on it does not show an option to delete it. What to do? <comment53327> That's great. That means you have no snapshots and the machine is already powered down! Skip to step 3 above. <comment53335> Steps 5, 7, and 9 were already at the setup you suggested. Running steps 11 and 12 didn't help. Just moving through the items in the Start menu is very slow. It's even more bothersome. The VM is now slow even for the first user. Is there any simpler solution than reinstalling windows? <comment53336> See edited question steps 12 and 13. Are you running any software *in* in the VM when it's slow or is it just the plain, vanilla OS that's running? <comment53337> The Task Manager shows ~0% CPU for every process. Only one user is logged in and using the VM at a time (after an OS X restart). The only potential problem is that I went ahead and used the BOOTCAMP partition (which is FAT32, not UFS+), but I doubt that's a factor since Windows 7 did initially run very smoothly over VMware. <comment53339> let us [continue this discussion in chat](http://chat.stackexchange.com/rooms/2935/discussion-between-ian-c-and-calaf) <comment53340> Do you have (legacy) FileVault enabled on one of the user accounts (the slower one)? By default, VMware Fusion puts new VM's in your ~/Documents directory and therefore the extra overhead required by FileVault can considerably slow down a VM's performance. I move the Virtual Machines directory to the root on (legacy) FileVault'd machines <comment53341> Ah.. here is something that has worked. I had tried item 14 by selecting "repair..", which didn't help. Now I've selected "remove.." and installed a fresh copy of VMware Tools. Let me check whether it's smooth for the second user. <comment53342> @binarybob No FileVault used, but VM sits on a separate FAT32 partition. If anything, a separate partition should be better, no? And the OS X driver appears to be generally nimble with FAT32 access. <comment53343> @Calaf yes, the driver installation processes helps optimize the guest drivers for the underlying hardware. If you move the VM it's pretty much a given you have to reinstall the VMWare drivers. <comment53357> @Ian C. Initially VMware installed into ~/Documents, but I made a second (completely separate, not a move) install directly in /Volumes/BOOTCAMP. It's that Windows 7 VM install (in /Volumes/BOOTCAMP) that I'm trying to make usable by multiple accounts on the same MacBook. <comment53439> @Calaf as long as they aren't trying to use it *at the same time* that should be a-okay. Did the VMWare Tools reinstall help? <comment53685> Yes, only one user was logged in at a time, and still.. Removing then installing (not repairing) the VMware tools helped for the user that did it, but Windows became sluggish for the other user! I am giving up. <comment53982> "The sluggishness starts after a little use" -- are you sure it's not your dev work that's dragging it down? What does Process Explorer show happening on the VM when it's sluggish? If you want a hand debugging this we should take it to a chat... <comment54851> @IanC. I am about to reinstall the Windows VM after setting "Pre-allocate space" under "Hard Disk" in the VM-Settings. I am surprised you didn't mention it even though your message is quite thorough. Is it your experience that it makes little difference in practice? <comment54854> I haven't noticed a performance hit on my Windows VMs and I don't pre-allocate the space. If it makes a difference report back and let us know! <comment58135> My disk-use pattern under Windows is to copy my zip code archive from OS X to Windows VM, unpack, compile/debug, and finally rename the zip and the unpacked directory to 01, 02, ... to be ready for the next iteration after some debugging. In other words, I am not deleting the iterations as I go, but as a batch when a new release is ready. However, each compile/debug cycle consists of the deletion of old object files by Visual Studio. I am not sure if these deletions themselves could cause fragmentation/slowdown under vmware. <comment58146> @Calaf, sounds like you'd be better served by pre-allocated disk.  The only reasons not to use pre-allocated disk are that it takes up more disk space on the host and it makes the VM bigger to copy. If those are not issues, then definitely pre-allocate the disk.  Otherwise, you might try forcing growth by making an extra copy of the new code and then deleting it and emptying the Recycle Bin (to free up the newly allocated disk space) each time you bring over a new version.  (The virtual disk never automatically shrinks.) <comment58155> ..and one cannot just move from incremental to pre-allocated disk on-the-fly. It is necessary to install Windows from scratch. Is that right? The size is, incidentally, not an issue, as I am dedicating a partition to the Windows VM. <comment58156> @Calaf, you can switch to pre-allocated easily.  Shut down Windows so the VM appears powered-off, then in the VM Settings, select the hard disk, Advanced options, and click "Pre-allocate disk space" and then click "Apply". <comment58157> How nice, but as my tough luck would have it, I get "There is not enough space on the file system for the selected operation" -- even though I had left 2GB to account for the different interpretations of "GB". On a 40GB partition that should have been enough, so something else must be playing a role. <comment71086> It's also helpful to disable the eye candy in Windows 7: Control Panel (View: Large Icons) \ System \ Advanced System Settings (in left pane) \ Advanced \ Performance \ Settings \ Visual Effects \ Adjust for Best Performance.