Why does find-certificates have some missing? <body> I seem to have a certificate in the keychain that is only sometimes output correctly from codesecurity find-certificate/code on the command line:  precodesecurity find-certificate -a -p | openssl x509 -text | grep -i comodo /code/pre  The manual claims that this "Exports all certificates from all keychains". Specifying the system root keychain is no help:  precodesecurity find-certificate -a -p /System/Library/Keychains/SystemRootCertificates.keychain | openssl x509 -text | grep -i comodo /code/pre  Adding a query suddenly produces a result:  precodesecurity find-certificate -a -p -c comodo /System/Library/Keychains/SystemRootCertificates.keychain | openssl x509 -text | grep -i comodo /code/pre  The same query on "all keychains" has no result (this time an error from openssl because the input is now empty):  precodesecurity find-certificate -a -p -c comodo | openssl x509 -text | grep -i comodo /code/pre  What is going on?  <answer261051> This is due to a combination of two factors:  ol liSpecifying the codeSystemRootCertificates.keychain/code is necessary, otherwise a personal keychain is used./li licodeopenssl/code will not parse a stream of multiple keys into a stream of text./li /ol  The following runs codeopenssl/code once per certificate and accomplishes what I was looking for:  precodesecurity find-certificate -a -p /System/Library/Keychains/SystemRootCertificates.keychain \ | awk '/-----BEGIN CERTIFICATE-----/ { cert = "" } \        { cert = cert $0 "\n" } \        /-----END CERTIFICATE-----/ { \            openssl = "openssl x509 -text"; \            print cert | openssl; \            close(openssl) \        }' /code/pre 