Girlfriend’s laptop won’t backup to my Time Machine server <body> I built a Time Machine server, paleophile.local, out of a 2009 white Unibody MacBook running Sierra on which I installed macOS Server.  I attached a 5 TB external via USB to store the encrypted sparse bundles.  It is working splendidly for my early-2015 MacBook Pro running Sierra.  Unfortunately I cannot seem to get my girlfriend’s mid-2009 MacBook Pro running El Capitan to backup to paleophile.  (Her computer cannot be upgraded to Sierra.)  Our LAN is handled by an Apple Airport Extreme (the flat one) to which paleophile is connected by ethernet.  Both my laptop and hers generally connect to the network via WiFi.  I have also tested her backup setup over ethernet with WiFi turned off; unfortunately with the same results.  I have setup one account on the server for each of our laptops.  Thus her's connects to the server through a different account than mine.  Please note that those accounts were setup at the same time and in the same manner so I would expect that they would be identical in configuration.  The motivation for these separate accounts was to take advantage of the capacity to apply a disk usage ceiling, particularly on myself.  The error message my girlfriend’s computer reports is that the username and password are incorrect.   img src="https://i.stack.imgur.com/0rCwn.png" alt="Error Dialog on Girlfriend&#39;s Laptop"    Of course I have checked them.  To be precise I mounted the server, logging in as the same user with the same password and then mounting the already existing encrypted backup with the key.  That all worked perfectly.  Another difference between her laptop and mine that may be relevant is that if I look in 'Keychain Access' for keys related to paleophile I see the following...   on my laptop:  precodepaleophile._smb._tcp.local.              Time Machine Password /code/pre  while on hers the quite distinct key appears   precodepaleophile._afpovertcp._tcp.local.       Time Machine Password /code/pre  So it appears that our two machines are attempting to use different protocols to communicate with the server.  Is this because my laptop is running Sierra and hers is running El Capitan?  hr  Using the information provided by correspondents in the comments below I examined the configuration of the my Time Machine server.  It is setup to accept both AFP and SMB connections for my girlfriend's account.  Here is a screenshot of that config panel.  img src="https://i.stack.imgur.com/IvWL3.png" alt="Girlfriend Account Config Panel"  It appears that the TM server is at least emconfigured/em to accept AFP connections, even if it is failing to do so.    hr  The error message that appears in her Console.app when I try to trigger a backup is  precode6/6/17 7:33:39.244 PM   Finder[239] _CSBackupServerProxyCopyMountPointForDestination returned result code: 29 /code/pre  I've done my best to Google error code 29, but have been unable to find any useful information. What steps should I take to diagnose this problem further?  hr  Here's a sample of the error log on her laptop starting from the moment I select "Back Up Now".  precode6/6/17 7:33:39.244 PM   Finder[239] _CSBackupServerProxyCopyMountPointForDestination returned result code: 29 6/6/17 7:33:41.823 PM   lsd[227]    LaunchServices: Could not store lsd-identifiers file at /private/var/db/lsd/com.apple.lsdschemes.plist 6/6/17 7:34:02.742 PM   lsd[227]    LaunchServices: Could not store lsd-identifiers file at /private/var/db/lsd/com.apple.lsdschemes.plist 6/6/17 7:34:02.849 PM   lsd[227]    LaunchServices: Could not store lsd-identifiers file at /private/var/db/lsd/com.apple.lsdschemes.plist 6/6/17 7:34:12.160 PM   lsd[227]    LaunchServices: Could not store lsd-identifiers file at /private/var/db/lsd/com.apple.lsdschemes.plist 6/6/17 7:44:48.617 PM   accountsd[268]  AIDA Notification plugin running 6/6/17 7:44:50.149 PM   com.apple.AddressBook.InternetAccountsBridge[375]   Checking iCDP status for DSID 126881918 (checkWithServer=0) 6/6/17 7:44:50.225 PM   com.apple.AddressBook.InternetAccountsBridge[375]   XPC Error while checking if iCDP is enabled for DSID 126881918: Error Domain=NSCocoaErrorDomain Code=4099 "The connection to service named com.apple.cdp.daemon was invalidated." UserInfo={NSDebugDescription=The connection to service named com.apple.cdp.daemon was invalidated.} 6/6/17 7:44:50.225 PM   com.apple.AddressBook.InternetAccountsBridge[375]   Daemon connection invalidated! 6/6/17 7:45:00.172 PM   com.apple.AddressBook.ContactsAccountsService[273]  [Accounts] Current connection, &lt;NSXPCConnection: 0x7ff6dad0d680&gt; connection from pid 252, doesn't have account access. 6/6/17 7:45:00.172 PM   sharingd[252]   [Accounts] Failed to update account with identifier B851945A-3D25-4379-8AD5-AE2A53F59E57, error: Error Domain=ABAddressBookErrorDomain Code=1002 "(null)" 6/6/17 7:45:00.200 PM   com.apple.AddressBook.ContactsAccountsService[273]  [Accounts] Current connection, &lt;NSXPCConnection: 0x7ff6dad2a7a0&gt; connection from pid 396, doesn't have account access. 6/6/17 7:45:00.200 PM   DataDetectorsDynamicData[396]   [Accounts] Failed to update account with identifier B851945A-3D25-4379-8AD5-AE2A53F59E57, error: Error Domain=ABAddressBookErrorDomain Code=1002 "(null)" 6/6/17 7:45:00.397 PM   com.apple.AddressBook.ContactsAccountsService[273]  [Accounts] Current connection, &lt;NSXPCConnection: 0x7ff6dad2e100&gt; connection from pid 274, doesn't have account access. 6/6/17 7:45:00.398 PM   CalNCService[274]   [Accounts] Failed to update account with identifier B851945A-3D25-4379-8AD5-AE2A53F59E57, error: Error Domain=ABAddressBookErrorDomain Code=1002 "(null)" 6/6/17 8:00:45.025 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveTrackingHandler: -1856 6/6/17 8:00:45.025 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveReceiveHandler: -1856 6/6/17 8:00:50.971 PM   sharingd[252]   20:00:50.970 : SDConnectionManager:: XPC connection invalidated 6/6/17 8:01:15.102 PM   Finder[239] _CSBackupServerProxyCopyMountPointForDestination returned result code: 29 6/6/17 8:12:34.938 PM   com.apple.prefs.backup.remoteservice[1172]  Could not connect action, target class TMOptionsSheetController does not respond to -warnCullingPressed: 6/6/17 8:12:34.938 PM   com.apple.prefs.backup.remoteservice[1172]  Could not connect action, target class TMOptionsSheetController does not respond to -backUpOnBatteryPowerPressed: 6/6/17 8:12:43.377 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveTrackingHandler: -1856 6/6/17 8:12:43.378 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveReceiveHandler: -1856 6/6/17 8:12:51.594 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveTrackingHandler: -1856 6/6/17 8:12:51.594 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveReceiveHandler: -1856 6/6/17 8:13:01.354 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveTrackingHandler: -1856 6/6/17 8:13:01.354 PM   com.apple.prefs.backup.remoteservice[1172]  Error in CoreDragRemoveReceiveHandler: -1856 6/6/17 8:15:12.530 PM   Finder[239] _CSBackupServerProxyCopyMountPointForDestination returned result code: 29 6/6/17 8:16:30.156 PM   Finder[239] _CSBackupServerProxyCopyMountPointForDestination returned result code: 29 /code/pre  <answer288468> It turns out the whole AFP vs. SMB question was a red herring.  The issue was that her sparse bundle was corrupted.    I deleted her account and her sparse bundle (I now believe deleting her account was excessive) and started her over from scratch with a fresh account and sparse bundle.  That solved the problem.  This solution was discovered when a Mac Guru friend of mine suggested that I try backing her computer up to the server by letting her computer use my computer's credentials.  Her computer immediately began backing up successfully.  That was a big clue as to what was wrong.  <comment361023> There are a couple other entries in the error logs which may be relevant.  If anyone is interested I'll post those as well. <comment361291> Maybe a hint: ~$ launchctl error 29 -  29: Illegal seek <comment361292> Also: I'm actually running Sierra on my unsupported MBP from 2009. http://dosdude1.com/sierrapatch.html <comment361293> If you think those logs are relevant, why don't you just post them here? <comment361300> Ok @MaxRied.  I just edited my post to include a longer error log sample. <comment361313> Try connecting both the Time Machine server and your girlfriend's MBA to a wired network and disable wifi. You should edit your question to be more specific about which network protocols and connections are in use. <comment361316> Thanks @IconDaemon.  I've described my LAN and added what details about the protocols I can based on what I observe from looking in Keychain Access.  I also mentioned that I have done as you suggested and done the test over ethernet.  If you need more info about the protocols please let me know how I can acquire it. <comment361334> Are you connecting one from left panel of finder and the other via command-K (connect to server)? I think the key is that one is using SMB and the other AFP over TCP. <comment361336> Sorry @TimB.  This is all via Time Machine. <comment361370> I don't have access to a macOS server any more but there might be a setting in the configuration where you can allow other protocols other than SMB to access the TM server. From your new information, your girlfriend's laptop is trying to connect with afp, but that is being disallowed at the server end. BTW/ There are three machines involved here: the macOS server, your laptop, and your girlfriends laptop. I'm _assuming_ from context that the log file extract is from your girlfriend's laptop, but you should make a quick edit to indicate the source of the extract. <comment361394> @IconDaemon - I've clarified the source of the error log sample as you suggested.  I'll go and see if I can find such a setting in macOS Server. <comment361398> @IconDaemon - No luck finding a setting in macOS Server that would allow AFP over TCP.  Is there any way to convince her laptop to use SMB? <comment361403> Interesting stuff [here](https://support.apple.com/en-us/HT204445) From the above page: "check to see if your firewall is blocking TCP ports 137, 138, 139 and 445." This [page](https://support.apple.com/en-us/HT204021) too. **Aha!** Check [this page](http://www.macworld.com/article/3130110/servers/turn-up-the-time-machine-service-in-macos-server.html) . There's a screen-cap of a window where you can specify AFP, SMB, etc. Go down to the **Check the File Sharing service** section to take a gander. <comment361508> When you try to mount the encrypted sparse image manually, did you use smb or afp? <comment361511> To be honest @MaxRied, I have no idea.  I hit the connect button, typed in the credentials and it connected, no problems.  I never thought to check what protocol was being invoked.  How do I check? <comment361669> @IconDaemon and MaxRied -  I've updated my post to include a screenshot of the config panel you pointed me to.  It does appear to be set to allow incoming AFP connections. <comment361813> To check the protocol of the server connection, Command - I should give you details. The two UUIDs in the Permissions: list, 47B7... and 6BFE... should match the two laptops UUIDs, which can be obtained from Apple Menu  About This Mac  System Report ... and is listed under the Hardware Review as the Hardware UUID. Confirm. <comment361911> I was looking at another File Sharing config panel on Personal Folder Access and when I click the option to only allow encrypted connections it greys out the option to allow AFP connections.  Does this imply that AFP cannot support encrypted connections? <comment361912> @IconDaemon - I've checked the UUIDs of both laptops and neither is displayed on the screenshot I posted. <comment361947> I wonder what those UUIDs are? What's the UUID of the server hardware? <comment362006> @IconDaemon - It's not the server's UUID either. <comment362207> Have you verified that you can access the server and drive in the Finder from her computer?  Try Go:Connect To Server afp://paleophile._afpovertcp._tcp.local .  It should ask you for username and password. Once mounted, make sure you have read/write access from the Finder.   (or maybe just afp://paleophile.local ?) <comment362303> @JamieCox - Following your instructions I just connected to the TM server at `afp://paleophile._afpovertcp._tcp.local` from her machine.  I had full read/write access, no problems.  Although I note that doesn't give me access to the large external storage drive where all the encrypted Time Machine images are stored. <comment362354> Lack of access to the external drive seems like a problem, right? Time machine is going to have the identical access.  Normally, non-admin users don't have priviledge to create files at the root of a drive. On the server, select the "large external storage drive" and Get Info.  Look at the permissions at the bottom of the Get Info window. Probably "everyone" has read-only privileges. Change it to read-write (you'll need your admin password), and try things again. <comment362378> @JamieCox - Except that as I mentioned in my description, my laptop backs up perfectly to this server. <comment362442> @Keith I'm thinking that you and your GF probably connect as different users, with (potentially) different privileges. You may be connecting as a user who owns or has rw permission on the external drive, while she may not be? <comment362445> @Jamie - Indeed you are correct.  We do use separate accounts.  At your prompting I have added a discussion on this point to my question.  I will investigate and report back if I can find any sign of different permissions between the two accounts. <comment363331> @IconDaemon - I just noticed that there are UUIDs associated with the users as well as the hardware.  I haven't checked if those are the ones appearing in that list, but it's a possibility.