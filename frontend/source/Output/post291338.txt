How do I fsck_apfs an encrypted volume? <body> I'm playing with macOS 10.13 beta but a volume seems to have been corrupted during migration to APFS. I can boot and log in but soon get a "static screen". I launched recovery mode and launched disk utility. When trying to run First Aid I get exit code 65. So I started the terminal:  If I run codediskutil apfs list/code I see the volume encrypted and locked.   I then tried codediskutil apfs unlockVolume /dev/disk1s1/code which unlocks AND mounts the volume.   Now codefsck_apfs /dev/rdisk1s1/code and codefsck_apfs /dev/disk1s1/code give codeerror: container /dev/rdisk1 is mounted with write access./code   How can I try and repair this volume? I suspect that something happened during the initial migrate and the volume is stuck in half APFS, half HFS+ somehow.  Update:  If I go back to "Disk Utility" and unmount the volume there and return to Terminal, then codefsck_apfs /dev/disk1s1/code gives codeerror: container /dev/rdisk1 is mounted./code I try and unmount the "Image Volume", but codediskutil umount /Volumes/Image\ Volume//code gives codeVolume Recovery on disk1s3 failed to unmount: dissented by PID 0 (kernel)/code   <answer294497> Apple got back to my via Bug Reporter, saying codediskutil apfs unlockVolume -nomount /dev/disk1/code should unlock the volume but not mount it. This worked for me, but unfortunately I still can't run codefsck_apfs/code without it crashing. 