Automating pfctl to block incoming connections and IPs <body> I get a lot of unwanted traffic from Chinese IP addresses. I'm using an old Mac with OS X 10.7.5 (my Mac is ancient, so I cannot update further), so I imagine it's more vulnerable than a newer Mac would be.   This page gave an emexcellent/em tutorial about how to use codepfctl/code to detect sshd "attackers" who violate certain rules and add them to a blacklist. In my naive understanding, this applies only to codesshd/code connections.   strongHow can I generalize that tutorial to block other kinds of traffic as well?/strong In particular, I have unwanted traffic involving codesshd/code, codesshd-keygen-wrapper/code, and codescreensharingd/code, though I'd love to block emany/em traffic that has too many simultaneous connections or too many attempts within a certain amount of time.   <answer270359> You can simply replace:  precodetable &lt;attackers&gt; persist block log quick from &lt;attackers&gt; pass in quick proto tcp from any port ssh flags S/SA keep state (max-src-conn 3, max-src-conn-rate 5/60, overload &lt;attackers&gt; flush global) /code/pre  with:  precodetable &lt;attackers&gt; persist block log quick from &lt;attackers&gt; pass in quick proto tcp from any flags S/SA keep state (max-src-conn 3, max-src-conn-rate 5/60,  overload &lt;attackers&gt; flush global) /code/pre  If you want to restrict this to single ports use: code... port {22, 443, 5900:5902} .../code instead of code... port ssh .../code.  <comment355795> Is this essentially what Little Snitch does? <comment355796> @jvriesem No, LS does the opposite: it blocks **outgoing** requests based on apps (and decided by the user).  pfctl blocks **incoming** requests (in the above example). <comment355797> Is there a general way to do this for incoming and outgoing...or is that a separate question? (thanks again!) <comment355798> @jvriesem This is a separate question, yes. It can be done with pfctl but it's a **real** hassle compared to Little Snitch. <comment355801> @jvriesem At the moment you can get LS for ~$10, but it's a bit complicated and some basic knowledge of the German language is required. You have to buy a german PDF for 8,95 € which entitles you to register LS and some other macOS apps for free with your email address. <comment355802> @jvriesem [How to Use Terminal for “Little Snitch” Functionality without Little Snitch](https://apple.stackexchange.com/a/230526/93229). My answer there is a simple example with http/https traffic and some domains only. If you want to block outgoing traffic for more apps (=ports) profound knowledge of the ports used and the external sites targeted is required and the org.user.block.out gets **really** large and confusingly complex (unübersichtlich is a better German word with no direct English translation).