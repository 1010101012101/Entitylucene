iPhone sending a lot of packets addressed to weird destinations, draining battery quickly <body> I have a jailbroken iPhone. Recently, I have realized that its battery usage is abysmal. Suspecting that it has something to do with the radio, I downloaded Data Counter from Cydia to check real-time data usage and found that even with push notifications off and exchange set to manual, there is a persistent 0.06kb/s of data transfer. So I hooked the iPhone to a WiFi network and captured packets originating from its IP address using Wireshark under promiscuous mode.  I get A LOT of these:  precodeNo.: 1907   Time: 252.345269   Source: 192.168.2.3   Destination: 10.236.199.xx   Protocol: TCP   Info: 49833 &gt; ssh [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=2 TSV=994197017 TSER=0 SACK_PERM=1 /code/pre  Where 10.236.199.xx is the destination IP and xx goes from 0 to 249, then goes back to 0.  If it helps, my cellular data IP address is 10.236.199.213 and my cellular provider is SingTel (Singapore).  I believe when I am on 3G, these packets are keeping the radio transmitter from powering down and thus draining the battery severely.  Which app is causing all these packets and how can I stop it from going on?  <answer5701> You jailbroke (is that a word? jailbreaked?) it, thereby opening the door to any application doing anything with your hardware. And now it appears that some application is doing something with your hardware. Your phone is compromised and is now trying to compromise other devices on its netblock. You're carrying a virus infection vector in your pocket.   I recommend a full restore absolutely ASAP, and I recommend really thinking about whether jailbreaking is for you.  I'm not anti-jailbreak. I just think people aren't aware of the full repercussions when they do it. Apple's not just being arbitrary in only allowing vetted software onto the devices. It's not JUST a business move on their part. It also protects users from exactly what has happened to you.  <comment5845> It would appear the rooted phone has been rerooted and something is trying to establish a connection to any other phone on the 255.255.255.0 subnet that willl listen to it, so it can root those phones too. This is in theory, but that's the behavior. It's looking to establish an outbound connection. Without a full wipe and careful rescan it's going to be hard to determine _what_ is causing this, unless _every_ **single** app can be enumerated that has been installed. Then peer review can help narrow it down. <comment5863> If it's practical, I'd be tempted to set up an [ssh honeypot](http://code.google.com/p/kippo/) and see what its attack looks like -- this might be more informative than trying to find/remove the running code on the iPhone itself. <comment5891> How can I get the computer to bind to an IP address within the 10.236.199.xx range? (my NAT router uses 192.168.2.xx). <comment5908> +1 totally agree with this. I don't mind jailbreaking (although I don't), but this is one of the reasons why they don't want you too. Though, hopefully (unless its trying to expose a flaw in iOS itself) it is only restricted to other jailbroken devices. <comment5909> Actually I've restored and re-jailbroke my phone about 3 times this year because of battery problems. Every time I start afresh it's okay for a while but after a few weeks something goes wrong, though this is the only time I've actually tried sniffing data. If you're wondering "Hasn't this idiot learnt anything after 3 attempts to restore his iPhone?" I can only say that I've gotten too used to all of the functionality only available after jailbreaking (PdaNet, Intelliscreen, biteSMS), and the fact that I can only copy the restricted mp3s out of AMPed when the phone is jailbroken! <comment5915> @Gordon ~ Doesn't that require _two_ phones on that subnet? ~ @Louie You can't. It's on the mobile network. Best you could do is try and find an engineer for the company who's high enough to be able to do that and low enough that his first response will be "cool let's fight those bastards" and not "eff you, reformat the phone" or even worse, asking you to let him see it, then him reformatting it by force before you realize it. In other words, you can't. <comment5916> Then why don't you just buy a fracking android? Seriously. <comment5918> THAT'S WHAT I INTEND TO DO AS SOON AS MY CONTRACT IS UP FOR RENEWAL, WHICH IS IN ANOTHER YEAR!! <comment5959> I think it should be possible to fake a computer being in the 10.236.199.x range, if you have/can install the `route` command on the iPhone (maybe available from [telesphoreo.org](http://www.telesphoreo.org/browser/trunk/data/network-cmds), though I don't know how up-to-date that is).  On the Mac, run `sudo ifconfig lo0 alias 10.236.199.100 netmask 255.255.255.255` then `sudo route add -host 10.236.199.213 192.168.2.3`.  On the iPhone, run `sudo route add -host 10.236.199.100 192.168.2.theMac'sIP`. <comment5963> @Louie:  Restore.  Re-jailbreak if you must.  Then load the apps you really want, and monitor battery life.  If good, load some more and monitor battery life.  Keep doing that until you have a good idea which of a set of apps are abusing your phone.  Then restore and re-jailbreak again, this time with some idea as to what apps to avoid.  If you keep doing the same thing, you will likely keep getting the same results. <comment6631> What apps do you have running?  [Sorry, I meant to post this as a comment, but I clicked answer and it appears that there's no turning back.] <comment6632> Processes: Mail, Phone, Messages. But since it's jailbroken I bet there are a lot more daemons running in the background... <comment6633> You're not going to simply be able to go on what is running. This is most likely going to be a self-concealing application (I would if I were going to write malicious iPhone software)