Create a zip file using an Automator Service <body> I am trying to create a service in Automator in Mac OS X Mountain Lion. The command that I want to use is as follows:  precodezip zip-file.zip "$@" /code/pre  And here is a screen capture of what I did:  img src="https://i.stack.imgur.com/kX37K.png" alt="enter image description here"  It works. But two problems:  ol licodezip-file.zip/code is placed in my home directory code~\/code. I want to place the zip file in where the original files are./li licodezip-file.zip/code contains the folder structure of the specified files beginning from the root. I want to only include files, or just from the closest parent directory./li /ol  What should I do?  <answer63447> Why not just use the Create Archive action rather than shell scripting?  I created a quick one that has four steps.  ol liselects a folder (Ask for Finder Items - Folders only)/li liselects the files (Get Folder Contents) /li lifilters the items to not selects any subfolders (Filter Finder Items)/li lipass the files to the Create Archive action/li /ol  img src="https://i.stack.imgur.com/EM957.png" alt="enter image description here"  <answer63452> I don't use Automator, but I have a solution that I use to zip files. Put in your desired filename and password in the beginning of the script and export as an application. Drag and drop your files into the droplet icon and voil√† a zip archive is created in the same folder as the original files.  precodeon open theItems      set passwd to "yourPassword"     set archiveName to "yourArchive"      tell application "Finder"             if theItems's length &gt; 1 then                     set fileName to archiveName &amp; ".zip"             else                     set fileName to name of item 1 of theItems &amp; ".zip"             end if             --remove existing archive file with same filename             try                     set archiveFile to ((container of (item 1 of theItems) as Unicode text) &amp; fileName)                     if exists file archiveFile then                             delete file archiveFile                     end if             end try     end tell      repeat with thisItem in theItems             set itemPath to quoted form of (POSIX path of thisItem)             tell application "Finder"                     set parentFolder to POSIX path of (container of thisItem as alias)             end tell             set zipFile to quoted form of (parentFolder &amp; fileName)             set cmd to "zip -P " &amp; passwd &amp; " -rj " &amp; zipFile &amp; " " &amp; itemPath &amp; " -x *.DS_Store"             do shell script cmd     end repeat  end open /code/pre  <answer63498> I was able to modify the shell script to obtain the desired results, with help from https://stackoverflow.com/questions/12340846/bash-shell-script-to-find-the-closest-parent-directory-of-several-files/12341334#12341334  img src="https://i.stack.imgur.com/XrPVX.png" alt="enter image description here"  precodedeclare -a names declare -a parts declare i=0  names=("$@") name="$1" while x=$(dirname "$name"); [ "$x" != "/" ] do     parts[$i]="$x"     i=$(($i + 1))     name="$x" done  for prefix in "${parts[@]}" / do for name in "${names[@]}"     do         if [ "${name#$prefix/}" = "${name}" ]             then continue 2         fi     done     dir="$prefix"     break done  cd "$dir"  for file in "${names[@]}" do     zip zip-file.zip -r "${file#$dir/}" -x *.DS_Store done /code/pre  <comment73331> Isn't `Create Archive` same as `Compress` from right-click? I don't want to use Apple's Compress. I want to use `zip` for more standard zipping. <comment73332> Nope, two different sizes, but that may just be the differences on having not having hidden files.  also see use of ditto instead of Zip.  http://stackoverflow.com/questions/107903/how-to-create-a-zip-file-in-the-same-format-as-the-finders-compress-menu-item <comment73363> Why do you even have to use Automator? You could just cd and specify relative paths in a shell script. <comment73371> @Lri Why would you click more and type more, when there would be a way to do the same job by a couple of clicks? :)