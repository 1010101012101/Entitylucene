Can't access apple.com webservers, App Store, nor Software Update <body> I have a MacBook Pro Early 2011 running Lion 10.7.4 (11E53)  I have installed an SSD instead of the optical drive, and encrypted both hard drives with FileVault2.  For some time now I noticed I can't access the apple.com servers, not even in Safari/Chrome/Firefox.  If I try to codeping www.apple.com/code it doesn't find the host, but when I do a codedig apple.com/code I get the informations.  It's very very strange, any ideas?  In the meantime I booted to recovery with cmd-R and reinstalled Lion but to no avail. Strangely though, in recovery there are no problems accessing the apple servers, because the Lion image was downloaded on the fly..  Later edit, results from codedig apple.com any/code and codeping www.apple.com/code  precode➜  ~  dig apple.com any               ;; Truncated, retrying in TCP mode.  ; &lt;&lt;&gt;&gt; DiG 9.7.3-P3 &lt;&lt;&gt;&gt; apple.com any ;; global options: +cmd ;; Got answer: ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 53874 ;; flags: qr rd ra; QUERY: 1, ANSWER: 24, AUTHORITY: 6, ADDITIONAL: 6  ;; QUESTION SECTION: ;apple.com.         IN  ANY  ;; ANSWER SECTION: apple.com.      3542    IN  TXT "v=spf1 ip4:17.0.0.0/8 ~all" apple.com.      86342   IN  SOA gridmaster-ib.apple.com. hostmaster.apple.com. 2010076647 1800 900 2016000 86500 apple.com.      86342   IN  NAPTR   50 50 "se" "SIPS+D2T" "" _sips._tcp.apple.com. apple.com.      86342   IN  NAPTR   90 50 "se" "SIP+D2T" "" _sip._tcp.apple.com. apple.com.      86342   IN  NAPTR   100 50 "se" "SIP+D2U" "" _sip._udp.apple.com. apple.com.      3542    IN  MX  10 mail-in11.apple.com. apple.com.      3542    IN  MX  10 mail-in12.apple.com. apple.com.      3542    IN  MX  10 mail-in13.apple.com. apple.com.      3542    IN  MX  10 mail-in14.apple.com. apple.com.      3542    IN  MX  10 mail-in15.apple.com. apple.com.      3542    IN  MX  20 mail-in21.apple.com. apple.com.      3542    IN  MX  20 mail-in22.apple.com. apple.com.      3542    IN  MX  20 mail-in23.apple.com. apple.com.      3542    IN  MX  20 mail-in24.apple.com. apple.com.      3542    IN  MX  20 mail-in25.apple.com. apple.com.      3542    IN  MX  100 mail-in3.apple.com. apple.com.      1731    IN  A   17.149.160.49 apple.com.      1731    IN  A   17.172.224.47 apple.com.      86342   IN  NS  nserver.asia.apple.com. apple.com.      86342   IN  NS  nserver.euro.apple.com. apple.com.      86342   IN  NS  nserver.apple.com. apple.com.      86342   IN  NS  nserver3.apple.com. apple.com.      86342   IN  NS  nserver2.apple.com. apple.com.      86342   IN  NS  nserver4.apple.com.  ;; AUTHORITY SECTION: apple.com.      86342   IN  NS  nserver3.apple.com. apple.com.      86342   IN  NS  nserver.apple.com. apple.com.      86342   IN  NS  nserver2.apple.com. apple.com.      86342   IN  NS  nserver.asia.apple.com. apple.com.      86342   IN  NS  nserver.euro.apple.com. apple.com.      86342   IN  NS  nserver4.apple.com.  ;; ADDITIONAL SECTION: nserver.asia.apple.com. 85475   IN  A   17.82.254.3 nserver.euro.apple.com. 85475   IN  A   17.72.133.64 nserver.apple.com.  85475   IN  A   17.254.0.50 nserver2.apple.com. 85475   IN  A   17.254.0.59 nserver3.apple.com. 85475   IN  A   17.112.144.50 nserver4.apple.com. 85475   IN  A   17.112.144.59  ;; Query time: 5 msec ;; SERVER: 213.154.124.221#53(213.154.124.221) ;; WHEN: Tue Jun 19 08:08:40 2012 ;; MSG SIZE  rcvd: 918 /code/pre  And the ping:  precode➜  ~  ping -c 1 www.apple.com ping: cannot resolve www.apple.com: Unknown host  ➜  ~  ping -c 1 apple.com ping: cannot resolve apple.com: Unknown host /code/pre  <answer54364> I had a similar experience a while ago with getting updates on devices. It was specifically downloading updates for my iOS devices on my 2011 iMac running Lion.  At the time, I was also struggling to get to any Apple sites but could browse other sites very well and also download files.  After loads of searching, I found a forum post (unfortunately I can't find it again at the moment) that said it could be a DNS issue. I was using my local ISPs DNS and I changed it to googles DNS (8.8.8.8) and since immediately I could access all the apple sites.  <answer54365> There are two things I would try in this situation:  ol liFlush the DNS cache. This can be accomplished by running the command codedscacheutil -flushcache/code. After running this command, attempt to run the dig and ping commands again. If they return the expected results, you should be good to go. /li liVerify valid and responding DNS servers are responding to DNS queries. Open System Preferences - Network. Unlock the lock icon in the lower left corner if it is locked. Select the network interface you are currently using from the left column and click the Advanced button. Click the DNS tab.  Typically in the DNS tab, you will want to go with what ever is recommended by your ISP. If everything appears OK, consider swapping out the server addresses with one or more of the addresses from the list below:  Google DNS  8.8.8.8  8.8.4.4  OpenDNS (Not recommended if the device hosts an email Server)  208.67.222.222  208.67.220.220/li /ol  hr  Edit to add the following:  Another possible solution: Have you power cycled the networking equipment between your computer and your network connection? I have encountered inconsistent DNS lookups couple times with my Airport. Power cycling has resolved the troubles in at least one of those situations.  <answer54440> Mea culpa: I misread your question and thought you wrote that you emhad/em already tried connecting to www.apple.com emwhile booted/em to the Recovery Partition (you can launch Safari from the Recovery Partition). I reread your question and it sounds like you used the Recovery partition simply to reinstall your OS.  If you have not tried this then you definitely should! If you emcan/em reach www.apple.com from the Recovery Partition then you have a System issue - if you can emnot/em then you have an ISP, or a router issue.  <answer54511> You generally cannot ping large servers so I would be focusing on traceroute instead of ping since your DNS appears to be resolving the Apple servers correctly. Or you could simply telnet to the http/https ports to see that a connection is made.  precodetelnet www.apple.com 80 /code/pre  Since Apple is deploying more and more update files on a Content Delivery Network (CDN), the server I get will rarely be the same server you get for a download since the CDN spreads files out geographically or based on network connectivity. Not only is internet routing fickle and changeable from moment to moment, these CDN change hosts from day to day and even sometimes moment to moment.  Currently, Akamai is serving many Apple web sites and content. The updates (app store and traditional Lion and earlier SU server) but these two IP addresses from Apple seem to be related to the critical startup process of Software Updates and the App Store Update process on Lion before it shifts to the CDN.  ul li17.146.232.12 - server in San Jose, CA that answers as part of Software Updates/li li17.172.192.35 - server in Maiden, NC that answers as part of App Store Updates/li /ul  You could codetraceroute/code to those addresses to make sure your network has connectivity to them. Instead of codeping/code since neither of these answer that traffic, you could insted use telnet to attempt a connection over the https port which they use for update traffic.  precodetelnet 17.172.192.35 443 /code/pre  Good luck picking apart the issue that is preventing your updates. It's probably not DNS from the looks of things, but stranger things have happened than to rule that out with the data at hand.  If the ping errors at the end of your question persist, you can use nslookup to try alternate DNS to see if it's really your DNS reporting bad addresses.  precodemac:~ me$ nslookup &gt; server 8.8.8.8 Default server: 8.8.8.8 Address: 8.8.8.8#53 &gt; apple.com Server:     8.8.8.8 Address:    8.8.8.8#53  Non-authoritative answer: Name:   apple.com Address: 17.172.224.47 Name:   apple.com Address: 17.149.160.49 &gt; www.apple.com Server:     8.8.8.8 Address:    8.8.8.8#53  Non-authoritative answer: www.apple.com   canonical name = www.isg-apple.com.akadns.net. www.isg-apple.com.akadns.net    canonical name = www.apple.com.edgekey.net. www.apple.com.edgekey.net   canonical name = e3191.c.akamaiedge.net. Name:   e3191.c.akamaiedge.net Address: 23.60.173.15 &gt; server 208.67.222.222 Default server: 208.67.222.222 Address: 208.67.222.222#53 &gt; www.apple.com Server:     208.67.222.222 Address:    208.67.222.222#53  Non-authoritative answer: www.apple.com   canonical name = www.isg-apple.com.akadns.net. www.isg-apple.com.akadns.net    canonical name = www.apple.com.edgekey.net. www.apple.com.edgekey.net   canonical name = e3191.c.akamaiedge.net. Name:   e3191.c.akamaiedge.net Address: 23.1.141.15 /code/pre  <answer54514> Have you tried clearing the network prefs?   Go to code/Library/Preferences//code, delete/rename the codeSystemConfiguration/code folder and restart.  <answer54751> Which DNS servers are you using?   precode$ networksetup -getdnsservers Wi-Fi /code/pre  or  precode$ networksetup -getdnsservers Ethernet /code/pre  For example is the first resolver a Mac OS X Lion server running DNS service?  In that case, have you tried disabling "Configure IPv6" on the machine where the DNS service is installed? See the Network pane  [ Advanced ], or at least to change it from [Automatically] to [Local-link only].  Can you please include the output of a code$ dig www.apple.com +trace/code command, preferably also when ran on the first DNS resolver?  <answer54913> Given that you've already checked your DNS and code/etc/hosts/code strikeand flushed the DNS cache using codedscacheutil -flushcache/code/strike it is quite possible you have malware on your machine.  You have re-installed Lion which should take care of any file corruption issues, but may not remove malware if you recovered your user files from a backup.  Double-check your network settings to ensure you are not using any proxies, but other than that, malware seems the most likely culprit.   EDIT: It seems codedscacheutil -flushcache/code no longer works to flush the DNS cache.  Before we flush the cache the new way, let's take a look at it.  Run:  precodesudo killall -INFO mDNSResponder /code/pre  and then look at the system.log file. You can view it in the Console app under Files or you can view it in the terminal with codeless /var/log/system.log/code.  Either way, mDNSResponder dumps a lot of information into the system.log as a result of that command, which should help pinpoint the problem.  Search for "apple.com" in the results and see what you come up with.  Then try   precodesudo killall -HUP mDNSResponder /code/pre  to actually flush the cache and try codeping www.apple.com/code again.  hr  You have tried codedig www.apple.com/code which correctly resolved to e3191.c.akamaiedge.net which is a CDN domain that will have different IP addresses depending on where you connect to the internet. Try codenslookup www.apple.com/code and you should get the same thing, e.g.  precodeuser$ nslookup www.apple.com Server:     8.8.8.8 Address:    8.8.8.8#53  Non-authoritative answer: www.apple.com   canonical name = www.isg-apple.com.akadns.net. www.isg-apple.com.akadns.net    canonical name = www.apple.com.edgekey.net. www.apple.com.edgekey.net   canonical name = e3191.c.akamaiedge.net. Name:   e3191.c.akamaiedge.net Address: 23.11.77.15 /code/pre  So you should be able to ping www.apple.com, e3191.c.akamaiedge.net, and 23.11.77.15 (or whatever IP address you get from codedig/code).  (While it is true that many servers do not respond to ping requests, this server does respond and your problem isn't that you cannot get a response anyway, it's that you cannot resolve the domain name.)  If you can ping some but not all, then you probably have a malware problem.    There were a bunch of trojans circulating as video codecs that messed with DNS.  I suggest getting a reputable malware scanner and checking your system.    <comment61932> apple.com and www.apple.com are different things. What does `dig` report for www.apple.com? <comment61935> `dig www.apple.com` returns: `;; ANSWER SECTION:  www.apple.com.  1365 IN CNAME www.isg-apple.com.akadns.net.  www.isg-apple.com.akadns.net. 14 IN CNAME www.apple.com.edgekey.net.  www.apple.com.edgekey.net. 12160 IN CNAME e3191.c.akamaiedge.net.  e3191.c.akamaiedge.net. 4 IN A 23.11.77.15` <comment62233> I'm already using google's public dns, I tried several others in fact.. <comment62234> Tried 1, with dscacheutil and by killing some processes also and still nothing. As I was saying above, I also tried 2. No success <comment62281> I added another possible solution to my answer above. <comment62287> Changing the DNS server may lead to flushing of the local DNS cache - change the servers to the ones provided by your ISP to see whether it makes a difference <comment62293> It has nothing to do with the router, my phone and tablet work just fine with apple servers. <comment62294> It sounds counter intuitive and may not solve your problem, but I would try power cycling the router anyway. I have encountered at least one similar situation where other devices on the network were working as expected while one was giving quirky results when running various DNS lookups. <comment62296> I did power cycled it two days ago... it's not the case. Actually I think I'll erase the partition and clean install Lion from scratch. <comment62316> This occurs even while booted from the recovery partition. Might be related to the recent world IPv6 launch? Just a stab in the dark. Other than that, you should check from an alternate site as your router or ISP is likely at fault <comment62317> Did you check your hosts file? Launch Terminal, type in `sudo nano /etc/hosts/` and check if there are any irregular entries concerning `apple.com`. Could it be that an outgoing firewall - like Little Snitch - is blocking the connection by an accidental added rule? <comment62470> @BartArondson +1, but that should be `/etc/hosts` not `/etc/hosts/`. <comment62490> He says it also happens when booted to the Recovery partition therefore it won't be related to the hosts file. <comment62716> @username: actually, on the contrary. I said that I had NO problems in recovery reaching apple servers ;) Otherwise.. I couldn't have reinstalled the system in the first place since Lion has to be downloaded first from apple. <comment62717> no difference.. so I guess it's some kind of virus/malware <comment62765> I thought of that too, and disabled IPv6 on the router and also on the Mac.. no results <comment62766> yes, tried it, didn't help.. <comment62767> I **can** access apple servers from Recovery. I specifically **mentioned it in the question's post** <comment62769> No problem in the hosts file, it was the first thing I looked into (being used with Windows's malware habits) <comment62780> But which networks (Ethernet, WiFi, etc.) are connected to your troubling machine, and which DNS-servers are configured for each of them? And/or update your question with the output of `$ nslookup www.apple.com`. <comment62784> Did you ever install an application firewall like "Hands Off!"? <comment62798> oops, sorry! then i would start with "traceroute www.apple.com" <comment62800> this is sane, and deserves more than the one upvote i can give it <comment62955> This does not address the OP's problem as `ping` is failing to _resolve_ the host name, not connect to the host.  And in this case, the host _does_ respond to pings. <comment62969> I did assume that the DNS error was transient and tried to explain some generalities. I have seen the same Akamai servers respond to pings some of the time in what I presume to be load shedding or other changes. The primary thrust of my answer is that things change so focus on routing. As I mentioned two very stable IP the OP can skip DNS entirely to isolate that as the true cause of the issue. <comment62977> Routing is not implicated in the OP's problem.  The error is not "no route to host" or "Request timeout", which would be (possibly) routing problems, the error is "cannot resolve www.apple.com: Unknown host" which means `ping` cannot convert "www.apple.com" to an IP address.  I would predict `telnet` and `traceroute` to fail with the exact same error on the OP's computer. <comment63003> What happens when you ping the IP instead of the domain? e.g. 17.172.224.47