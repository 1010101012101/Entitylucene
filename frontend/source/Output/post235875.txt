pfctl config to only allow OpenVPN connection <body> I found what appears to be a suitable guide here, but pfctl complains of a syntax error and "no IP address found for en3" which is my main interface. I have had other pf rules working successfully to forward ports, etc. but I cannot figure this out.   I am on 10.11.4 and using Tunnelblick connected to a OpenVPN server i installed myself on a VPS.   Could someone give instructions on the correct configuration for pfctl on El Capitan? I need to keep open access to private networks like 10.0.0.0 and 168.1.0.0  Thanks!  <answer259219> The following works on Sierra.  Append the following lines to the end of /etc/pf.conf  precodeanchor "org.vpnonly.pf" load anchor "org.vpnonly.pf" from "/etc/pf.anchors/org.vpnonly.pf.rules" /code/pre  Create this configuration file at /etc/pf.anchors/org.vpnonly.pf.rules  precode# Options set block-policy drop set fingerprints "/etc/pf.os" set ruleset-optimization basic set skip on lo0  # Interfaces vpn_intf = "{ utun0 utun1 utun2 utun3 }"  # Ports allowed_vpn_ports = "{ 1:65535 }"  # Table with allowed IPs table &lt;allowed_vpn_ips&gt; persist file "/etc/pf.anchors/vpn.list" file "/etc/pf.anchors/custom.list"  # Block all outgoing packets block out all  # Antispoof protection #had to disable this to avoid error #antispoof for $vpn_intf inet  # Allow outgoing packets to specified IPs only pass out proto icmp from any to &lt;allowed_vpn_ips&gt; pass out proto {tcp udp} from any to &lt;allowed_vpn_ips&gt; port $allowed_vpn_ports  # Allow traffic for VPN interfaces pass out on $vpn_intf all /code/pre  Create /etc/pf.anchors/vpn.list and /etc/pf.anchors/custom.list  codesudo touch /etc/pf.anchors/vpn.list /etc/pf.anchors/custom.list/code  Add a list of allowed IP addresses (addresses of VPN servers) to /etc/pf.anchors/vpn.list  precode41.xxx.xxx.xxx 42.xxx.xxx.xxx /code/pre  Add google DNS to custom /etc/pf.anchors/custom.list     8.8.8.8     8.8.4.4  codesudo pfctl -e -f /etc/pf.conf/code and check for errors  To load at startup, edit to default pfctl at code/System/Library/LaunchDaemons/com.apple.pfctl.plist/code to set code&lt;key&gt;Disabled&lt;/key&gt;/code code&lt;true/&gt;/code  ensure rootless mode is disabled. (boot to recovery terminal with kbdCommand+R/kbd at the chime and run codecsrutil disable/code run these commands, then return to recovery terminal afterwards to reenable rootless with codecsrutil enable/code  Create your LaunchDaemon at code/Library/LaunchDaemons/com.apple.pfctl.plist/code  precode&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt; &lt;plist version="1.0"&gt; &lt;dict&gt; &lt;key&gt;Label&lt;/key&gt; &lt;string&gt;com.apple.pfctl&lt;/string&gt; &lt;key&gt;ProgramArguments&lt;/key&gt;     &lt;array&gt;         &lt;string&gt;pfctl&lt;/string&gt;         &lt;string&gt;-e&lt;/string&gt;         &lt;string&gt;-f&lt;/string&gt;         &lt;string&gt;/etc/pf.conf&lt;/string&gt;     &lt;/array&gt;     &lt;key&gt;RunAtLoad&lt;/key&gt;     &lt;true/&gt; &lt;/dict&gt; &lt;/plist&gt; /code/pre  finish with codesudo chmod 644 /Library/LaunchDaemons/com.apple.pfctl.plist/code, reboot with rootless mode enabled and you're set.  <comment324252> I always wanted to answer this question - I have an open tab with this question for 2 months now - but failed to setup a properly working OpenVPN server at AWS. Good to see that it is answered now.