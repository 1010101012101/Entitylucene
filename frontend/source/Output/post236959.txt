Add command to sudo in OS X - or how to fix a major security inconsistency in OS X <body> OS X provides Keychain Access, which is a great way to save passwords of varying apps and websites. When you want to view a password via the Keychain Access GUI, you are asked the admin password. However, OS X also provides a command to export all Keychain Access passwords to a text file, unencrypted:  precodesecurity dump-keychain -d login.keychain &gt; keychain.txt /code/pre  This command does not require codesudo/code privileges.  So I have two questions:  ul liHow can I add the codesudo/code privilege requirement to the codesecurity/code command./li liIs this behaviour intended or is it a major inconsistency with regards to security concerns at Apple ?/li /ul  <answer236977> The codesecurity/code command is working as expected, and is following the same keychain access policies that any other program would follow.  ul liAccessing a user's keychain is emnot/em an admin function -- the user's keychain belongs to them, so admin access is irrelevant. On the other hand, the System keychain (/Library/Keychains//System.keychain) is "owned by" the system, so admin access emmight/em be needed for it and/or its items./li liTo gain access to the user's keychain, it must first be unlocked. login.keychain is normally encrypted with the user's login password, and is automatically unlocked when they log in. If it weren't already unlocked, codesecurity/code would trigger a prompt for the password to unlock it./li liEach item in the keychain has its own access policy. You can see these in the Keychain Access utility by double-clicking the keychain item, then selecting the Access Control tab. codesecurity/code obeys these access controls: if it's set to "Allow all applications to access this item", codesecurity/code will dump the item without prompting for anything; if it's set to "Confirm before allowing access" (and codesecurity/code isn't in the "Always allow..." list), codesecurity/code will trigger a prompt for access to the item (and if "Ask for keychain password" is selected as well, the prompt will require the keychain password)./li /ul  It might be possible to require admin rights to run codesecurity/code, but I wouldn't recommend it. Firstly, it might break any parts of the OS that depend on running codesecurity/code (though I don't know of any), and secondly it wouldn't prevent any other program from dumping out the keychain, since other programs are subject to the same access policies. 