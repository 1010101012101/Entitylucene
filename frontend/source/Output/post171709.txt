AppleScript get active Application <body> How might I run code(for example codedisplay dialog("test")/code) using AppleScript only if the "Finder" Application is currently in focus/active.  <answer171738> This will work if the script is called from Script Editor, as it 'gets out of the way' to check the next app in line, but will fail if double clicked from Finder, as Finder will then always be last in line.  precodetell application "System Events"     set frontmostProcess to first process where it is frontmost     set visible of frontmostProcess to false     repeat while (frontmostProcess is frontmost)         delay 0.2     end repeat     set secondFrontmost to name of first process where it is frontmost     set frontmost of frontmostProcess to true end tell  tell application (path to frontmost application as text)     if "Finder" is in secondFrontmost then         display dialog ("Finder was last in front")     else         display dialog (secondFrontmost &amp; " was last in front")     end if end tell /code/pre  hr  emsubLeaving previous answer here for posterity/sub/em  Rejigged entire answer after having not read the question properly initially ;-)  precodetell application "System Events"     set activeApp to name of first application process whose frontmost is true     if "Finder" is in activeApp then         display dialog ("test")     else         display dialog ("test2")     end if end tell /code/pre  <comment202095> +1 Although your proposed solution doesn't seem to work as is.  I get "test" as long as the application is open and not necessarily if it is active or not. <comment202119> Um, if the application is already active, what do you aim to accomplish by activating it again? <comment202312> a rethink… edited answer <comment202413> complete rewrite, now I'm back at my desktop - this now does exactly what you asked. <comment202423> Hmm..  If I add the applescript as an app to to the dock it only displays "test2" no matter what application I have originally focused. <comment202427> probably because the Applescript app is frontmost. Test by adding a 3s delay, then clicking the desktop between launch & trigger [that's how I tested it here] <comment202521> http://stackoverflow.com/questions/3718520/how-do-i-write-applescript-that-will-give-me-an-hourly-popup-alert idle is relevant although doesn't solve the problem. <comment202531> you can also replace the second dialog command with `display dialog (activeApp)` to confirm exactly what the script thinks is the frontmost. <comment202633> You need to clarify your question. The script in my answer works, for a given definition of 'works' i.e. it reports accurately whether or not Finder is frontmost. <comment202650> @Tetsujin updated <comment202661> How are you going to be launching the Applescript app? Double clicking it will, of course, always show the Finder as the '2nd to last' frontmost. Changing answer - this will work if called from Script Editor, but 'fails' if double-clicked in Finder, as it gives a false-positive <comment202664> @Tetsujin That's the issue I'm running in to. <comment202670> Can I ask *why* you need to periodically check if the Finder is/was frontmost? It would seem to be a whole lot easier to just fire an Applescript to bring it to the front & quit… or just click on it. <comment202682> @Tetsujin I would like an icon on the dock that does a "PageDown" when clicked on.  `key code (insert code here)` works but you can't know ahead of time what application is focused. <comment202684> @Tetsujin You have put forth enough effort.  I'm convinced what I'm after is possible in AppleScript. <comment202698> tell application "whichever" to activate \n tell application "System Events" to key code… end tell etc... & ty for the points on the Answer. <comment202735> @Tetsujin That's the point I don't what application it is.  I would the PageDown icon to work in any application. <comment202776> then all you need is to tell application secondFrontmost… Whichever it is, as my Applescript will have backgrounded <comment203829> @Tetsujin There appears to be no way to get the secondfrontmost application.  Same issue here http://stackoverflow.com/questions/25411174/applescript-open-frontmost-file-with-another-application <comment203846> my answer already finds the second frontmost, by virtue of itself being frontmost, then hiding. There is no programmatic way to interrogate the launch services to extract that information. Best you can do is by launch order. If all you need is a Page Down button press, why not look at the other myriad ways that can be achieved? <comment203850> @Tetsujin question accepted http://apple.stackexchange.com/questions/173298/dock-icon-that-activates-pagedown?noredirect=1#comment203832_173298