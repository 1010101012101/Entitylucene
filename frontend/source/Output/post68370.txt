Error in restoring iOS 5.1.1 on iPhone 4 using custom IPSW <body> I'm trying to restore iOS 5.1.1 on iPhone 4 GSM that currently has iOS 4.3.3 and is jailbroken.  I'm using "redsn0w" to get into pwned DFU mode and then trying to restore from iTunes using custom IPSW file stitched with the 5.1.1 shsh blobs (I have my shsh blobs saved locally).  It works until iTunes reaches the point codePreparing iPhone for restore./code  At this point my iPhone automatically exits the DFU mode and enters into restore mode, but iTunes stops restoring with the error codeiPhone could not be restored. An unknown error occurred (21)./code  I have checked the hosts file and have commented the line that redirects to the cydia server. (I have also checked it by uncommenting that line but it still didn't work)  Any idea what could be going wrong or is there anything I'm missing?  <answer68474> I'm able to restore iOS 5.1.1 on my phone using codesn0wbreeze/code. I'm posting the details here in case someone else encounters the same problem.  Initially I used coderedsn0w/code to create a custom firmware file but it failed to restore (with errors mentioned in the question and others like error 14, etc.).  Then I used codesn0wbreeze/code to create a custom firmware stitched with my shsh blobs and iTunes restored it without errors.  Here are the steps I followed:    ul liDownloaded a firmware that i wanted to restore (5.1.1 in my case)./li liAdded my shsh blobs for that firmware using codeiFaith/code mode in codesn0wbreeze/code./li liCreated the custom IPSW in codesn0wbreeze/code and stored it on my desktop./li liPut the iPhone in pwned DFU mode. Use codeiREB/code or coderedsn0w/code to get into the pwned DFU mode./li liUsed the custom ipsw file to restore in codeiTunes/code./li /ul  I don't know if these things count, but during the process my antivirus was disabled and I had commented out any codegs.apple.com/code lines in my hosts file.  <answer68639> FYI the reason for your issue was that the phone was never in true DFU mode.   So the firmware was still active.  You fixed the issue properly.  Nice job.    <answer74681> I used redsnow Version 0.9.14b3 to created a custom ipsw, with my saved shsh blobs of course and put my iDevice in pwned dfu mode. I then deleted any gs.apple.com and my host.umbrella file if using tinyumbrella (it mods your host file everytime you exit) then shift+restore and clicked my custom ipsw; it worked like a charm.   strongTip:/strong Don't use the newer versions or redsnow for custom ipsw.  For some reason they make the fie bigger then the raw ipsw.  <answer85375> strongTry Hard Reset Your iPhone to Fix It/strong  To do a Reset, press and hold the Home button and the Sleep/Wake or On/Off button simultaneously until you see the Apple logo and then release - ignoring the slide to turn off prompt when doing so.   Well, by doing so, all your data will be erased.  <comment79943> Thanks. i used same procedure to get in DFU mode that i was using earlier, but this time it worked with ipsw file that i had created using sn0wbreeze. <comment89594> Could you link to the version of software you are using - we've received some flags indicating people can't find the software you mention.