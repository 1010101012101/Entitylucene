System-Preferences Applescript using osascript cannot select its window <body> This AppleScript (based on an answer in a MacWorld form) will tell me whether or not Screen Sharing is enabled:  precodetell application "System Preferences"     reveal pane "com.apple.preferences.sharing" end tell  tell application "System Events"     tell process "System Preferences"         set screen_sharing_toggle to value of (checkbox 1 of row 2 of table 1 of scroll area 1 of group 1 of window 1) as boolean     end tell end tell  tell application "System Preferences"         Quit end tell  set newvar to screen_sharing_toggle /code/pre  So if I run that in the AppleScript editor it returns codetrue/code or codefalse/code depending on the setting of Screen Sharing.  If I try running it on the command line (which is what I really want) I get something like this:     iscriptname/icode: execution error: System Events got an error:   Canâ€™t get window 1 of process "System Preferences". Invalid index.   (-1719)/code   h2Some more information/h2  If I use run a script like this to count System Preferences' windows:  precodetell application "System Preferences"     reveal pane "com.apple.preferences.sharing" end tell  tell application "System Events"     tell process "System Preferences"         count windows     end tell end tell /code/pre  it returns 1 when running under AppleScript editor, but 0 when I run it using osascript.  bEven more information/b: On my laptop I get an even stranger error running the same command:  precodeexecution error: System Events got an error: Access for assistive devices is disabled. (-1719) /code/pre  <answer93686> So there are two ways this script can fail:  ol liCommand line version unable to get the System Preferences window./li liRunning it will cause the complaint about enabling access for assistive devices./li /ol  Well the latter case as it turns out is self-explanatory: This script requires that you have enabled access for assistive devices.  The former is still not obvious, but if you quit System Preferences and restart it then it emmight/em work; it finally did for me, and I have amended the code above to get System Preferences to quit at the end.  <comment109804> Both scripts worked the same way for me. How did you run them with osascript, or does for example `osascript file.scpt` work? <comment109805> @LauriRanta I just put the script in a file (e.g. `file.scpt`) and ran it as you say, but it produced the error I showed you.  The first part of the script works fine, evidenced by the fact that System Preferences is showing the Sharing pane.