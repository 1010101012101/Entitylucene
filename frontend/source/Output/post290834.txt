MacOS Automator: Save new text file in current folder <body> I am trying to write a simple Automator service to merge selected text files. I’ve nearly got it, but I am running into one problem.  I want to create a new text file from the combined output of the selected files. When I add the codeNew Text File/code action, I can only set the codeWhere/code location to a particular folder.  If I want to create a new folder, I have the option of codeSame Folder as Input/code. This does not appear for new text files.  How can I save a new text file to the same folder as the selected files?  <answer290878> Since you did not include your emworkflow/em, what emtype/em of emworkflow/em it is, or which version of OS X/macOS you're using, I can only offer an emexample/em of how you can set a emvariable/em to use for the strongWhere:/strong in a strongNew Text File/strong emaction/em in an strongAutomator/strong emworkflow/em.   I have a strongTemp/strong folder, which I created, in the emroot/em the strongMacintosh HD/strong, and in this folder I created two plain text files, named strongFilename1.txt/strong and strongFilename2.txt/strong, each of which contain a single line of text, "emThe name of this file is Filename1.txt/em" and "emThe name of this file is Filename2.txt/em", respectively.  The following strongAutomator/strong emworkflow/em works with emselected/em strongFinder/strong items in strongFinder's/strong frontmost window, or the strongDesktop/strong as appropriate if no other individual strongFinder/strong windows are frontmost with a emselection/em, and using a strongRun AppleScript/strong emaction/em sets a emvariable/em to the emparent/em folder of the emfirst item selected/em to be used as the strongWhere:/strong in a strongNew Text File/strong emaction/em. and creates a file named strongCombined.txt/strong.  Note in the image below, there is a break in the link between the strongSet Value of Variable/strong emaction/em and what is the second strongGet Selected Finders Item/strong emaction/em.  This disconnect is created by selecting strongIgnore this action's input/strong under strongOptions/strong in the second strongGet Selected Finders Item/strong emaction/em.  The emvariable/em codeinputParentFolder/code was emdragged/em and emdropped/em from the strongVariable/strong section at the bottom of the emworkflow pane/em into the strongWhere:/strong in the strongNew Text File/strong emaction/em.  As you can see in the image below, the emworkflow/em completed successfully combining the content of the two emselected/em files in strongFinder/strong into a new file named strongCombined.txt/strong in the same folder as the emselected/em files.  img src="https://i.stack.imgur.com/xX2Ws.png" alt="enter image description here"  <comment367161> Please add a screenshot of the workflow and which version of OS X/macOS are you using. <comment367228> Thanks for your detailed answer. The key parts for my problem were: (a) the AppleScript to get the parent folder, (b) saving this into a variable, (c) using this variable in the `Where` property (I didn’t know you could do that), and (d) getting the finder items _again_ to do the merge. I do think the process would have been simpler if they simply included the option of __Current Folder__ … <comment367230> @user3439894 It seems that we’re in different time zones — thanks for the answer below. FWIW, it’s MacOS 10.12.5 Sierra. <comment367233> @Manngo, Yes, it would be a whole lot easier if the **New Text File** _action_ had **Same Folder as Input** as a choice in the **Where:** _list_, like it does in the **New Folder** _action_. However, at least there is a workaround to achieve the goal.