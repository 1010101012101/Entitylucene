Killing discoveryd process affected by malware <body> There was a malware attack on my system. It has affected the discoveryd process.   I do a grep to find the process id for related discoveryd processes. I get the following -   precode_mdnsresponder   6115   0.0  0.1  2504332   4448   ??  Ss   11:05AM   0:30.27 /usr/libexec/discoveryd --udsocket standard --loglevel Basic --logclass Everything --logto asl root              145   0.0  0.0  2469280     32   ??  Ss   Mon08PM   0:00.02 /usr/libexec/discoveryd_helper --loglevel Detailed --logclass Everything --logto asl UserName            9627   0.0  0.0  2433796    652 s001  S+    5:40PM   0:00.00 grep discoveryd /code/pre  I try doing pkill -f 6115, pkill -f 145. Nothing happens to it.   Let me know, how to resolve it.   <answer190051> Here's a link to the Apple Beta Software Program site. Sign up for the program and follow the site's instructions to upgrade your computer to OS X 10.10.4, whose latest beta (build 14E26a) got rid of discoveryd in favor of bringing back mDNSResponder.  <answer190086> If you don't want to risk running unstable beta software, you can try transplanting a 10.9 version of mDNSresponder to 10.10 replacing discoveryd. Nothing failed to work after this patch.  <answer193562> There is no evidence of any malware from the output of your codediscoveryd/code normally running daemon.  Your codepkill -f 6115/code command failed because luckilly you don't have a process which full command name would be 6115. This is the sign of too fast reading the codepkill/code documentation and not at all of an attack.  If you really want to kill codediscoveryd/code here is the correct way to do it:  precode_pid_to_kill=`ps ax | egrep '[ /]discoveryd' | awk '{print $1}'` if [ "${_pid_to_kill}" ] ; then     /usr/bin/sudo kill ${_pid_to_kill} fi /code/pre  code_pid_to_kill/code will get the process id of discoveryd if it is actually running. Line 2 will test if this variable is set with something, and line 3 will do the dirty job.  <comment225507> How do you know you were affected by malware? <comment225520> I can't help you if you won't help me, sorry. <comment225550> This is true from OS X 10.10.4 beta 4 which I am currently running. Previous builds still use `discoveryd`. <comment225551> `discoveryd` hogging 100% processor is a known bug. <comment225554> @MaxthonChan Correct. I just figured that didn't need saying, since I have yet to find a way to download anything but the latest beta released. <comment225555> Well someone can have old beta holdover (e.g. one of my hard drives still have OS X Yosemite 10.10.0 beta 7 on it) and clarifying this can be useful. <comment225556> Alright. I'll edit it. <comment225622> You're making massive assumptions though. He isn't willing to tell us what his actual problem is. <comment225641> Yeah, but I'm going based on what he thinks he knows. If his discoveryd is infected, this'll cure him. If whatever symptoms he's seen persist, then he's got bigger problems to deal with. <comment230738> → Maxthon: It isn't the actual case here: look at the `Ss` in the `STAT` column. <comment230748> → William: you are twice right! <comment231088> 10.10.4 has just been released. Update. `discoveryd` has been replaced with the previous `mDNSresponder`