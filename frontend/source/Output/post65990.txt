On resume from sleep, DHCP or ARP on the ethernet is not working <body> My mid-2011 iMac running Lion 10.7.5 has an intermittent problem. When I resume from sleep in the morning the ethernet fails to come up reliably. Sometimes it starts working immediately, sometimes it takes 10-20 seconds, and lately the problem seems to be getting worse and it can take minutes.  I can fix the problem by going to a terminal and disabling and re-enabling the ethernet with codeifconfig en0 down; ifconfig en0 up/code. And after sleep I can connect to the same network via WiFi, just not ethernet.  The network is a simple home network with switched gigabit ethernet. There's one Netgear switch and one router: a Linksys WRT54GL running Tomato firmware. I don't have any useful logs on the router side about what's going wrong. In general the network works fine, including when booting the iMac, it's just this one resume from sleep that's failing.  On the Mac side, the kernel logs don't have much useful information. Just a lot of lines like this:  precodeOct  2 06:02:48 iMac kernel[0]: Ethernet [AppleBCM5701Ethernet]: Link up on en0, 1-Gigabit, Full-duplex, Symmetric flow-control, Debug [796d,0103,0de1,0300,c5e1,0c00] Oct  2 06:02:49 iMac kernel[0]: Ethernet [AppleBCM5701Ethernet]: Link down on en0 Oct  2 06:02:53 iMac kernel[0]: Ethernet [AppleBCM5701Ethernet]: Link up on en0, 1-Gigabit, Full-duplex, Symmetric flow-control, Debug [796d,0103,0de1,0300,c5e1,4c00] Oct  2 06:02:54 iMac kernel[0]: Ethernet [AppleBCM5701Ethernet]: Link down on en0 /code/pre  A packet trace via Wireshark only gives a little more insight. All I see is an endless stream of unanswered ARP and DHCP requests, along with some IPv6 stuff I don't understand. Screenshot below is representative.  img src="https://i.stack.imgur.com/KTJKf.png" alt="Packet dump screenshot"  When I use codeifconfig/code to bring the network down and back up, the main difference I see in the packet trace is my ARP and DHCP requests get an immediate answer.  <comment83477> Looks like this question is going to get no answers. FWIW, my workaround has been to enable Wifi as well; it seems to work right on resume from sleep and once the ethernet wakes up the routes switch over to wired network. <comment94776> I do see the same error on a MacBook Pro running SnowLeopard 10.6.8. The kernel error message is: `Feb 14 19:57:42 sagan kernel[0] AppleBCM5701EThernet:       0       0 enable - failed` But ifconfig asserts the Ethernet interface is up. I'm still hunting this problem which is clearly related with the sleep mode. <comment94786> The version I have is characterized by: Kext name:        AppleBCM5701Ethernet.kext Firmware version: 5764m-v3.38, 0x56cdb6d5 Version:          3.0.5b8 <comment94945> FWIW, I think that may be a different problem. On my system I don't seen that "enable - failed" error. I can't remember if `ifconfig` shows the Ethernet interface up, but if it is up it's not configured with an IP address. <comment95347> Same result of `ifconfig en0 up`: UP but no @IP. <comment162431> FWIW, this problem may have been a bad ethernet port. I haven't seen it since I moved the cable.