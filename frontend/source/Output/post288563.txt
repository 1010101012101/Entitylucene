How to pass path of selected file from Finder to Automator Shell script <body> I am creating Automator Service to unzip selected files in the same folder they are located.   How can I get selected file absolute path in Automator, so I can pass it into my shell script ?  As you can see I am only passing filename for now, but its not unzipping in same folder.  I would like to change folder before codeunzip/code, and then execute codeunzip/code. I tried codecd ~/code but it unzips to my homefolder. I would like to codeunzip/code in same folder as selected files exists.  img src="https://i.stack.imgur.com/yzsgG.png" alt="enter image description here"  <answer288566> Add codecd "$(dirname "$f")"/code before the codeunzip/code line.  precodefor f in "$@"; do     cd "$(dirname "$f")"     unzip -o "$f" done  /code/pre  or without changing to the directory, use the code-d/code option  precode[-d exdir]           An  optional  directory  to which to extract files.  By default, all files and subdirectories           are recreated in the current directory; the -d  option  allows  extraction  in  an  arbitrary           directory.....    for f in "$@"; do     unzip "$f" -d "$(dirname "$f")" done /code/pre  <comment364394> Add `cd "$(dirname "$f")"` before the `unzip` line. <comment364395> that is awesome, put it as answer pls and i mark it. thx a lot <comment364398> I don't see why you need a script - I double-click on a zip file and it gets extracted into the same location with no other dialogue box or anything. <comment364405> @SolarMike ArchiveUtility sometimes wont work for particular archive files and returning errors. Using unzip works as charm.