Messed up 1TB Fusion Drive Partitions (on iMac 5K) <body> Alright, so I did something stupid today, and I really need some help right now…  So kinda like the situation in this post I think I messed up the Fusion Drive on my 1TB iMac (with BootCamp), I messed up my 1TB Fusion Drive while installing Windows 10 in BootCamp. I don’t want Windows no more, just want my Fusion Drive to be back to its original state.   So right now it’s really weird, the SSD part of the drive seems fine but the HDD part is messed up. As you can see here, I got EFI, Core Storage, and Recovery HD, they are all fine, but there are 3 more partitions:   ul li138.62GB Free/li li104.86MB NO NAME in FAT32/li li99.9GB Free/li /ul  But OS X Doesn’t recognize these partitions at all, not even in Disk Utility, and my Macintosh HD is now “downsized" to 875 GB  img src="https://i.imgur.com/iMxDRXg.png" alt="Pic1" img src="https://i.imgur.com/rQRrc9o.png" alt="Pic1" img src="https://i.imgur.com/K9k6rFB.png" alt="Pic1" img src="https://i.imgur.com/r0C6CzJ.png" alt="Pic1"  I don’t want the last three partitions, just want them to be merged to Macintosh HD, so I can use my Mac with just one main hard drive. I tried everything, but still can’t manage to merge them back. I tried using El Captain Disk Utility, but can’t see any of the partition, also tried booting into Yosemite recovery disk and use the old Disk Utility, still can’t merge them back. Please give me some advice!  Below are some more detailed info I recorded:  I’m on OS X 10.11.1, iMac (Retina 5K, 27-inch, Late 2014), 1.12 TB Fusion Drive  strongduskutil cs list/strong  precodeCoreStorage logical volume groups (1 found) | +-- Logical Volume Group D481E62E-A993-40EF-9568-DCF708BC3B64 ========================================================= Name:         Macintosh HD Status:       Online Size:         881703424000 B (881.7 GB) Free Space:   28672 B (28.7 KB) | +-&lt; Physical Volume 7D7CA850-3B9D-445B-8AC9-81ABB67A8186 |   ---------------------------------------------------- |   Index:    0 |   Disk:     disk0s2 |   Status:   Online |   Size:     120988852224 B (121.0 GB) | +-&lt; Physical Volume D51952ED-5354-4B9B-A15B-5D9C8E82E7F2 |   ---------------------------------------------------- |   Index:    1 |   Disk:     disk1s2 |   Status:   Online |   Size:     760714571776 B (760.7 GB) | +-&gt; Logical Volume Family 2A62CE1E-E0BD-44C8-A1BA-7F6BCA787A87     ----------------------------------------------------------     Encryption Type:         None     |     +-&gt; Logical Volume 5E88EF38-D2A8-4A7D-8508-5C24D948877D         ---------------------------------------------------         Disk:                  disk2         Status:                Online         Size (Total):          875848138752 B (875.8 GB)         Revertible:            No         LV Name:               Macintosh HD         Volume Name:           Macintosh HD         Content Hint:          Apple_HFS         LVG Type:              Fusion, Sparse /code/pre  strongdiskutil list/strong  precode/dev/disk0 (internal, physical):    #:                       TYPE NAME                    SIZE       IDENTIFIER    0:      GUID_partition_scheme                        *121.3 GB   disk0    1:                        EFI EFI                     209.7 MB   disk0s1    2:          Apple_CoreStorage Macintosh HD            121.0 GB   disk0s2    3:                 Apple_Boot Boot OS X               134.2 MB   disk0s3 /dev/disk1 (internal, physical):    #:                       TYPE NAME                    SIZE       IDENTIFIER    0:      GUID_partition_scheme                        *1.0 TB     disk1    1:                        EFI EFI                     209.7 MB   disk1s1    2:          Apple_CoreStorage Macintosh HD            760.7 GB   disk1s2    3:                 Apple_Boot Recovery HD             650.1 MB   disk1s3    4:                        EFI NO NAME                 104.9 MB   disk1s5 /dev/disk2 (internal, virtual):    #:                       TYPE NAME                    SIZE       IDENTIFIER    0:                  Apple_HFS Macintosh HD           +875.8 GB   disk2                                  Logical Volume on disk0s2, disk1s2                                  5E88EF38-D2A8-4A7D-8508-5C24D948877D                                  Unencrypted Fusion Drive /dev/disk3 (external, physical):    #:                       TYPE NAME                    SIZE       IDENTIFIER    0:      GUID_partition_scheme                        *8.0 GB     disk3    1:                        EFI EFI                     209.7 MB   disk3s1    2:                  Apple_HFS Install OS X Yosemite   7.7 GB     disk3s2 /dev/disk4 (disk image):    #:                       TYPE NAME                    SIZE       IDENTIFIER    0:      GUID_partition_scheme                        +51.2 MB    disk4    1:                  Apple_HFS Paragon Hard Disk Ma... 51.2 MB    disk4s1 /dev/disk5 (disk image):    #:                       TYPE NAME                    SIZE       IDENTIFIER    0:      GUID_partition_scheme                        +3.0 TB     disk5    1:                        EFI EFI                     209.7 MB   disk5s1    2:                  Apple_HFS Time Machine Backups    3.0 TB     disk5s2 /code/pre  If anyone could help I would really appreciate it. I am really nervous right now, hope I can get this fixed soon!   <answer216417> To expand your CoreStorage Logical Volume emMacintosh HD/em you have to delete the blocking NO NAME EFI partition (disk1s5). The two unnamed parts (138.62 GB and 99.9 GB) are no partitions but unallocated disk space.  To remove the second EFI partition (and expand emMacintosh HD/em) you have to boot to Internet Recovery Mode or an OS X system on an external device.  strongPreparation:/strong    ul liBackup your data./li liDetach any external drive (especially your external Time Machine backup drive)./li liRestart to Internet Recovery Mode by pressing kbdalt/kbd kbdcmd/kbd kbdR/kbd at startup.br The prerequisites are the latest firmware update installed, either ethernet or WLAN (WPA/WPA2) and a router with DHCP activated.br On a 50 Mbps-line it takes about 4 min (presenting a small animated globe) to boot to a recovery netboot image which usually is loaded from an Apple/Akamai server.  I recommend ethernet because it's more reliable. If you are restricted to WIFI and the boot process fails, just restart your Mac until you succeed booting.  Alternatively you may start from a bootable installer thumb drive (Mavericks, Yosemite or El Capitan) or a thumb drive/external disk containing a full system (Mavericks, Yosemite or El Capitan). If you boot from a full system on an external volume and login as a user with admin permissions (which is required) you have to prepend codesudo/code for the codegpt/code command below./li /ul  strongRemove the second EFI partition and modify CoreStorage stack:/strong  ul liOpen in the menubar Utilities/Terminal/li /ul  First you should get an overview of your disks and the partition layout:  ul liEnter codediskutil list/code  and codegpt -r show /dev/disk1/code (assuming disk1 is your HDD)/li /ul  To resize the CoreStorage volume you have to delete any blocking partition first (the Recovery HD doesn't count because it usually will be moved with the resizeStack command).   ul liFirst you have to unmount all mounted volumes on disk0 and disk1 (first the CoreStorage volume, which has its own disk identifier (e.g. disk3) but resides on disk0 and disk1) then all other Fusion Drive disks (assuming disk0 = SSD/disk1 = HHD. Please check the codediskutil list/code output for the proper disk identifiers and replace them in the commands below if necessary):  precodediskutil umountDisk /dev/disk3 /code/pre  then additional disks. Example:  precodediskutil umountDisk /dev/disk0 diskutil umountDisk /dev/disk1 /code/pre/li liRemove the second EFI partition (assuming the 103 MB partition has the index number 4 in the codegpt/code listing you got earlier)  precodegpt remove -i 4 /dev/disk1 /code/pre/li liRemount all disks in the reverse order  precodediskutil mountDisk /dev/disk0 diskutil mountDisk /dev/disk1 diskutil mountDisk /dev/disk3 /code/pre/li liSince any blocking partition is deleted you may now resize the CoreStorage volume with  precodediskutil cs resizeStack LVUUID size  /code/pre  in your example that's   precodediskutil cs resizeStack 5E88EF38-D2A8-4A7D-8508-5C24D948877D 1100g  /code/pre  to expand it to ~1,1 TB (or 1100 GB) strongor/strong  precodediskutil cs resizeStack 5E88EF38-D2A8-4A7D-8508-5C24D948877D 0g  /code/pre  to expand it to the full available size (0g is a magic number here).  The Recovery HD partition (disk1s3) will be moved to the end of disk1 automatically./li liQuit Terminal and reboot to emMacintosh HD/em/li /ul  <answer248194> Literally just had to type   precodediskutil cs resizeStack 5E88EF38-D2A8-4A7D-8508-5C24D948877D 1100g /code/pre  and it worked from terminal inside of normal-boot El Cap.  <comment261490> Honestly I'd recommend erasing, then recreating your Fusion drive. Afterwards you can use your Time Machine backup to restore it. If you want to go with this option, tell me and I'll post an answer with how to do it. <comment261491> The simple solution is back things up and then boot to recovery. Disk Utility should let you clean things up as needed and then you can reload OS if needed and start again with boot camp. Could you edit the last part of the question to remove the "chit chat" and be very specific about what you want the end goal to look like. <comment261500> @IronCraftMan since restoring from Time Machine might take a lot of time, I might just try this method for now, if it doesn't work I will let you know, thanks a lot! But one quick question here - recreating Fusion drive... does that keep the OSX Recovery partition? <comment261501> @bmike Sorry for not bing specific enough, but goal is to remove all the unallocated disk space and unusable partitions and merge them all back to Macintosh HD. (Just like a brand new iMac). I did boot to recovery but Disk Utility wouldn't let me do anything. I couldn't remove the "additional" partitions I mentioned above. Do you got any advice? Thanks! <comment261503> Thank you so much! I will try that tomorrow cuz it's late here in Taiwan. Hope it'll finally work for me. Thanks a lot for the help! <comment261504> @PhilipKuo If you run into problem just message me with (at)klanomath <comment261505> Ok, thanks a lot! Really appreciate it! <comment261506> Your brand new mac likely had two core storage volumes, one EFI boot and recovery HD on the spinning HD. It might not be possible to put humpty dumpty back together, but let's see if one of the filesystem wizards has details on an attempt. <comment261507> And the wizard has been summoned. Well done @klanomath - your generosity with fielding core storage questions is commendable. <comment261583> @klanomath Hello, I have a quick question here: I have done everything you said above but   1. I changed `diskutil mount` to `diskutil mountDisk` as it won't proceed with `mount`, is that okay?   2. I am now at the last step, entered `diskutil cs resizeStack 5E88EF38-D2A8-4A7D-8508-5C24D948877D 0g` but now it's showing `Started CoreStorage operation [ \ \ \ \ \ ]` and I think it's stuck, taking forever.   Thanks! <comment261601> @PhilipKuo What does `gpt -r show /dev/disk1` show? <comment261608> @klanomath, here, thanks! <comment261610> @klanomath http://i.imgur.com/W35RIri.png Thanks! <comment261614> @PhilipKuo Looks good. The 2nd EFI seems to be deleted. Now try the 1100g command instead of the 0g command. You may also choose another size (like 1120g). <comment261615> @klanomath, thanks. I did tried 1100g too, but it always show `Started CoreStorage operation [ \ \ \ \ \ ]` and stopped there. <comment261629> @PhilipKuo That's abnormal! Did you upgrade from Win8 to Win10 or did you make a "fresh" install of Win10. Did you choose an MBR or an EFI install (..if you had something to choose)? <comment261634> @klanomath: I did a fresh install of Windows 10, yes.  When in the installing process, I "formated" The BOOTCAMP partition, and then it shows "we couldn't create a new partition or..." so I deleted the partition, and then formated again, and then it created other "recovery" partitions for me, but still couldn't install, so I decided that I don't want Windows no more, so I went into OSX recovery and formated all partitions it created as osx journaled, and then a lot more stuff I did.... and this happened. I wonder what to do now? Thanks a lot. <comment261636> @PhilipKuo Do you have a current Time Machine backup of "Macintosh HD"? And are sure that you booted to Internet Recovery Mode? The how-to doesn't work booting to Recovery Mode (=booting to the Recovery HD on the HDD). <comment261645> @klanomath: Hi, thanks. Yeah am pretty sure I didn't boot to the OSX Recovery Mode, I booted into a Yosemite USB installation drive. Should I try Internet Recovery Mode instead? And i do have a Macintosh HD full backup, it's just that I don't really want to restart the whole thing as it's going to take forever... it's on a HDD attached to Airport Extreme. Or is it not going to take too long? Thanks. <comment261691> @klanomath: UPDATE: IT'S WORKING NOW. I booted into Internet Recovery Mode, and entered the last command that was not woking, and it worked! Thank you so much! My Fusion Drive is not back to 1.12 TB. Now, is there anything I can do to help the Drive? Like repaid permission? Thanks! <comment295236> Very good explanation! Thx u made my day :) <comment306440> This answer doesn't make much sense because the command as it stands now doesn't remove the FAT32 partition!