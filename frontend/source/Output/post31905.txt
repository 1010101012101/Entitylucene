Lion Server DHCP randomly loses settings and reverts to defaults <body> I’ve been trying to set up Lion Server on a Mac Pro with it acting as the router/gateway/firewall/DNS/NAT and DHCP. I’ve been trying to setup an internal-only network named mycompany.something. After having a lot of problems with that I switched to using mycompany.private (as recommended in Mac OS X Lion Server for Dummies).  When I was using mycompany.private and I turned on DHCP for the 192.168.2.x side of things it would distribute addresses and machines behind the server could get to the outside world.  I then noticed that every time I went back to the DHCP settings Subnets panel in Server Admin the subnets were either gone or different.  Looking at the logs it became apparent that the DHCP server was basically losing the settings file (which I assume is created/altered via Server Admin) and was putting a default one in its place.  Any idea what causes this to happen and how I can cajole the DHCP server into retaining my settings?  <answer31907> Just shooting a few ideas here: a router on your network that has a DHCP server activated. Permissions on the settings files are wrong. Deleting all settings and prefs and starting from scratch. Make sure the OS is up-to-date.  And you say the logs only show that the settings files disappeared? Nothing else?  <answer226636> There have traditionally been issues with using Mac OS X Server and internet sharing on the same machine. The situation has improved with recent release of both the OS &amp; Mac OS X Server. On Lion, the best I can suggest is to set things up in internet sharing, then never open the internet sharing settings in the preference pane again (this is what usually causes the config file to be overwritten). And do your DHCP &amp; DNS management from the Server app.   The safest thing to do is use a dedicated hardware router instead of the Mac Pro, for the gateway.  <comment36593> No other DHCP servers active. This is a fresh install of Lion +Server (with all updates) so I assume permissions are good and I’ve wiped and reinstalled it 4 times now. <comment36594> Hum. Ok. So can't be that. Can you post a copy of the logs around the time you believe it reverts to defaults, if possible? <comment36595> I assume you created a pool of DHCP subnets for your computers on the network. And I also assume that your setup is a home network with lion server connected to your modem and sharing the Internet connection via DHCP, correct? <comment36596> And did you set the log detail levels for DHCP to high? Just to get a bit more info... <comment36676> Changing the log level would not “stick” so they only have default detail. I don’t have access to the at the moment but will post a snippet later. <comment37739> I'm also having this problem - very frustrating. I'm wondering whether it has anything to do with losing track of our gateway switch (say after a power outage or the switch has a problem).. <comment57060> Just thought I’d leave a note that I never was able to get DHCP and NAT working on Lion Server, even on 10.7.3 (the latest version at the time of this writing). I ended up leaving DHCP off and using an Airport Extreme to handle DHCP. <comment275223> Another DHCP server on the network would have been my first guess also