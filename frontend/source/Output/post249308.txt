How do I ensure SMB based volume paths are available? <body> My machine is codemymac/code and the remote machine is coderemotemac/code(both are running El Capitan 10.11.6) - I reference a share on coderemotemac/code, located at //remotemac/path/to/remoteshare, as /Volumes/remoteshare.   Sometimes, especially when I have recently connected to that remote machine or  share from Finder, the /Volumes/remoteshare path is available. But after some time, that /Volumes/remoteshare path is not available.   precode$ ls /Volumes Macintosh HD $ # connect to remoteshare from Finder $ ls /Volumes $ Macintosh HD    remoteshare # After some time (a few hours)... $ ls /Volumes Macintosh HD  $ # note that /Volumes/remoteshare is now missing /code/pre  What can I do in my bash script to ensure that the remoteshare volume is present, or created before it is referenced?  <answer249315> In a script you can use the following basic construct:  precode#!bin/bash  if mount | grep -q "remoteshare"; then # check if remoteshare is available      exit else     echo not found fi /code/pre  codegrep -q .../code suppresses normal output. If successful the script exits. In the other case it will echo "not found".  Instead of codeecho not found/code you can ssh into the remote server, run codeserveradmin/code and enable or restart the smb service â€“ codeman serveradmin/code will show you how to do this. Then quit the ssh session and try to remount the SMB share.  To ssh passwordless into the server enable key based authentication - passing a password in a script is insecure and error prone. To use codeserveradmin/code on the remote server without sudoing, modify /etc/sudoers on the remote server and change the part:  precode## User privilege specification ## root ALL=(ALL) ALL %admin  ALL=(ALL) ALL /code/pre  to  precode## User privilege specification ## root ALL=(ALL) ALL %admin  ALL=(ALL) ALL your_remote_username ALL=(ALL) NOPASSWD: /Applications/Server.app/Contents/ServerRoot/usr/sbin/serveradmin /code/pre  Instead of the line codeecho not found/code use something like this then:  precodessh username@remotemac serveradmin stop smb sleep 10 serveradmin start smb sleep 2 exit echo "SMB service was restarted" mount_smbfs //your_remote_username:password@remotemac/folder /some/mntpoint /code/pre  hr  The inaccessibility of an SMB share may have many causes. It's probably impossible to cover all cases in one script.  <comment309211> Thanks - this alternative sounds insecure - I am essentially trusting my user name to ssh into the remote machine - how does Finder manage to open the remote share when I click on the (remotemac) share link in Finder sidebar? Does it use sudo?  I would like to make my script be as secure as that experience. <comment309213> @Anand key based ssh authentication is usually more secure than password based auth. <comment309214> Agreed, I am trying to understand how Finder does it (and do the same). Obviously Finder on my client does not require these edits to the remote machine settings - any client Finder window in the network is able to find the shares I am looking for. <comment309215> @Anand you can also include Apple Script in your bash script with ...osascript.. and use the FInder <comment309216> I was just looking into AppleScript to do this :-) Could you post a solution for this that uses AppleScript within bash? Thanks! <comment309220> @Anand I don't know whether Server.app is scriptable or not - I don't think it's as easy as the cli. The problem here is, that I don't know what's wrong with the SMB server. The spontaneous unmounts may be a time-out or a smb/OS X bug. <comment309268> Thanks. This issue is fairly consistent - after some time (at least a few minutes), with no finder window connected to the remote, the volumes just disappear - this has been happening for a while now, at least as far back as Yosemite.