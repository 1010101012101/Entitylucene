How to put a Mac to sleep after display disconnect using AppleScript? <body> I would like to solve the issue from this question, namely, after disconnecting a Cinema display from a clamshell MacBook I would like to let the MacBook go to sleep without opening and closing the lid.  I have never used AppleScript before.  Is it possible to write an AppleScript which puts the computer to sleep, say 30 seconds after disconnect of an external display, but only if the lid is closed.  <answer224334> Using the included strongScript Editor.app/strong with OS X, try experimenting with these snippets.  h1Wait 30 Seconds/h1  The following snippet will make your script wait 30 seconds before showing a dialog:  precodedelay 30 -- this waits thirty seconds display dialog "Hello?" -- this shows a dialog /code/pre  h1Sleep/h1  The following snippet will put your Mac immediately to sleep:  precodetell application "System Events"     sleep end tell /code/pre  h1Wait and then Sleep/h1  Combining the two snippets above gives an AppleScript that will wait 30 seconds before putting your Mac to sleep:  precodedelay 30 tell application "System Events"     sleep end tell /code/pre  h1Displays and Desktops/h1  I am not sure how best to determine if a monitor is connected. You could certainly poll regularly; calling codesystem_profiler SPThunderboltDataType SPDisplaysDataType/code and parsing the output would work.  Polling is computationally expensive and best avoided.  Alternatively, maybe an approach whereby an AppleScript could determine if the number of active desktops has changed? When two monitors are connected to my Mac, the following snippet returns a two item list:  precodetell application "System Events"     set myDesktops to desktops end tell /code/pre  Expanding on this, the following snippet provides more display information to work with:  precodetell application "System Events"     set myDesktop to properties of the first desktop end tell /code/pre  <answer224350> I'm not going to pretty this up like Graham Miln nicely did however it you want to create an AppleScript app that you can run before disconnecting your external display then this will wait 30 seconds, check to see if it's in clamshell mode and if yes put the system to sleep.  AppleScript emcode/em:  precodedelay 30 set AppleClamshellState to do shell script "ioreg -r -k AppleClamshellState -d 1 | awk -F' = ' '/AppleClamshellState/ {print $2}'" if AppleClamshellState = "Yes" then tell application "Finder" to sleep /code/pre  Note: In the codeif/code emstatement/em, codeSystem Events/code can be use in place of codeFinder/code as either will accept the codesleep/code emcommand/em.  <comment272097> If you take this approach, be sure to disconnect your monitor and Thunderbolt ethernet adapter within the 30 seconds â€“ or you will wake your MacBook just after it sleeps. <comment272227> Thanks, something this should work.