Port forwarding on all ports except ssh on macOS Sierra (redsocks) <body> I am trying to forward all ports except port 22 on OSX Sierra using pfctl but it doesn't seem to work.  file: /pf.conf  precodeext_if = "inet" rdr pass $ext_if proto tcp from any to any -&gt; 127.0.0.1 port 12345 rdr pass $ext_if proto udp from any to any -&gt; 127.0.0.1 port 10053 pass out proto tcp from any to any port ssh /code/pre  I enabled it with  precodesudo sysctl -w net.inet.ip.forwarding=1 sudo pfctl -f pf.conf sudo pfctl -e /code/pre  The traffic seems to be redirecting fine to port 12345, but I can't get port 22 to passthrough.  <answer265559> The ssh line should be above the ‘rdr’ lines, so that the ssh line is matched first. 