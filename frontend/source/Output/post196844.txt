How to capture mail.app message url that will remain persistent when message is moved? <body> So mail.app has this wonderful message:// URL scheme, which works great—until the message is moved. Then links created sometimes work—and sometimes don't. I can't figure out the difference. So my question is twofold:  ol liIs there a way to access messages through a URL even when they've moved?/li liIf not, how do I move a message and emthen/em get its message ID?/li /ol  My current script is  precodetell application "Mail"     set theSelectedMessages to selection     set the selected_message to item 1 of the theSelectedMessages     set message_id to the message id of the selected_message     set message_subject to the subject of the selected_message end tell set myPrompt to display dialog "Create New To Do in BusyCal" default answer message_subject set response to the text returned of myPrompt set quick_entry to encode(response &amp; " " &amp; month of (current date) &amp; day of (current date) &amp; "!!!" &amp; " &lt;message:&lt;" &amp; message_id &amp; "&gt;&gt;") -- see encode handler below tell application "BusyCal"     activate     open location "busycalevent://new/-" &amp; quick_entry end tell tell application "Mail"     move the selected_message to mailbox "Calendar" of mailbox " To-Do" of account "Calion" end tell --encode handler on encode(msg)     set theText to do shell script "/usr/bin/python -c 'import sys, urllib; print urllib.quote(sys.argv[1])' " &amp; quoted form of msg     set AppleScript's text item delimiters to "/"     set theTextItems to text items of theText     set AppleScript's text item delimiters to "%2F"     set theText to theTextItems as string     set AppleScript's text item delimiters to {""}     return theText end encode /code/pre  <answer199570> strongShort answer/strong  codemessage:/code URLs emare/em persistent, but Mail needs to be restarted so that its message ID database gets updated and the URLs are properly resolved.  You will have to restart Mail before using BusyCal. Alternatively, you could restart Mail in your script.  hr  strongLong answer/strong  After some tests I noticed that:  ul listrongmessage IDs don't change when a message is moved/strong:  The message ID of this test mail located in the Inbox:  img src="https://i.stack.imgur.com/13Rzx.png" alt="enter image description here"  doesn't change after moving it to the code_People/code mailbox:  img src="https://i.stack.imgur.com/18bln.png" alt="enter image description here"/li listrongmessage IDs work after Mail is restarted/strong:  After moving the message, the URL codemessage:%3CCA+pHXZSgP12HvSg2sQ9J3ochK2K8xOTk_wEoTf+6WmMcYGYxnw@mail.gmail.com%3E/code shows an empty message because Mail looks for the message in the Inbox (press Command and click the envelope icon on the window bar to show the path to the empty message):  img src="https://i.stack.imgur.com/P9Scj.png" alt="enter image description here"  After restarting Mail, the message is found successfully:  img src="https://i.stack.imgur.com/ZWgJw.png" alt="enter image description here"/li /ul  (Tested on OS X Mavericks 10.10.4.)   To your questions:   strongIs there a way to access messages through a URL even when they've moved?/strong   Yes, restart Mail so that it rebuilds its internal message ID database. You will be able to access any moved messages in their new mailboxes.   I understand this is annoying but it seems to be the only workaround.  strongIf not, how do I move a message and then get its message ID?/strong   That's not necessary as message IDs don't change.  <comment240551> AHA! That explains why they sometimes work and sometimes do not. So it seems that it wouldn't help to move it and get the ID, because Mail will not have updated the database. I can test that. <comment240552> I wonder if there's a way to force-update the database without restarting the program. Regardless, you've answered my question. Thanks heaps! <comment240553> I also wonder if viewing the message in its new mailbox will update the DB. I bet it will. More testing! <comment240557> @Calion I'm glad I could help, if you happen to find a better workaround, let us know! <comment248173> Not only did viewing the message not work, updating the location database seems to be the *last* thing Mail does on startup, so that the link will not work until Mail has completely launched and finished checking for new mail. Oh, well. Thanks for solving the problem!