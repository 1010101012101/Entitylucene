Time Capsule Extreme Proper network routing <body> It's time for some professional help. I love my Time Capsule Extreme, since retiring my ancient Linksys routers and setting it up as my network's Wifi Broadcast point, all the things that used to glitch now work, from airdrop to my bonjour printer. But I've been plagued by an intermittent problem which required me to renew my DHCP lease several times a day to resolve internet addresses, and I've hacked the settings on every device in the house to try and resolve it. My latest setup SEEMS to have resolved that issue, but it was come and go I'm pretty sure I'm not doing it right. I'm hoping someone can help me stop guessing. I've diagrammed the system here:   img src="https://i.stack.imgur.com/IrdMC.png" alt="enter image description here"  So, the problems:  ol liThe Time Capsule reports I'm Double NATted. WTF? DHCP is OFF on both the Ziggo modem and the Tomato switch. As far as I know, the Time Capsule is the only think assigning DHCP. Is there a way I can determine what device the Time Capsule THINKS is doing NAT? Or am I being an idiot here and there's another setting somewhere that controls NAT independent of DHCP? /li liWhy the hell do the Apple TV and the Raspberry Pi even work? I was trying to set the Pi to an address in the 192.168.1.x range and it was fail fail fail. The Apple TV somehow, either through holding on to an old DHCP assignment of 192.168.0.x OR some msytical communication with the Time Capsule in which it assigned a 0.x instead of 1.X address, was connecting fine through the Tomato switch (with a 1.x address and a 1.1 gateway!!!) so I gave that a try, set the gateway to the Ziggo instead of the Time Capsule, and hey presto, it connected. But I have a bad feeling about this. It looks utterly kludged. /li liIn the course of trying to resolve my DNS issues, I set devices to various DNS servers. Is that a problem, or is my network going to be happy resolving addresses with Google from the PI, OpenDNS via the Time Capsule, and my provider via the Apple TV? Again, everything is working now, so I really don't want to mess with it unless this is costing me bandwidth overhead or if I'm risking conflicts. /li liSneaky suspicion: Should I take that single cable that runs from the Tomato USB to the Ziggo modem and plug it into the Time Capsule instead, and let The Time Capsule DHCP assign 1.X addresses to the devices plugged into the Switch? This would seem more consistent, but is it necessary? Advantageous? When the lease expires on that 0.x address on the Apple TV, will it get a 1.x address from the Time Capsule and be buggered?/li /ol  I feel like I've got a Jenga Tower wobbling away on the table, sort of stable, but looking like it's going to fall over if I breathe wrong.   <comment303382> And indeed, lost connection to DNS just now and wouldn't respond until I renewed the DHCP lease. At which point connectivity was instantly back. Been using ping -A www.validwebaddress.com in a terminal window in background to monitor. Chirps when the ping times out. More than three or four chirps in a row, I know DNS has crapped out again. <comment331273> On 1: [NAT does not imply the use of DHCP to assign addresses](http://networkengineering.stackexchange.com/q/13276); NAT can also be used with static IP assignment. Since your Ziggo modem is sharing your public IP (ISP-determined) by handing out 192.168.0.X addresses to your Time Capsule and Tomato switch, and your Time Capsule is handing out 192.168.1.X addresses to share its own 192.168.0.2 address, it is indeed one layer of NAT deeper than it expects to be. <comment331274> Also, is there a particular reason that your network is set up the way it is, instead of [a "typical" arrangement](http://www.dummies.com/computers/computer-networking/a-typical-computer-networking-setup/) with one router (probably the Time Capsule) doing the address assigning, the modem simply providing WAN access to the router, and every client device downstream of the router? Wondering if you had a specific aim.