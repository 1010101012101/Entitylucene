What happens during an iPhone restore <body> I'm looking at the apticket system and capturing TSS data. I want to know all the steps in restoring and verifying the IPSW, and exactly what data is sent to the signing server. From what I understand, the steps are as follows.  precodeIPSW downloaded Device ECID, iOS version and a 'nonce' sent to iTunes server Above info signed, along with a hash of the IPSW (to create an apticket), and sent back to the client Apticket verified by bootloader (hard wired into device) /code/pre  Is this correct, what format does an apticket take, is any other information used, and how is the 'nonce' generated?  <answer216416> You are basically correct. Information about the APTicket can be found here, and SHSH information can be found here. And here is a slideshow from iH8sn0w from JailbreakCon in 2012 that describes everything else that you could ever want to know about the process. The JailbreakCon link has a list of all talks and links to their videos and/or slides (if publicly available) should you be hungry for even more information.  As far as actually emhow/em the nonce is generated, the bootloaders have been dumped, but they're proprietary and protected by copyright law, so publishing their contents is illegal. You can, however, dump them yourself, and investigate on your own.  <comment261204> Do you have charles proxy or another tool or are you asking us how you might set that sort of snooping mechanism up? <comment261207> I'm wondering if someone has already done something like that and knows what actually happens <comment261277> Hopefully those will be the people that make an answer as opposed to people that just think about it or wish to convince you of doing something else ;-) <comment261576> What is the PRNG inside the iPhone bootloader based on? Why hasn't anyone managed to decompile the PRNG? Has Apple really put all the money for a true RNG in the iPhone bootloader just to prevent downgrades? <comment277896> Do you consider this question unanswered? <comment278941> By the way, the "way to do things" around here is to [accept the answer that helped you the most](http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work). I have updated my answer reflecting my statement about the bootloaders. <comment279000> Sorry. Answer deleted; answer accepted. I didn't mean to steal your answer, I just couldn't mark a comment as a correct answer. Thank you <comment279001> No problem! I'm glad I could point you in the right direction on iOS firmware restores!