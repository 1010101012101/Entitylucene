Changing modifier keys from the command line <body> As a heavy Emacs user, I like to remap my Caps Lock key to function as the Ctrl key.  There is a convenient dialog in the Keyboard Preference Pane to do that.   But the problem is that this setting gets lost after someone logs into another account that hasn't this preference set.   So is there any way of doing the same as the preference pane dialog from the command line?   <answer4815> Changing preferences and running, codedefaults -currentHost read -g/code shows you what changes are being written. I was going to write up a short bash script to automate it, but it looks like I was beaten to the punch:  precode#!/bin/bash                                                                        mappingplist=com.apple.keyboard.modifiermapping  if [ $1 == "emacs" ]; then     echo "Switching to emacs modifiers"     defaults -currentHost write -g $mappingplist '(                                               {                                                                             HIDKeyboardModifierMappingDst = 4;                                                HIDKeyboardModifierMappingSrc = 2; },                                                 {                                                                             HIDKeyboardModifierMappingDst = 12;                                               HIDKeyboardModifierMappingSrc = 10;                                           },                                                                                        {                                                                             HIDKeyboardModifierMappingDst = 2;                                                HIDKeyboardModifierMappingSrc = 4;                                            },                                                                                        {                                                                             HIDKeyboardModifierMappingDst = 10;                                               HIDKeyboardModifierMappingSrc = 12;                                           })'   else     echo "Switching to default modifiers"     defaults -currentHost delete -g $mappingplist fi /code/pre     The script takes one argument, if the   argument is emacs, then it swaps   command and control, if the argument   is anything else it restores the   defaults.      http://forums.macrumors.com/showthread.php?t=949280   <answer4986> You can use KeyRemap4MacBook with the PCKeyBoardHack. It also allows you to use Emacs keys in any Mac app, including the ones not using Cocoa such as MS apps.    <answer88148> From "Updating modifier key mappings through defaults command tool":  codedefaults -currentHost write -g com.apple.keyboard.modifiermapping.1133-50475-0 -array '&lt;dict&gt;&lt;key&gt;HIDKeyboardModifierMappingSrc&lt;/key&gt;&lt;integer&gt;0&lt;/integer&gt;&lt;key&gt;HIDKeyboardModifierMappingDst&lt;/key&gt;&lt;integer&gt;2&lt;/integer&gt;&lt;/dict&gt;/code  Change code1133/code and code50475/code to the vendor and product IDs shown by codeioreg -n IOHIDKeyboard -r/code. codesrc 0/code and codedst -1/code would disable kbdcaps lock/kbd.  codedefaults -currentHost write -g/code modifies:  code~/Library/Preferences/ByHost/.GlobalPreferences.*.plist/code  You have to log out and back in to apply changes. If the values are strings (like in the answer by @pithyless), the changes are shown in System Preferences but they don't have any effect.  Values of keys:  precode-1 none 0 caps lock 1 left shift 2 left control 3 left option 4 left command 5 keypad 0 6 help 9 right shift 10 right control 11 right option 12 right command /code/pre  <answer140979> Combining a few answers together I came up with this script that seems to work (strongmapping Caps-lock to Control/strong).  precode$ keyboard_id = "$(ioreg -n IOHIDKeyboard -r | grep -e VendorID\" -e ProductID | tr -d \"\|[:blank:] | cut -d\= -f2 | tr '\n' -)" $ defaults -currentHost write -g "com.apple.keyboard.modifiermapping.${keyboard_id}0" '( {   HIDKeyboardModifierMappingDst = 2;   HIDKeyboardModifierMappingSrc = 0; })' /code/pre  strongOnly problem that it doesn't seem to take any effect... :(/strong  strongI'll update if it I get it to work./strong  <answer277544> I wanted to swap strongRight Command/strong with strongRight Option/strong keys only.  When I setup global strongCommand/strong and strongOption/strong swap in System Preferences...  Keyboard  Modifier Keys..., there is following config in the system (which works as expected):  precode$ defaults -currentHost read -g com.apple.keyboard.modifiermapping.1452-591-0 (         {         HIDKeyboardModifierMappingDst = 30064771299;         HIDKeyboardModifierMappingSrc = 30064771298;     },         {         HIDKeyboardModifierMappingDst = 30064771303;         HIDKeyboardModifierMappingSrc = 30064771302;     },         {         HIDKeyboardModifierMappingDst = 30064771298;         HIDKeyboardModifierMappingSrc = 30064771299;     },         {         HIDKeyboardModifierMappingDst = 30064771302;         HIDKeyboardModifierMappingSrc = 30064771303;     } ) /code/pre  But when I modify it, to swap only strongRight/strong side as below - it doesn't work:  precode$ defaults -currentHost write -g com.apple.keyboard.modifiermapping.1452-591-0 '(         {         HIDKeyboardModifierMappingDst = 30064771303;         HIDKeyboardModifierMappingSrc = 30064771302;     },         {         HIDKeyboardModifierMappingDst = 30064771302;         HIDKeyboardModifierMappingSrc = 30064771303;     } )' /code/pre  It's because values are written as strings not integers. You can see that using:  precode$ plutil -convert xml1 -o - ~/Library/Preferences/ByHost/.GlobalPreferences.*.plist /code/pre  pre class="lang-xml prettyprint-override"code&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt; &lt;plist version="1.0"&gt; &lt;dict&gt;     &lt;key&gt;com.apple.keyboard.modifiermapping.1452-591-0&lt;/key&gt;     &lt;array&gt;         &lt;dict&gt;             &lt;key&gt;HIDKeyboardModifierMappingDst&lt;/key&gt;             &lt;string&gt;30064771303&lt;/string&gt;             &lt;key&gt;HIDKeyboardModifierMappingSrc&lt;/key&gt;             &lt;string&gt;30064771302&lt;/string&gt;         &lt;/dict&gt;         &lt;dict&gt;             &lt;key&gt;HIDKeyboardModifierMappingDst&lt;/key&gt;             &lt;string&gt;30064771302&lt;/string&gt;             &lt;key&gt;HIDKeyboardModifierMappingSrc&lt;/key&gt;             &lt;string&gt;30064771303&lt;/string&gt;         &lt;/dict&gt;     &lt;/array&gt; &lt;/dict&gt; &lt;/plist&gt; /code/pre  So the right way to update the setting is using XML format:  precode$ defaults -currentHost write -g com.apple.keyboard.modifiermapping.1452-591-0 -array \ '&lt;dict&gt;     &lt;key&gt;HIDKeyboardModifierMappingDst&lt;/key&gt;     &lt;integer&gt;30064771303&lt;/integer&gt;     &lt;key&gt;HIDKeyboardModifierMappingSrc&lt;/key&gt;     &lt;integer&gt;30064771302&lt;/integer&gt; &lt;/dict&gt;' \ '&lt;dict&gt;     &lt;key&gt;HIDKeyboardModifierMappingDst&lt;/key&gt;     &lt;integer&gt;30064771302&lt;/integer&gt;     &lt;key&gt;HIDKeyboardModifierMappingSrc&lt;/key&gt;     &lt;integer&gt;30064771303&lt;/integer&gt; &lt;/dict&gt;' /code/pre  At the end, you have to log off and log in again.  <comment5029> It doesn't seem to work from me here with Snow Leopard, but it's clearly a step in the right direction. <comment45079> @pith... what's the `-g` flag do?  I didn't see that in the man page for `defaults`.  Also, this looks like it's swapping two sets of values: 4 with 2 and 10 with 12, yet there are only two modifiers that change.  Can you elaborate, or did you simply look at the output but don't know what they actually represent? (At first I suspected four key codes--two on the left, two on the right--but they don't appear to be key codes, at least not as reported by the keyboard driver.) <comment166196> I do the mappings as you suggest but it doesn't seem to take effect although in the UI it appears mapped. Only doing it via UI seems to work... Any ideas? <comment334348> Possible duplicate of [Updating modifier key mappings through defaults command tool](http://apple.stackexchange.com/questions/13598/updating-modifier-key-mappings-through-defaults-command-tool). Although the other question is historically newer, it has a better (actually working) answer. <comment353982> Did you get this to work I cant tell?  Is a reboot required maybe? <comment353984> Ah... Yes. You have to log off & log on again. <comment353986> I am trying to answer this question https://apple.stackexchange.com/questions/280855/changing-right-hand-command-alt-key-order-to-be-like-a-windows-keyboard  Can you chat maybe?  http://chat.stackexchange.com/rooms/38/ask-different-chat  I tried running your last command and it doesn't change anything for me. <comment353987> First of all remove Karabiner-Elements and adapt keyboard code (1452-591-0) and key codes (30064771302, 30064771303) to your system.