Copy a file's NSURL to clipboard <body> I am trying to do a rather simple thing: in the context menu I want to have an action (e.g. with Automator) that gets and copies the file's NSURL to clipboard.  The solution seems simple, but it does not work (some unspecific error). Here is what I have so far:  precodeon run {input, parameters}     set p to POSIX path of (input)    set nsu to current application's |NSURL|'s fileURLWithPath:p     return nsu  end run /code/pre  I am looking to get the file reference URL, like so: file:///.file/id=6571367.2773272/  I am on El Capitan.  Any ideas?  <answer210889> If you lose the parameters parameter, leaving only input, and if you start the script declaring the framework, it works.  precodeuse framework "Foundation" on run {input}    set p to POSIX path of (input)    set nsu to current application's |NSURL|'s fileURLWithPath:p     return nsu end run /code/pre  <answer210912> Here is the solution to the issue (from: http://macscripter.net/viewtopic.php?pid=183164#p183164):  precodeuse framework "Foundation"  on run {input, parameters}      set p to POSIX path of (input)     set nsu to current application's |NSURL|'s fileURLWithPath:p      set fru to nsu's fileReferenceURL()'s absoluteString() as text      return fru  end run /code/pre  I did not check jweak's answer. It may also work, after all. The poster over at macscripter also mentioned something important: input may contain a list of items (multi-selected).  Hope this helps someone.  <comment254534> Cheat and use [PathFinder](http://www.cocoatech.com/pathfinder/) rather than Finder <comment254580> I have added an answer, but it may be better if you clarify what you are really after and why..