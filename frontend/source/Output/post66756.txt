IPFW: IP blocked, but still can get in <body> I am using Fail2Ban to dynamically add rules to IPFW. The offending IP addresses are added into IPFW, but for some unknown reasons they can still get through to Apache and make requests.  Is it because the ordering is ruined? Should the dynamic rules 12407 be placed before 12304, 12305?  ul li00001 allow udp from any 626 to any dst-port 626/li li01000 allow ip from any to any via lo0/li li…/li li12300 allow tcp from any to any established/li li12301 allow tcp from any to any out/li li12302 allow udp from any to any out keep-state/li li12303 allow udp from any to any in frag/li li12304 allow tcp from any to any dst-port 80/li li12305 allow tcp from any to any dst-port 443/li li12306 allow tcp from any to any dst-port 5113/li li12307 allow ip from 192.168.0.0/16 to any/li li12407 deny tcp from 94.23.148.61 to 192.168.1.3 dst-port 80,443/li li…/li li65535 allow ip from any to any/li /ul  <answer66796> It is because rules are followed from top to bottom. As soon as the first matching rules is found, further rule processing stops.  In this case there is first the allow rule (12304 allow tcp from any to any dst-port 80) and later the deny rule (12407 deny tcp from 94.23.148.61 to 192.168.1.3 dst-port 80,443).  To fix this: either place the deny rule above the allow rule for port 80 and 442 (number &lt; 12304) or place the allow rules for port 80 and 443 below the deny rules (f.e. at 65533 and 65534). 